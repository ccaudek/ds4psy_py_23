<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Data Science per psicologi - 14&nbsp; Distribuzioni di v.c. continue</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./024_likelihood.html" rel="next">
<link href="./022_discr_rv_distr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science per psicologi</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/data_science/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Benvenuti</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Prefazione</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basics.html" class="sidebar-item-text sidebar-link">Parte 1: Nozioni di base</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001_key_notions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_measurement.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007_freq_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analisi esplorativa dei dati</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011_loc_scale.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Indici di posizione e di scala</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012_correlation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Le relazioni tra variabili</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013_penguins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipolazione e visualizzazione dei dati in <span class="math inline">\(\mathsf{R}\)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">Parte 2: Il calcolo delle probabilità</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./015_prob_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">La logica dell’incerto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./016_conditional_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probabilità condizionata: significato, teoremi, eventi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./017_bayes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./018_expval_var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Indici di posizione, di varianza e di associazione di variabili casuali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./019_joint_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./020_density_func.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La densità di probabilità</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./distr.html" class="sidebar-item-text sidebar-link">Parte 3: Distribuzioni di v.c. discrete e continue</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./022_discr_rv_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./023_cont_rv_distr.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./024_likelihood.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">La funzione di verosimiglianza</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./bayes_inference.html" class="sidebar-item-text sidebar-link">Parte 4: Inferenza bayesiana</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./025_intro_bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Credibilità, modelli e parametri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./026_subj_prop.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./029_conjugate_families.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./030_balance_prior_post.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./036_posterior_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Approssimazione della distribuzione a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./040_beta_binomial_mod.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Il modello beta-binomiale in linguaggio Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./041_mcmc_diagnostics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./045_summarize_posterior.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./046_bayesian_prediction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La predizione bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_normal_normal_mod.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression.html" class="sidebar-item-text sidebar-link">Parte 5: Regressione lineare</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./051_reglin1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./052_reglin2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regressione lineare bivariata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./053_reglin3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Modello di regressione in linguaggio Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./054_reglin4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Inferenza sul modello lineare</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./055_reglin5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Confronto tra due gruppi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./056_pred_check.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Predictive checks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di tre o più gruppi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./070_mod_hier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Modello gerarchico</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./071_mod_hier_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Modello gerarchico: simulazioni</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./entropy.html" class="sidebar-item-text sidebar-link">Parte 6: Entropia</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./090_entropy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Entropia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./091_kl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./092_info_criterion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Criterio di informazione e convalida incrociata</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./frequentist_inference.html" class="sidebar-item-text sidebar-link">Parte 7: Inferenza frequentista</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./220_intro_frequentist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Legge dei grandi numeri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./221_conf_interv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Intervallo fiduciale</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./225_distr_camp_mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzione campionaria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./226_test_ipotesi.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Significatività statistica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./227_ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Inferenza sulle medie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./228_limiti_stat_frequentista.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./999_refs.html" class="sidebar-item-text sidebar-link">Riferimenti bibliografici</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Appendici</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a01_math_symbols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Simbologia di base</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a02_number_sets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Numeri binari, interi, razionali, irrazionali e reali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a03_set_theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Insiemi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a04_summation_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Simbolo di somma (sommatorie)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a05_calculus_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a10_markov_chains.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Le catene di Markov</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a15_stan_lang.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Programmare in Stan</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul>
<li>
<a href="#distribuzione-gaussiana" id="toc-distribuzione-gaussiana" class="nav-link active" data-scroll-target="#distribuzione-gaussiana"><span class="toc-section-number">14.1</span>  Distribuzione Gaussiana</a>
  <ul class="collapse">
<li><a href="#limite-delle-distribuzioni-binomiali" id="toc-limite-delle-distribuzioni-binomiali" class="nav-link" data-scroll-target="#limite-delle-distribuzioni-binomiali"><span class="toc-section-number">14.1.1</span>  Limite delle distribuzioni binomiali</a></li>
  </ul>
</li>
  <li>
<a href="#normal-random-walk" id="toc-normal-random-walk" class="nav-link" data-scroll-target="#normal-random-walk"><span class="toc-section-number">14.2</span>  La Normale prodotta con una simulazione</a>
  <ul class="collapse">
<li><a href="#concentrazione" id="toc-concentrazione" class="nav-link" data-scroll-target="#concentrazione"><span class="toc-section-number">14.2.1</span>  Concentrazione</a></li>
  <li><a href="#funzione-di-ripartizione" id="toc-funzione-di-ripartizione" class="nav-link" data-scroll-target="#funzione-di-ripartizione"><span class="toc-section-number">14.2.2</span>  Funzione di ripartizione</a></li>
  <li><a href="#distribuzione-normale-standard" id="toc-distribuzione-normale-standard" class="nav-link" data-scroll-target="#distribuzione-normale-standard"><span class="toc-section-number">14.2.3</span>  Distribuzione Normale standard</a></li>
  </ul>
</li>
  <li><a href="#teorema-del-limite-centrale" id="toc-teorema-del-limite-centrale" class="nav-link" data-scroll-target="#teorema-del-limite-centrale"><span class="toc-section-number">14.3</span>  Teorema del limite centrale</a></li>
  <li>
<a href="#distribuzione-chi-quadrato" id="toc-distribuzione-chi-quadrato" class="nav-link" data-scroll-target="#distribuzione-chi-quadrato"><span class="toc-section-number">14.4</span>  Distribuzione Chi-quadrato</a>
  <ul class="collapse">
<li><a href="#propriet%C3%A0" id="toc-proprietà" class="nav-link" data-scroll-target="#propriet%C3%A0"><span class="toc-section-number">14.4.1</span>  Proprietà</a></li>
  </ul>
</li>
  <li>
<a href="#distribuzione-t-di-student" id="toc-distribuzione-t-di-student" class="nav-link" data-scroll-target="#distribuzione-t-di-student"><span class="toc-section-number">14.5</span>  Distribuzione <span class="math inline">\(t\)</span> di Student</a>
  <ul class="collapse">
<li><a href="#propriet%C3%A0-1" id="toc-proprietà-1" class="nav-link" data-scroll-target="#propriet%C3%A0-1"><span class="toc-section-number">14.5.1</span>  Proprietà</a></li>
  </ul>
</li>
  <li><a href="#funzione-beta-di-eulero" id="toc-funzione-beta-di-eulero" class="nav-link" data-scroll-target="#funzione-beta-di-eulero"><span class="toc-section-number">14.6</span>  Funzione beta di Eulero</a></li>
  <li><a href="#distribuzione-beta" id="toc-distribuzione-beta" class="nav-link" data-scroll-target="#distribuzione-beta"><span class="toc-section-number">14.7</span>  Distribuzione Beta</a></li>
  <li><a href="#distribuzione-di-cauchy" id="toc-distribuzione-di-cauchy" class="nav-link" data-scroll-target="#distribuzione-di-cauchy"><span class="toc-section-number">14.8</span>  Distribuzione di Cauchy</a></li>
  <li><a href="#distribuzione-log-normale" id="toc-distribuzione-log-normale" class="nav-link" data-scroll-target="#distribuzione-log-normale"><span class="toc-section-number">14.9</span>  Distribuzione log-normale</a></li>
  <li><a href="#distribuzione-di-pareto" id="toc-distribuzione-di-pareto" class="nav-link" data-scroll-target="#distribuzione-di-pareto"><span class="toc-section-number">14.10</span>  Distribuzione di Pareto</a></li>
  <li><a href="#commenti-e-considerazioni-finali" id="toc-commenti-e-considerazioni-finali" class="nav-link" data-scroll-target="#commenti-e-considerazioni-finali">Commenti e considerazioni finali</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-distr-rv-cont" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Codice</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dopo avere introdotto con una simulazione il concetto di funzione di densità nel Capitolo <a href="020_density_func.html"><span>Capitolo&nbsp;12</span></a>, prendiamo ora in esame alcune delle densità di probabilità più note. La più importante di esse è sicuramente la distribuzione Normale.</p>
<section id="distribuzione-gaussiana" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="distribuzione-gaussiana">
<span class="header-section-number">14.1</span> Distribuzione Gaussiana</h2>
<p>Non c’è un’unica distribuzione gaussiana (o normale): la distribuzione gaussiana è una famiglia di distribuzioni. Tali distribuzioni sono dette “gaussiane” in onore di Carl Friedrich Gauss (uno dei più grandi matematici della storia il quale, tra le altre cose, scoprì l’utilità di tale funzione di densità per descrivere gli errori di misurazione). Adolphe Quetelet, il padre delle scienze sociali quantitative, fu il primo ad applicare tale funzione di densità alle misurazioni dell’uomo. Karl Pearson usò per primo il termine “distribuzione normale” anche se ammise che questa espressione “ha lo svantaggio di indurre le persone a credere che le altre distribuzioni, in un senso o nell’altro, non siano normali.”</p>
<section id="limite-delle-distribuzioni-binomiali" class="level3" data-number="14.1.1"><h3 data-number="14.1.1" class="anchored" data-anchor-id="limite-delle-distribuzioni-binomiali">
<span class="header-section-number">14.1.1</span> Limite delle distribuzioni binomiali</h3>
<p>Iniziamo con un un breve excursus storico. Nel 1733, Abraham de Moivre notò che, aumentando il numero di prove di una distribuzione binomiale, la distribuzione risultante diventava quasi simmetrica e a forma campanulare. Con 10 prove e una probabilità di successo di 0.9 in ciascuna prova, la distribuzione è chiaramente asimmetrica.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-demoivre-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-demoivre-1-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.1: Probabilità del numero di successi in <span class="math inline">\(N = 10\)</span> prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione <span class="math inline">\(\mbox{Bin}(y \mid 10, 0.9)\)</span>. Con solo dieci prove, la distribuzione è fortemente asimmetrica negativa.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Ma se aumentiamo il numero di prove di un fattore di 100 a <em>N</em> = 1000, senza modificare la probabilità di successo di 0.9, la distribuzione assume una forma campanulare quasi simmetrica. Dunque, de Moivre scoprì che, quando <em>N</em> è grande, la funzione gaussiana (che introdurremo qui sotto), nonostante sia la densità di v.a. continue, fornisce una buona approssimazione alla funzione di massa di probabilità binomiale.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-demoivre-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-demoivre-2-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.2: Probabilità del numero di successi in <span class="math inline">\(N = 1000\)</span> prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione <span class="math inline">\(\mbox{Bin}(y \mid 1000, 0.9)\)</span>. Con mille prove, la distribuzione è quasi simmetrica a forma campanulare.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La distribuzione Normale fu scoperta da Gauss nel 1809. Il Paragrafo successivo illustra come si possa giungere alla Normale mediante una simulazione.</p>
</section></section><section id="normal-random-walk" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="normal-random-walk">
<span class="header-section-number">14.2</span> La Normale prodotta con una simulazione</h2>
<p><span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="999_refs.html#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span> illustra come sia possibile giungere alla distribuzione Normale mediante una simulazione. Supponiamo che vi siano mille persone tutte allineate su una linea di partenza. Quando viene dato un segnale, ciascuna persona lancia una moneta e fa un passo in avanti oppure all’indietro a seconda che sia uscita testa o croce. Supponiamo che la lunghezza di ciascun passo vari da 0 a 1 metro. Ciascuna persona lancia una moneta 16 volte e dunque compie 16 passi.</p>
<p>Alla conclusione di queste passeggiate casuali (<em>random walk</em>) non possiamo sapere con esattezza dove si troverà ciascuna persona, ma possiamo conoscere con certezza le caratteristiche della distribuzione delle mille distanze dall’origine. Per esempio, possiamo predire in maniera accurata la proporzione di persone che si sono spostate in avanti oppure all’indietro. Oppure, possiamo predire accuratamente la proporzione di persone che si troveranno ad una certa distanza dalla linea di partenza (es., a 1.5 m dall’origine).</p>
<p>Queste predizioni sono possibili perché tali distanze si distribuiscono secondo la legge Normale. I risultati di una tale simulazione sono riportati nella <a href="#fig-rw-normal-4816">Figura&nbsp;<span>14.3</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rw-normal-4816" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-rw-normal-4816-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.3: Passeggiata casuale di 4, 8 e 16 passi. La spezzata nera indica la media delle distanze dall’origine come funzione del numero di passi.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Un kernel density plot delle distanze ottenute dopo 4, 8 e 16 passi è riportato nella <a href="#fig-rw-normal-3panels">Figura&nbsp;<span>14.4</span></a>. Nel pannello di destra, al kernel density plot è stata sovrapposta una densità Normale di opportuni parametri (linea tratteggiata).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rw-normal-3panels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-rw-normal-3panels-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.4: Kernel density plot dei risultati della passeggiata casuale riportata nella figura precente, dopo 4, 8 e 16 passi. Nel pannello di destra, una densità Normale di opportuni parametri è sovrapposta all’istogramma lisciato.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Questa simulazione mostra che qualunque processo nel quale viene sommato un certo numero di valori casuali, tutti provenienti dalla medesima distribuzione, converge ad una distribuzione Normale. Non importa quale sia la forma della distribuzione di partenza: essa può essere uniforme, come nell’esempio presente, o di qualunque altro tipo. La forma della distribuzione da cui viene realizzato il campionamento determina la velocità della convergenza alla Normale. In alcuni casi la convergenza è lenta; in altri casi la convergenza è molto rapida (come nell’esempio presente).</p>
<p>Da un punto di vista formale, diciamo che una variabile casuale continua <span class="math inline">\(Y\)</span> ha una distribuzione Normale se la sua densità è</p>
<p><span id="eq-normal-formula"><span class="math display">\[
f(y; \mu, \sigma) = {1 \over {\sigma\sqrt{2\pi} }} \exp \left\{-\frac{(y -  \mu)^2}{2 \sigma^2} \right\},
\tag{14.1}\]</span></span></p>
<p>dove <span class="math inline">\(\mu \in \mathbb{R}\)</span> e <span class="math inline">\(\sigma &gt; 0\)</span> sono i parametri della distribuzione.</p>
<p>La densità normale è unimodale e simmetrica con una caratteristica forma a campana e con il punto di massima densità in corrispondenza di <span class="math inline">\(\mu\)</span>.</p>
<p>Il significato dei parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span> che appaiono nell’<a href="#eq-normal-formula">Equazione&nbsp;<span>14.1</span></a> viene chiarito dalla dimostrazione che</p>
<p><span class="math display">\[
\mathbb{E}(Y) = \mu, \qquad \mathbb{V}(Y) = \sigma^2.
\]</span></p>
<p>La rappresentazione grafica di quattro densità Normali tutte con media 0 e con deviazioni standard 0.25, 0.5, 1 e 2 è fornita nella <a href="#fig-gaussian-plot-demo">Figura&nbsp;<span>14.5</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gaussian-plot-demo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-gaussian-plot-demo-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.5: Alcune distribuzioni Normali.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="concentrazione" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="concentrazione">
<span class="header-section-number">14.2.1</span> Concentrazione</h3>
<p>È istruttivo osservare il grado di concentrazione della distribuzione Normale attorno alla media:</p>
<p><span class="math display">\[
\begin{align}
P(\mu - \sigma &lt; Y &lt; \mu + \sigma) &amp;= P (-1 &lt; Z &lt; 1) \simeq 0.683, \notag\\
P(\mu - 2\sigma &lt; Y &lt; \mu + 2\sigma) &amp;= P (-2 &lt; Z &lt; 2) \simeq 0.956, \notag\\
P(\mu - 3\sigma &lt; Y &lt; \mu + 3\sigma) &amp;= P (-3 &lt; Z &lt; 3) \simeq 0.997. \notag
\end{align}
\]</span></p>
<p>Si noti come un dato la cui distanza dalla media è superiore a 3 volte la deviazione standard presenti un carattere di eccezionalità perché meno del 0.3% dei dati della distribuzione Normale presentano questa caratteristica.</p>
<p>Per indicare la distribuzione Normale si usa la notazione <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span>.</p>
</section><section id="funzione-di-ripartizione" class="level3" data-number="14.2.2"><h3 data-number="14.2.2" class="anchored" data-anchor-id="funzione-di-ripartizione">
<span class="header-section-number">14.2.2</span> Funzione di ripartizione</h3>
<p>Il valore della funzione di ripartizione di <span class="math inline">\(Y\)</span> nel punto <span class="math inline">\(y\)</span> è l’area sottesa alla curva di densità <span class="math inline">\(f(y)\)</span> nella semiretta <span class="math inline">\((-\infty, y]\)</span>. Non esiste alcuna funzione elementare per la funzione di ripartizione</p>
<p><span id="eq-gaussian-rip-formula"><span class="math display">\[
F(y) = \int_{-\infty}^y {1 \over {\sigma\sqrt{2\pi} }} \exp \left\{-\frac{(y - \mu)^2}{2\sigma^2} \right\} dy,
\tag{14.2}\]</span></span></p>
<p>pertanto le probabilità <span class="math inline">\(P(Y &lt; y)\)</span> vengono calcolate mediante integrazione numerica approssimata. I valori della funzione di ripartizione di una variabile casuale Normale sono dunque forniti da un software.</p>
<div id="exr-gauss-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Esercizio 14.1 </strong></span>Usiamo <span class="math inline">\(\mathsf{R}\)</span> per calcolare la funzione di ripartizione della Normale. La funzione <code>pnorm(q, mean, sd)</code> restituisce la funzione di ripartizione della Normale con media <code>mean</code> e deviazione standard <code>sd</code>, ovvero l’area sottesa alla funzione di densità di una Normale con media <code>mean</code> e deviazione standard <code>sd</code> nell’intervallo <span class="math inline">\([-\infty, q]\)</span>.</p>
<p>Per esempio, in precedenza abbiamo detto che il 68% circa dell’area sottesa ad una Normale è compresa nell’intervallo <span class="math inline">\(\mu \pm \sigma\)</span>. Verifichiamo per la distribuzione del QI <span class="math inline">\(\sim \mathcal{N}(\mu = 100, \sigma = 15)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statistics <span class="im">import</span> NormalDist</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="dv">15</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.6826894921370859</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il 95% dell’area è compresa nell’intervallo <span class="math inline">\(\mu \pm 1.96 \cdot\sigma\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="dv">15</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.9500042097035593</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quasi tutta la distribuzione è compresa nell’intervallo <span class="math inline">\(\mu \pm 3 \cdot\sigma\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="dv">15</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.9973002039367398</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="distribuzione-normale-standard" class="level3" data-number="14.2.3"><h3 data-number="14.2.3" class="anchored" data-anchor-id="distribuzione-normale-standard">
<span class="header-section-number">14.2.3</span> Distribuzione Normale standard</h3>
<p>La distribuzione Normale di parametri <span class="math inline">\(\mu = 0\)</span> e <span class="math inline">\(\sigma = 1\)</span> viene detta <em>distribuzione Normale standard</em>. La famiglia Normale è l’insieme avente come elementi tutte le distribuzioni Normali con parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span> diversi. Tutte le distribuzioni Normali si ottengono dalla Normale standard mediante una trasformazione lineare: se <span class="math inline">\(Y \sim \mathcal{N}(\mu_Y, \sigma_Y)\)</span> allora</p>
<p><span class="math display">\[
X = a + b Y \sim \mathcal{N}(\mu_X = a+b \mu_Y, \sigma_X = \left|b\right|\sigma_Y).
\]</span></p>
<p>L’area sottesa alla curva di densità di <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span> nella semiretta <span class="math inline">\((-\infty, y]\)</span> è uguale all’area sottesa alla densità Normale standard nella semiretta <span class="math inline">\((-\infty, z]\)</span>, in cui <span class="math inline">\(z = (y -\mu_Y )/\sigma_Y\)</span> è il punteggio standard di <span class="math inline">\(Y\)</span>. Per la simmetria della distribuzione, l’area sottesa nella semiretta <span class="math inline">\([1, \infty)\)</span> è uguale all’area sottesa nella semiretta <span class="math inline">\((-\infty, 1]\)</span> e quest’ultima coincide con <span class="math inline">\(F(-1)\)</span>. Analogamente, l’area sottesa nell’intervallo <span class="math inline">\([y_a, y_b]\)</span>, con <span class="math inline">\(y_a &lt; y_b\)</span>, è pari a <span class="math inline">\(F(z_b) - F(z_a)\)</span>, dove <span class="math inline">\(z_a\)</span> e <span class="math inline">\(z_b\)</span> sono i punteggi standard di <span class="math inline">\(y_a\)</span> e <span class="math inline">\(y_b\)</span>.</p>
<p>Si ha anche il problema inverso rispetto a quello del calcolo delle aree: dato un numero <span class="math inline">\(0 \leq p \leq 1\)</span>, il problema è quello di determinare un numero <span class="math inline">\(z \in \mathbb{R}\)</span> tale che <span class="math inline">\(P(Z &lt; z) = p\)</span>. Il valore <span class="math inline">\(z\)</span> cercato è detto <em>quantile</em> di ordine <span class="math inline">\(p\)</span> della Normale standard e può essere trovato mediante un software.</p>
<div id="exr-gauss-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Esercizio 14.2 </strong></span>Supponiamo che l’altezza degli individui adulti segua la distribuzione Normale di media <span class="math inline">\(\mu = 1.7\)</span> m e deviazione standard <span class="math inline">\(\sigma = 0.1\)</span> m. Vogliamo sapere la proporzione di individui adulti con un’altezza compresa tra <span class="math inline">\(1.7\)</span> e <span class="math inline">\(1.8\)</span> m.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Soluzione</em>. </span>Il problema ci chiede di trovare l’area sottesa alla distribuzione <span class="math inline">\(\mathcal{N}(\mu = 1.7, \sigma = 0.1)\)</span> nell’intervallo <span class="math inline">\([1.7, 1.8]\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>La risposta si trova utilizzando la funzione di ripartizione <span class="math inline">\(F(X)\)</span> della legge <span class="math inline">\(\mathcal{N}(1.7, 0.1)\)</span> in corrispondenza dei due valori forniti dal problema: <span class="math inline">\(F(X = 1.8) - F(X = 1.7)\)</span>. Utilizzando la seguente istruzione</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="fl">1.7</span>, sigma<span class="op">=</span><span class="fl">0.1</span>).cdf(<span class="fl">1.8</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="fl">1.7</span>, sigma<span class="op">=</span><span class="fl">0.1</span>).cdf(<span class="fl">1.7</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.34134474606854315</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>otteniamo il <span class="math inline">\(34.13\%\)</span>.</p>
<p>In maniera equivalente, possiamo standardizzare i valori che delimitano l’intervallo considerato e utilizzare la funzione di ripartizione della normale standardizzata. I limiti inferiore e superiore dell’intervallo sono</p>
<p><span class="math display">\[
z_{\text{inf}} = \frac{1.7 - 1.7}{0.1} = 0, \quad z_{\text{sup}} = \frac{1.8 - 1.7}{0.1} = 1.0,
\]</span></p>
<p>quindi otteniamo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>).cdf(<span class="fl">1.0</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>).cdf(<span class="fl">0.0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.3413447460685429</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il modo più semplice per risolvere questo problema resta comunque quello di rendersi conto che la probabilità richiesta non è altro che la metà dell’area sottesa dalle distribuzioni Normali nell’intervallo <span class="math inline">\([\mu - \sigma, \mu + \sigma]\)</span>, ovvero <span class="math inline">\(0.683/2\)</span>.</p>
</div>
<section id="funzione-di-ripartizione-della-normale-standard-e-funzione-logistica" class="level4" data-number="14.2.3.1"><h4 data-number="14.2.3.1" class="anchored" data-anchor-id="funzione-di-ripartizione-della-normale-standard-e-funzione-logistica">
<span class="header-section-number">14.2.3.1</span> Funzione di ripartizione della normale standard e funzione logistica</h4>
<p>Si noti che la funzione logistica (in blu), pur essendo del tutto diversa dalla Normale dal punto di vista formale, assomiglia molto alla Normale standard quando le due cdf hanno la stessa varianza.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="teorema-del-limite-centrale" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="teorema-del-limite-centrale">
<span class="header-section-number">14.3</span> Teorema del limite centrale</h2>
<p>Laplace dimostrò il teorema del limite centrale (TLC) nel 1812. Il TLC dice che se prendiamo una sequenza di variabili casuali indipendenti e le sommiamo, tale somma tende a distribuirsi come una Normale. Inoltre, il TLC specifica, sulla base dei valori attesi e delle varianze delle v.c. che vengono sommate, quali sono i parametri della distribuzione Normale così ottenuta.</p>
<div id="thm-tlc" class="theorem">
<p><span class="theorem-title"><strong>Teorema 14.1 </strong></span>Si supponga che <span class="math inline">\(Y = Y_1, \dots, Y_i, \ldots, Y_n\)</span> sia una sequenza di v.a. i.i.d. con <span class="math inline">\(\mathbb{E}(Y_i) = \mu\)</span> e <span class="math inline">\(\mbox{SD}(Y_i) = \sigma\)</span>. Si definisca una nuova v.c. come:</p>
<p><span class="math display">\[
Z = \frac{1}{n} \sum_{i=1}^n Y_i.
\]</span></p>
<p>Con <span class="math inline">\(n \rightarrow \infty\)</span>, <span class="math inline">\(Z\)</span> tenderà ad una Normale con lo stesso valore atteso di <span class="math inline">\(Y_i\)</span> e una deviazione standard che sarà più piccola della deviazione standard originaria di un fattore pari a <span class="math inline">\(\frac{1}{\sqrt{n}}\)</span>:</p>
<p><span class="math display">\[
p_Z(z) \rightarrow \mathcal{N}\left(z \ \Bigg| \ \mu, \, \frac{1}{\sqrt{n}} \cdot \sigma \right).
\]</span></p>
</div>
<p>Il TLC può essere generalizzato a variabili che non hanno la stessa distribuzione purché siano indipendenti e abbiano aspettative e varianze finite. Molti fenomeni naturali, come l’altezza dell’uomo adulto di entrambi i generi, sono il risultato di una serie di effetti additivi relativamente piccoli, la cui combinazione porta alla normalità, indipendentemente da come gli effetti additivi sono distribuiti. Questo è il motivo per cui la distribuzione normale forniscre una buona rappresentazione della distribuzione di molti fenomeni naturali.</p>
</section><section id="distribuzione-chi-quadrato" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="distribuzione-chi-quadrato">
<span class="header-section-number">14.4</span> Distribuzione Chi-quadrato</h2>
<p>Dalla Normale deriva la distribuzione <span class="math inline">\(\chi^2\)</span>. La distribuzione <span class="math inline">\(\chi^2_{~k}\)</span> con <span class="math inline">\(k\)</span> gradi di libertà descrive la variabile casuale</p>
<p><span class="math display">\[
Z_1^2 + Z_2^2 + \dots + Z_k^2,
\]</span></p>
<p>dove <span class="math inline">\(Z_1, Z_2, \dots, Z_k\)</span> sono variabili casuali i.i.d. che seguono la distribuzione Normale standard <span class="math inline">\(\mathcal{N}(0, 1)\)</span>. La variabile casuale chi-quadrato dipende dal parametro intero positivo <span class="math inline">\(\nu = k\)</span> che ne identifica il numero di gradi di libertà. La densità di probabilità di <span class="math inline">\(\chi^2_{~\nu}\)</span> è</p>
<p><span class="math display">\[
f(x) = C_{\nu} x^{\nu/2-1} \exp (-x/2), \qquad \text{se } x &gt; 0,
\]</span></p>
<p>dove <span class="math inline">\(C_{\nu}\)</span> è una costante positiva.</p>
<p>La <a href="#fig-alcune-chi-quadrato">Figura&nbsp;<span>14.6</span></a> mostra alcune distribuzioni Chi-quadrato variando il parametro <span class="math inline">\(\nu\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-alcune-chi-quadrato" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-alcune-chi-quadrato-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.6: Alcune distribuzioni Chi-quadrato.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="proprietà" class="level3" data-number="14.4.1"><h3 data-number="14.4.1" class="anchored" data-anchor-id="proprietà">
<span class="header-section-number">14.4.1</span> Proprietà</h3>
<ul>
<li>La distribuzione di densità <span class="math inline">\(\chi^2_{~\nu}\)</span> è asimmetrica.</li>
<li>Il valore atteso di una variabile <span class="math inline">\(\chi^2_{~\nu}\)</span> è uguale a <span class="math inline">\(\nu\)</span>.</li>
<li>La varianza di una variabile <span class="math inline">\(\chi^2_{~\nu}\)</span> è uguale a <span class="math inline">\(2\nu\)</span>.</li>
<li>Per <span class="math inline">\(k \rightarrow \infty\)</span>, la <span class="math inline">\(\chi^2_{~\nu} \rightarrow \mathcal{N}\)</span>.</li>
<li>Se <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> sono due variabili casuali chi-quadrato indipendenti con <span class="math inline">\(\nu_1\)</span> e <span class="math inline">\(\nu_2\)</span> gradi di libertà, ne segue che <span class="math inline">\(X + Y \sim \chi^2_m\)</span>, con <span class="math inline">\(m = \nu_1 + \nu_2\)</span>. Tale principio si estende a qualunque numero finito di variabili casuali chi-quadrato indipendenti.</li>
</ul></section></section><section id="distribuzione-t-di-student" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="distribuzione-t-di-student">
<span class="header-section-number">14.5</span> Distribuzione <span class="math inline">\(t\)</span> di Student</h2>
<p>Dalle distribuzioni Normale e Chi-quadrato deriva un’altra distribuzione molto nota, la <span class="math inline">\(t\)</span> di Student. Se <span class="math inline">\(Z \sim \mathcal{N}\)</span> e <span class="math inline">\(W \sim \chi^2_{~\nu}\)</span> sono due variabili casuali indipendenti, allora il rapporto</p>
<p><span id="eq-student-t-distr"><span class="math display">\[
T = \frac{Z}{\Big( \frac{W}{\nu}\Big)^{\frac{1}{2}}}
\tag{14.3}\]</span></span></p>
<p>definisce la distribuzione <span class="math inline">\(t\)</span> di Student con <span class="math inline">\(\nu\)</span> gradi di libertà. Si usa scrivere <span class="math inline">\(T \sim t_{\nu}\)</span>. L’andamento della distribuzione <span class="math inline">\(t\)</span> di Student è simile a quello della distribuzione Normale, ma ha una dispersione maggiore (ha le code più pesanti di una Normale, ovvero ha una varianza maggiore di 1).</p>
<p>La <a href="#fig-alcune-t-student">Figura&nbsp;<span>14.7</span></a> mostra alcune distribuzioni <span class="math inline">\(t\)</span> di Student variando il parametro <span class="math inline">\(\nu\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-alcune-t-student" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/fig-alcune-t-student-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14.7: Alcune distribuzioni <span class="math inline">\(t\)</span> di Student.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="proprietà-1" class="level3" data-number="14.5.1"><h3 data-number="14.5.1" class="anchored" data-anchor-id="proprietà-1">
<span class="header-section-number">14.5.1</span> Proprietà</h3>
<p>La variabile casuale <span class="math inline">\(t\)</span> di Student soddisfa le seguenti proprietà:</p>
<ol type="1">
<li>Per <span class="math inline">\(\nu \rightarrow \infty\)</span>, <span class="math inline">\(t_{\nu}\)</span> tende alla normale standard <span class="math inline">\(\mathcal{N}(0, 1)\)</span>.</li>
<li>La densità della <span class="math inline">\(t_{\nu}\)</span> è una funzione simmetrica con valore atteso nullo.</li>
<li>Per <span class="math inline">\(\nu &gt; 2\)</span>, la varianza della <span class="math inline">\(t_{\nu}\)</span> vale <span class="math inline">\(\nu/(\nu - 2)\)</span>; pertanto è sempre maggiore di 1 e tende a 1 per <span class="math inline">\(\nu \rightarrow \infty\)</span>.</li>
</ol></section></section><section id="funzione-beta-di-eulero" class="level2" data-number="14.6"><h2 data-number="14.6" class="anchored" data-anchor-id="funzione-beta-di-eulero">
<span class="header-section-number">14.6</span> Funzione beta di Eulero</h2>
<p>La funzione beta di Eulero è una funzione matematica, <em>non</em> una densità di probabilità. La menzioniamo qui perché viene utilizzata nella distribuzione Beta. La funzione beta di Eulero si può scrivere in molti modi diversi; per i nostri scopi la presentiamo così:</p>
<p><span id="eq-eulero-function"><span class="math display">\[
B(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha + \beta)}\,,
\tag{14.4}\]</span></span></p>
<p>dove <span class="math inline">\(\Gamma(x)\)</span> è la funzione Gamma, ovvero il fattoriale discendente, cioè</p>
<p><span class="math display">\[
(x-1)(x-2)\ldots (x-n+1)\notag\,.
\]</span></p>
<div id="exr-beta-function-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Esercizio 14.3 </strong></span>Per esempio, posti <span class="math inline">\(\alpha = 3\)</span> e <span class="math inline">\(\beta = 9\)</span>, la funzione beta assume il valore</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.special <span class="im">as</span> sc</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sc.beta(alpha, beta)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lo stesso risultato si ottiene con</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>((<span class="dv">2</span>) <span class="op">*</span> (<span class="dv">8</span> <span class="op">*</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">4</span> <span class="op">*</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">2</span>)) <span class="op">/</span> (<span class="dv">11</span> <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> <span class="dv">9</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">*</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">4</span> <span class="op">*</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ovvero</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sc.gamma(alpha) <span class="op">*</span> sc.gamma(beta) <span class="op">/</span> sc.gamma(alpha <span class="op">+</span> beta)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="distribuzione-beta" class="level2" data-number="14.7"><h2 data-number="14.7" class="anchored" data-anchor-id="distribuzione-beta">
<span class="header-section-number">14.7</span> Distribuzione Beta</h2>
<p>La distribuzione Beta è una distribuzione usata per modellare percentuali e proporzioni in quanto è definita sull’intervallo <span class="math inline">\((0; 1)\)</span> – ovvero, non include i valori 0 o 1.</p>
<div id="def-beta-distribution" class="theorem definition">
<p><span class="theorem-title"><strong>Definizione 14.1 </strong></span>Sia <span class="math inline">\(\pi\)</span> una variabile casuale che può assumere qualsiasi valore compreso tra 0 e 1, cioè <span class="math inline">\(\pi \in [0, 1]\)</span>. Diremo che <span class="math inline">\(\pi\)</span> segue la distribuzione Beta di parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\pi \sim \text{Beta}(\alpha, \beta)\)</span>, se la sua densità è</p>
<p><span id="eq-beta-distr-formula"><span class="math display">\[
\begin{align}
\text{Beta}(\pi \mid \alpha, \beta) &amp;= \frac{1}{B(\alpha, \beta)}\pi^{\alpha-1} (1-\pi)^{\beta-1}\notag\\
&amp;=  \frac{\Gamma(\alpha+ \beta)}{\Gamma(\alpha)\Gamma(\beta)}\pi^{\alpha-1} (1-\pi)^{\beta-1} \quad \text{per } \pi \in [0, 1]\,,
\end{align}
\tag{14.5}\]</span></span></p>
<p>laddove <span class="math inline">\(B(\alpha, \beta)\)</span> è la funzione beta di Eulero.</p>
</div>
<p>I termini <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> sono i parametri della distribuzione Beta e devono essere entrambi positivi. Tali parametri possono essere interpretati come l’espressione delle nostre credenze a priori relative ad una sequenza di prove Bernoulliane. Il parametro <span class="math inline">\(\alpha\)</span> rappresenta il numero di “successi” e il parametro <span class="math inline">\(\beta\)</span> il numero di “insuccessi”:</p>
<p><span class="math display">\[
\frac{\text{Numero di successi}}{\text{Numero di successi} + \text{Numero di insuccessi}} = \frac{\alpha}{\alpha + \beta}\notag\,.
\]</span></p>
<p>Il rapporto <span class="math inline">\(\frac{1}{B(\alpha, \beta)} = \frac{\Gamma(\alpha+b)}{\Gamma(\alpha)\Gamma(\beta)}\)</span> è una costante di normalizzazione:</p>
<p><span class="math display">\[
\int_0^1 \pi^{\alpha-1} (1-\pi)^{\beta-1} = \frac{\Gamma(\alpha+b)}{\Gamma(\alpha)\Gamma(\beta)}\,.
\]</span></p>
<p>Ad esempio, con <span class="math inline">\(\alpha = 3\)</span> e <span class="math inline">\(\beta = 9\)</span> abbiamo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> quad</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrand(p, a, b):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p<span class="op">**</span>(a<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>p)<span class="op">**</span>(b<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>result, error <span class="op">=</span> quad(integrand, <span class="dv">0</span>, <span class="dv">1</span>, args<span class="op">=</span>(a, b))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ovvero</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> math.gamma(a) <span class="op">*</span> math.gamma(b) <span class="op">/</span> math.gamma(a <span class="op">+</span> b)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ovvero</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sc.beta(a, b)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00202020202020202</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il valore atteso, la moda e la varianza di una distribuzione Beta sono dati dalle seguenti equazioni:</p>
<p><span id="eq-beta-mean"><span class="math display">\[
\mathbb{E}(\pi) = \frac{\alpha}{\alpha+\beta}\,,
\tag{14.6}\]</span></span></p>
<p><span id="eq-beta-mode"><span class="math display">\[
\mbox{Mo}(\pi) = \frac{\alpha-1}{\alpha+\beta-2}\,,
\tag{14.7}\]</span></span></p>
<p><span id="eq-beta-var"><span class="math display">\[
\mathbb{V}(\pi) = \frac{\alpha \beta}{(\alpha+\beta)^2 (\alpha+\beta+1)}\,.
\tag{14.8}\]</span></span></p>
<p>Al variare di <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> si ottengono molte distribuzioni di forma diversa; un’illustrazione è fornita dalla seguente <a href="https://en.wikipedia.org/wiki/File:PDF_of_the_Beta_distribution.gif">GIF animata</a>.</p>
<p>Si può ottenere una rappresentazione grafica della distribuzione <span class="math inline">\(\mbox{Beta}(\pi \mid \alpha, \beta)\)</span> nel modo seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">3</span>, <span class="dv">9</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>, <span class="fl">0.999</span>, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, beta.pdf(x, a, b), <span class="st">'r-'</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="fl">0.0</span>, <span class="fl">1.0</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (0.0, 1.0)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribuzione Beta'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valori di una variabile casuale X (0, 1)'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Densità'</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>La funzione <code>beta_mean_mode_variance()</code> ci restituisce la media, moda e varianza della distribuzione Beta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> beta_mean_mode_variance(alpha, beta):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> alpha <span class="op">/</span> (alpha <span class="op">+</span> beta)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> (alpha <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (alpha <span class="op">+</span> beta <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    variance <span class="op">=</span> alpha <span class="op">*</span> beta <span class="op">/</span> ((alpha <span class="op">+</span> beta)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (alpha <span class="op">+</span> beta <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mean, mode, variance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per esempio:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mean, mode, variance <span class="op">=</span> beta_mean_mode_variance(alpha, beta)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Mean: </span><span class="sc">{</span>mean<span class="sc">}</span><span class="ss">, Mode: </span><span class="sc">{</span>mode<span class="sc">}</span><span class="ss">, Variance: </span><span class="sc">{</span>variance<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean: 0.25, Mode: 0.2, Variance: 0.014423076923076924</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="remark proof">
<p><span class="proof-title"><em>Nota</em>. </span>Attenzione alle parole: in questo contesto, il termine “beta” viene utilizzato con tre significati diversi:</p>
<ul>
<li>la distribuzione di densità Beta,</li>
<li>la funzione matematica beta,</li>
<li>il parametro <span class="math inline">\(\beta\)</span>.</li>
</ul>
</div>
</section><section id="distribuzione-di-cauchy" class="level2" data-number="14.8"><h2 data-number="14.8" class="anchored" data-anchor-id="distribuzione-di-cauchy">
<span class="header-section-number">14.8</span> Distribuzione di Cauchy</h2>
<p>La distribuzione di Cauchy è un caso speciale della distribuzione di <span class="math inline">\(t\)</span> di Student con 1 grado di libertà. È definita da una densità di probabilità che corrisponde alla seguente funzione, dipendente da due parametri <span class="math inline">\(\theta\)</span> e <span class="math inline">\(d\)</span> (con la condizione <span class="math inline">\(d &gt; 0\)</span>),</p>
<p><span id="eq-cauchy-formula"><span class="math display">\[
f(x; \theta, d) = \frac{1}{\pi d} \frac{1}{1 + \left(\frac{x - \theta}{d} \right)^2},
\tag{14.9}\]</span></span></p>
<p>dove <span class="math inline">\(\theta\)</span> è la mediana della distribuzione e <span class="math inline">\(d\)</span> ne misura la larghezza a metà altezza.</p>
</section><section id="distribuzione-log-normale" class="level2" data-number="14.9"><h2 data-number="14.9" class="anchored" data-anchor-id="distribuzione-log-normale">
<span class="header-section-number">14.9</span> Distribuzione log-normale</h2>
<p>Sia <span class="math inline">\(y\)</span> una variabile casuale avente distribuzione normale con media <span class="math inline">\(\mu\)</span> e varianza <span class="math inline">\(\sigma^2\)</span>. Definiamo poi una nuova variabile casuale <span class="math inline">\(x\)</span> attraverso la relazione</p>
<p><span class="math display">\[
x = e^y \quad \Longleftrightarrow \quad y = \log x.
\]</span> Il dominio di definizione della <span class="math inline">\(x\)</span> è il semiasse <span class="math inline">\(x &gt; 0\)</span> e la densità di probabilità <span class="math inline">\(f(x)\)</span> è data da</p>
<p><span id="eq-lognormal-formula"><span class="math display">\[
f(x) = \frac{1}{\sigma \sqrt{2 \pi}} \frac{1}{x} \exp \left\{-\frac{(\log x -  \mu)^2}{2 \sigma^2} \right\}.
\tag{14.10}\]</span></span></p>
<p>Questa funzione di densità è chiamata log-normale.</p>
<p>Il valore atteso e la varianza di una distribuzione log-normale sono dati dalle seguenti equazioni:</p>
<p><span class="math display">\[
\mathbb{E}(x) = \exp \left\{\mu + \frac{\sigma^2}{2} \right\}.
\]</span></p>
<p><span class="math display">\[
\mathbb{V}(x) = \exp \left\{2 \mu + \sigma^2 \right\} \left(\exp \left\{\sigma^2 \right\}  -1\right).
\]</span></p>
<p>Si può dimostrare che il prodotto di variabili casuali log-normali ed indipendenti segue una distribuzione log-normale.</p>
</section><section id="distribuzione-di-pareto" class="level2" data-number="14.10"><h2 data-number="14.10" class="anchored" data-anchor-id="distribuzione-di-pareto">
<span class="header-section-number">14.10</span> Distribuzione di Pareto</h2>
<p>La distribuzione paretiana (o distribuzione di Pareto) è una distribuzione di probabilità continua e così chiamata in onore di Vilfredo Pareto. La distribuzione di Pareto è una distribuzione di probabilità con legge di potenza utilizzata nella descrizione di fenomeni sociali e molti altri tipi di fenomeni osservabili. Originariamente applicata per descrivere la distribuzione del reddito in una società, adattandosi alla tendenza che una grande porzione di ricchezza è detenuta da una piccola frazione della popolazione, la distribuzione di Pareto è diventata colloquialmente nota e indicata come il principio di Pareto, o “regola 80-20”. Questa regola afferma che, ad esempio, l’80% della ricchezza di una società è detenuto dal 20% della sua popolazione. Viene spesso applicata nello studio della distribuzione del reddito, della dimensione dell’impresa, della dimensione di una popolazione e nelle fluttuazioni del prezzo delle azioni.</p>
<p>La densità di una distribuzione di Pareto è</p>
<p><span id="eq-pareto-formula"><span class="math display">\[
f(x)=(x_m/x)^\alpha,
\tag{14.11}\]</span></span></p>
<p>dove <span class="math inline">\(x_m\)</span> (parametro di scala) è il minimo (necessariamente positivo) valore possibile di <span class="math inline">\(X\)</span> e <span class="math inline">\(\alpha\)</span> è un parametro di forma.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="023_cont_rv_distr_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>La distribuzione di Pareto ha una asimmetria positiva. Il supporto della distribuzione di Pareto è la retta reale positiva. Tutti i valori devono essere maggiori del parametro di scala <span class="math inline">\(x_m\)</span>, che è in realtà un parametro di soglia.</p>
</section><section id="commenti-e-considerazioni-finali" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="commenti-e-considerazioni-finali">Commenti e considerazioni finali</h2>
<p>In questa dispensa le densità continue che useremo più spesso sono la distribuzione gaussiana e la distribuzione Beta. Faremo un uso limitato della distribuzione <span class="math inline">\(t\)</span> di Student e della distribuzione di Cauchy. Le altre distribuzioni qui descritte sono stato presentate per completezza.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography" style="display: none">
<div id="ref-McElreath_rethinking" class="csl-entry" role="doc-biblioentry">
McElreath, R. (2020). <em>Statistical rethinking: <span>A</span> <span>Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (2nd Edition). CRC Press.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./022_discr_rv_distr.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./024_likelihood.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">La funzione di verosimiglianza</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb15" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Distribuzioni di v.c. continue {#sec-distr-rv-cont}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"scales"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gghighlight"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>Dopo avere introdotto con una simulazione il concetto di funzione di densità nel Capitolo @sec-intro-density-function, prendiamo ora in esame alcune delle densità di probabilità più note. La più importante di esse è sicuramente la distribuzione Normale.</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione Gaussiana</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Non c'è un'unica distribuzione gaussiana (o normale): la distribuzione gaussiana è una famiglia di distribuzioni. Tali distribuzioni sono dette "gaussiane" in onore di Carl Friedrich Gauss (uno dei più grandi matematici della storia il quale, tra le altre cose, scoprì l'utilità di tale funzione di densità per descrivere gli errori di misurazione). Adolphe Quetelet, il padre delle scienze sociali quantitative, fu il primo ad applicare tale funzione di densità alle misurazioni dell'uomo. Karl Pearson usò per primo il termine "distribuzione normale" anche se ammise che questa espressione "ha lo svantaggio di indurre le persone a credere che le altre distribuzioni, in un senso o nell'altro, non siano normali."</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">### Limite delle distribuzioni binomiali</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>Iniziamo con un un breve excursus storico. Nel 1733, Abraham de Moivre notò che, aumentando il numero di prove di una distribuzione binomiale, la distribuzione risultante diventava quasi simmetrica e a forma campanulare. Con 10 prove e una probabilità di successo di 0.9 in ciascuna prova, la distribuzione è chiaramente asimmetrica.</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-demoivre-1, echo=FALSE, fig.cap = 'Probabilità del numero di successi in $N = 10$ prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione $\\mbox{Bin}(y \\mid 10, 0.9)$. Con solo dieci prove, la distribuzione è fortemente asimmetrica negativa.'}</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, N, <span class="fl">0.9</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>binomial_limit_plot <span class="ot">&lt;-</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.2</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Binomial(y | 10, 0.9)"</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>binomial_limit_plot</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>Ma se aumentiamo il numero di prove di un fattore di 100 a *N* = 1000, senza modificare la probabilità di successo di 0.9, la distribuzione assume una forma campanulare quasi simmetrica. Dunque, de Moivre scoprì che, quando *N* è grande, la funzione gaussiana (che introdurremo qui sotto), nonostante sia la densità di v.a. continue, fornisce una buona approssimazione alla funzione di massa di probabilità binomiale.</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-demoivre-2, echo=FALSE, fig.cap = 'Probabilità del numero di successi in $N = 1000$ prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione $\\mbox{Bin}(y \\mid 1000, 0.9)$. Con mille prove, la distribuzione è quasi simmetrica a forma campanulare.'}</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, N, <span class="fl">0.9</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>binomial_limit_plot <span class="ot">&lt;-</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Binomial(y | 1000, 0.9)"</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">850</span>, <span class="dv">950</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>binomial_limit_plot</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>La distribuzione Normale fu scoperta da Gauss nel 1809. Il Paragrafo successivo illustra come si possa giungere alla Normale mediante una simulazione.</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## La Normale prodotta con una simulazione {#normal-random-walk}</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>@McElreath_rethinking illustra come sia possibile giungere alla distribuzione Normale mediante una simulazione. Supponiamo che vi siano mille persone tutte allineate su una linea di partenza. Quando viene dato un segnale, ciascuna persona lancia una moneta e fa un passo in avanti oppure all'indietro a seconda che sia uscita testa o croce. Supponiamo che la lunghezza di ciascun passo vari da 0 a 1 metro. Ciascuna persona lancia una moneta 16 volte e dunque compie 16 passi.</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>Alla conclusione di queste passeggiate casuali (*random walk*) non possiamo sapere con esattezza dove si troverà ciascuna persona, ma possiamo conoscere con certezza le caratteristiche della distribuzione delle mille distanze dall'origine. Per esempio, possiamo predire in maniera accurata la proporzione di persone che si sono spostate in avanti oppure all'indietro. Oppure, possiamo predire accuratamente la proporzione di persone che si troveranno ad una certa distanza dalla linea di partenza (es., a 1.5 m dall'origine).</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>Queste predizioni sono possibili perché tali distanze si distribuiscono secondo la legge Normale. I risultati di una tale simulazione sono riportati nella @fig-rw-normal-4816.</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-rw-normal-4816, echo=FALSE, fig.cap= "Passeggiata casuale di 4, 8 e 16 passi. La spezzata nera indica la media delle distanze dall'origine come funzione del numero di passi."}</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(<span class="dv">100</span>, <span class="fu">runif</span>(<span class="dv">16</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="dv">0</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">step =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-</span>step) <span class="sc">%&gt;%</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">each =</span> <span class="dv">17</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(person) <span class="sc">%&gt;%</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> <span class="fu">cumsum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pos,</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> position, <span class="at">group =</span> person)</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> person <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="at">alpha =</span> person <span class="sc">&lt;</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Numero di passi"</span>,</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">16</span>)</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Posizione"</span>) <span class="sc">+</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>Un kernel density plot delle distanze ottenute dopo 4, 8 e 16 passi è riportato nella @fig-rw-normal-3panels. Nel pannello di destra, al kernel density plot è stata sovrapposta una densità Normale di opportuni parametri (linea tratteggiata).</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-rw-normal-3panels, echo=FALSE, fig.cap="Kernel density plot dei risultati della passeggiata casuale riportata nella figura precente, dopo 4, 8 e 16 passi. Nel pannello di destra, una densità Normale di opportuni parametri è sovrapposta all'istogramma lisciato."}</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>  pos <span class="sc">%&gt;%</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(step <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position)) <span class="sc">+</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"4 passi"</span>)</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>  pos <span class="sc">%&gt;%</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(step <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position)) <span class="sc">+</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outline.type =</span> <span class="st">"full"</span>) <span class="sc">+</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"8 passi"</span>)</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>  pos <span class="sc">%&gt;%</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(step <span class="sc">==</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sd =</span> <span class="fu">sd</span>(position)) <span class="sc">%&gt;%</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sd)</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>  pos <span class="sc">%&gt;%</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(step <span class="sc">==</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position)) <span class="sc">+</span></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dnorm,</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sd),</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"16 passi"</span>,</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Densità"</span></span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">&amp;</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>Questa simulazione mostra che qualunque processo nel quale viene sommato un certo numero di valori casuali, tutti provenienti dalla medesima distribuzione, converge ad una distribuzione Normale. Non importa quale sia la forma della distribuzione di partenza: essa può essere uniforme, come nell'esempio presente, o di qualunque altro tipo. La forma della distribuzione da cui viene realizzato il campionamento determina la velocità della convergenza alla Normale. In alcuni casi la convergenza è lenta; in altri casi la convergenza è molto rapida (come nell'esempio presente).</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>Da un punto di vista formale, diciamo che una variabile casuale continua $Y$ ha una distribuzione Normale se la sua densità è</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>f(y; \mu, \sigma) = {1 \over {\sigma\sqrt{2\pi} }} \exp \left<span class="sc">\{</span>-\frac{(y -  \mu)^2}{2 \sigma^2} \right<span class="sc">\}</span>,</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>$$ {#eq-normal-formula}</span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>dove $\mu \in \mathbb{R}$ e $\sigma &gt; 0$ sono i parametri della distribuzione.</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>La densità normale è unimodale e simmetrica con una caratteristica forma a campana e con il punto di massima densità in corrispondenza di $\mu$.</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>Il significato dei parametri $\mu$ e $\sigma$ che appaiono nell'@eq-normal-formula viene chiarito dalla dimostrazione che</span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>\mathbb{E}(Y) = \mu, \qquad \mathbb{V}(Y) = \sigma^2.</span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>La rappresentazione grafica di quattro densità Normali tutte con media 0 e con deviazioni standard 0.25, 0.5, 1 e 2 è fornita nella @fig-gaussian-plot-demo.</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-gaussian-plot-demo, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE, fig.cap = "Alcune distribuzioni Normali."}</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize statistical distributions</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>distribution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dset, dfun, darg, name){</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_update</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>))</span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dset, <span class="fu">aes</span>(<span class="at">x=</span>x))</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(darg)){</span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>        iarg <span class="ot">&lt;-</span> darg[[index]]</span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">names</span>(iarg)</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">sapply</span>(params,</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>                         <span class="cf">switch</span>,</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'size'</span><span class="ot">=</span><span class="st">'n'</span>,</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'prob'</span><span class="ot">=</span><span class="st">'p'</span>,</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'lambda'</span><span class="ot">=</span><span class="st">'lambda'</span>,</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'shape'</span><span class="ot">=</span><span class="st">'alpha'</span>,</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'rate'</span><span class="ot">=</span><span class="st">'beta'</span>,</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'mean'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sd'</span><span class="ot">=</span><span class="st">'sigma'</span>,</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'df'</span><span class="ot">=</span><span class="st">'df'</span>,</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'meanlog'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sdlog'</span><span class="ot">=</span><span class="st">'sigma'</span>)</span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>        label <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste</span>(params, <span class="fu">unlist</span>(iarg), <span class="at">sep=</span><span class="st">'=='</span>), <span class="at">collapse=</span><span class="st">'*</span><span class="sc">\'</span><span class="st">,</span><span class="sc">\'</span><span class="st">~~'</span>)</span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>        gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size=</span><span class="fl">0.75</span>,</span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fun=</span>dfun,</span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>                               <span class="at">args=</span>iarg,</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geom=</span><span class="st">'path'</span>)</span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">'poisson|binomial'</span>, name))</span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>            gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fun=</span>dfun,</span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">args=</span>iarg,</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">geom=</span><span class="st">'point'</span>)</span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"E"</span>,</span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>                                <span class="at">name=</span><span class="st">'Parameters'</span>,</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">parse_format</span>())</span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">'</span><span class="sc">\n</span><span class="st">y'</span>, <span class="at">y=</span><span class="st">'f(y)</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(gg)</span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distribution</span></span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>normal_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>    darg <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.25</span>),</span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.5</span>),</span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>),</span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">2</span>))</span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distribution_plot</span>(dset, dnorm, darg, <span class="at">name=</span><span class="st">'normal'</span>)</span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a><span class="fu">normal_plot</span>()</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### Concentrazione</span></span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>È istruttivo osservare il grado di concentrazione della distribuzione Normale attorno alla media:</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>P(\mu - \sigma &lt; Y &lt; \mu + \sigma) &amp;= P (-1 &lt; Z &lt; 1) \simeq 0.683, \notag<span class="sc">\\</span></span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>P(\mu - 2\sigma &lt; Y &lt; \mu + 2\sigma) &amp;= P (-2 &lt; Z &lt; 2) \simeq 0.956, \notag<span class="sc">\\</span></span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>P(\mu - 3\sigma &lt; Y &lt; \mu + 3\sigma) &amp;= P (-3 &lt; Z &lt; 3) \simeq 0.997. \notag</span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>Si noti come un dato la cui distanza dalla media è superiore a 3 volte la deviazione standard presenti un carattere di eccezionalità perché meno del 0.3% dei dati della distribuzione Normale presentano questa caratteristica.</span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>Per indicare la distribuzione Normale si usa la notazione $\mathcal{N}(\mu, \sigma)$.</span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a><span class="fu">### Funzione di ripartizione</span></span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>Il valore della funzione di ripartizione di $Y$ nel punto $y$ è l'area sottesa alla curva di densità $f(y)$ nella semiretta $(-\infty, y]$. Non esiste alcuna funzione elementare per la funzione di ripartizione</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a>F(y) = \int_{-\infty}^y {1 \over {\sigma\sqrt{2\pi} }} \exp \left<span class="sc">\{</span>-\frac{(y - \mu)^2}{2\sigma^2} \right<span class="sc">\}</span> dy, </span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gaussian-rip-formula}</span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a>pertanto le probabilità $P(Y &lt; y)$ vengono calcolate mediante integrazione numerica approssimata. I valori della funzione di ripartizione di una variabile casuale Normale sono dunque forniti da un software.</span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a>::: {#exr-gauss-1}</span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a>Usiamo $\mathsf{R}$ per calcolare la funzione di ripartizione della Normale. La funzione <span class="in">`pnorm(q, mean, sd)`</span> restituisce la funzione di ripartizione della Normale con media <span class="in">`mean`</span> e deviazione standard <span class="in">`sd`</span>, ovvero l'area sottesa alla funzione di densità di una Normale con media <span class="in">`mean`</span> e deviazione standard <span class="in">`sd`</span> nell'intervallo $<span class="co">[</span><span class="ot">-\infty, q</span><span class="co">]</span>$.</span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a>Per esempio, in precedenza abbiamo detto che il 68% circa dell'area sottesa ad una Normale è compresa nell'intervallo $\mu \pm \sigma$. Verifichiamo per la distribuzione del QI $\sim \mathcal{N}(\mu = 100, \sigma = 15)$:</span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statistics <span class="im">import</span> NormalDist</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="dv">15</span>)</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>Il 95% dell'area è compresa nell'intervallo $\mu \pm 1.96 \cdot\sigma$:</span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="dv">15</span>)</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>Quasi tutta la distribuzione è compresa nell'intervallo $\mu \pm 3 \cdot\sigma$:</span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="dv">15</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="dv">100</span>, sigma<span class="op">=</span><span class="dv">15</span>).cdf(<span class="dv">100</span><span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="dv">15</span>)</span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribuzione Normale standard</span></span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>La distribuzione Normale di parametri $\mu = 0$ e $\sigma = 1$ viene detta *distribuzione Normale standard*. La famiglia Normale è l'insieme avente come elementi tutte le distribuzioni Normali con parametri $\mu$ e $\sigma$ diversi. Tutte le distribuzioni Normali si ottengono dalla Normale standard mediante una trasformazione lineare: se $Y \sim \mathcal{N}(\mu_Y, \sigma_Y)$ allora</span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>X = a + b Y \sim \mathcal{N}(\mu_X = a+b \mu_Y, \sigma_X = \left|b\right|\sigma_Y).</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>L'area sottesa alla curva di densità di $\mathcal{N}(\mu, \sigma)$ nella semiretta $(-\infty, y]$ è uguale all'area sottesa alla densità Normale standard nella semiretta $(-\infty, z]$, in cui $z = (y -\mu_Y )/\sigma_Y$ è il punteggio standard di $Y$. Per la simmetria della distribuzione, l'area sottesa nella semiretta $<span class="co">[</span><span class="ot">1, \infty)$ è uguale all'area sottesa nella semiretta $(-\infty, 1</span><span class="co">]</span>$ e quest'ultima coincide con $F(-1)$. Analogamente, l'area sottesa nell'intervallo $<span class="co">[</span><span class="ot">y_a, y_b</span><span class="co">]</span>$, con $y_a &lt; y_b$, è pari a $F(z_b) - F(z_a)$, dove $z_a$ e $z_b$ sono i punteggi standard di $y_a$ e $y_b$.</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>Si ha anche il problema inverso rispetto a quello del calcolo delle aree: dato un numero $0 \leq p \leq 1$, il problema è quello di determinare un numero $z \in \mathbb{R}$ tale che $P(Z &lt; z) = p$. Il valore $z$ cercato è detto *quantile* di ordine $p$ della Normale standard e può essere trovato mediante un software.</span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>::: {#exr-gauss-2}</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>Supponiamo che l'altezza degli individui adulti segua la distribuzione Normale di media $\mu = 1.7$ m e deviazione standard $\sigma = 0.1$ m. Vogliamo sapere la proporzione di individui adulti con un'altezza compresa tra $1.7$ e $1.8$ m.</span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>::: solution</span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>Il problema ci chiede di trovare l'area sottesa alla distribuzione $\mathcal{N}(\mu = 1.7, \sigma = 0.1)$ nell'intervallo $<span class="co">[</span><span class="ot">1.7, 1.8</span><span class="co">]</span>$:</span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">1.4</span>, <span class="fl">2.0</span>, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">1.7</span>, <span class="at">sd =</span> <span class="fl">0.1</span>))</span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"sky blue"</span>) <span class="sc">+</span></span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(x <span class="sc">&lt;</span> <span class="fl">1.8</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="fl">1.7</span>) <span class="sc">+</span></span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Altezza"</span>,</span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Densità"</span></span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>La risposta si trova utilizzando la funzione di ripartizione $F(X)$ della legge $\mathcal{N}(1.7, 0.1)$ in corrispondenza dei due valori forniti dal problema: $F(X = 1.8) - F(X = 1.7)$. Utilizzando la seguente istruzione</span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="fl">1.7</span>, sigma<span class="op">=</span><span class="fl">0.1</span>).cdf(<span class="fl">1.8</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="fl">1.7</span>, sigma<span class="op">=</span><span class="fl">0.1</span>).cdf(<span class="fl">1.7</span>)</span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>otteniamo il $34.13\%$.</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>In maniera equivalente, possiamo standardizzare i valori che delimitano l'intervallo considerato e utilizzare la funzione di ripartizione della normale standardizzata. I limiti inferiore e superiore dell'intervallo sono</span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>z_{\text{inf}} = \frac{1.7 - 1.7}{0.1} = 0, \quad z_{\text{sup}} = \frac{1.8 - 1.7}{0.1} = 1.0,</span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a>quindi otteniamo</span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>NormalDist(mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>).cdf(<span class="fl">1.0</span>) <span class="op">-</span> NormalDist(mu<span class="op">=</span><span class="fl">0.0</span>, sigma<span class="op">=</span><span class="fl">1.0</span>).cdf(<span class="fl">0.0</span>)</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a>Il modo più semplice per risolvere questo problema resta comunque quello di rendersi conto che la probabilità richiesta non è altro che la metà dell'area sottesa dalle distribuzioni Normali nell'intervallo $<span class="co">[</span><span class="ot">\mu - \sigma, \mu + \sigma</span><span class="co">]</span>$, ovvero $0.683/2$.</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Funzione di ripartizione della normale standard e funzione logistica</span></span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a>Si noti che la funzione logistica (in blu), pur essendo del tutto diversa dalla Normale dal punto di vista formale, assomiglia molto alla Normale standard quando le due cdf hanno la stessa varianza.</span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm) <span class="sc">+</span></span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> plogis,</span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">scale =</span> <span class="fl">0.56</span>)</span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teorema del limite centrale</span></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>Laplace dimostrò il teorema del limite centrale (TLC) nel 1812. Il TLC dice che se prendiamo una sequenza di variabili casuali indipendenti e le sommiamo, tale somma tende a distribuirsi come una Normale. Inoltre, il TLC specifica, sulla base dei valori attesi e delle varianze delle v.c. che vengono sommate, quali sono i parametri della distribuzione Normale così ottenuta.</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>::: {#thm-tlc}</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a>Si supponga che $Y = Y_1, \dots, Y_i, \ldots, Y_n$ sia una sequenza di v.a. i.i.d. con $\mathbb{E}(Y_i) = \mu$ e $\mbox{SD}(Y_i) = \sigma$. Si definisca una nuova v.c. come:</span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>Z = \frac{1}{n} \sum_{i=1}^n Y_i.</span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>Con $n \rightarrow \infty$, $Z$ tenderà ad una Normale con lo stesso valore atteso di $Y_i$ e una deviazione standard che sarà più piccola della deviazione standard originaria di un fattore pari a $\frac{1}{\sqrt{n}}$:</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>p_Z(z) \rightarrow \mathcal{N}\left(z \ \Bigg| \ \mu, \, \frac{1}{\sqrt{n}} \cdot \sigma \right).</span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a>Il TLC può essere generalizzato a variabili che non hanno la stessa distribuzione purché siano indipendenti e abbiano aspettative e varianze finite. Molti fenomeni naturali, come l'altezza dell'uomo adulto di entrambi i generi, sono il risultato di una serie di effetti additivi relativamente piccoli, la cui combinazione porta alla normalità, indipendentemente da come gli effetti additivi sono distribuiti. Questo è il motivo per cui la distribuzione normale forniscre una buona rappresentazione della distribuzione di molti fenomeni naturali.</span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione Chi-quadrato</span></span>
<span id="cb15-360"><a href="#cb15-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-361"><a href="#cb15-361" aria-hidden="true" tabindex="-1"></a>Dalla Normale deriva la distribuzione $\chi^2$. La distribuzione $\chi^2_{~k}$ con $k$ gradi di libertà descrive la variabile casuale</span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a>Z_1^2 + Z_2^2 + \dots + Z_k^2,</span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-367"><a href="#cb15-367" aria-hidden="true" tabindex="-1"></a>dove $Z_1, Z_2, \dots, Z_k$ sono variabili casuali i.i.d. che seguono la distribuzione Normale standard $\mathcal{N}(0, 1)$. La variabile casuale chi-quadrato dipende dal parametro intero positivo $\nu = k$ che ne identifica il numero di gradi di libertà. La densità di probabilità di $\chi^2_{~\nu}$ è</span>
<span id="cb15-368"><a href="#cb15-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-370"><a href="#cb15-370" aria-hidden="true" tabindex="-1"></a>f(x) = C_{\nu} x^{\nu/2-1} \exp (-x/2), \qquad \text{se } x &gt; 0,</span>
<span id="cb15-371"><a href="#cb15-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-372"><a href="#cb15-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-373"><a href="#cb15-373" aria-hidden="true" tabindex="-1"></a>dove $C_{\nu}$ è una costante positiva.</span>
<span id="cb15-374"><a href="#cb15-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-375"><a href="#cb15-375" aria-hidden="true" tabindex="-1"></a>La @fig-alcune-chi-quadrato mostra alcune distribuzioni Chi-quadrato variando il parametro $\nu$.</span>
<span id="cb15-376"><a href="#cb15-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-377"><a href="#cb15-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-alcune-chi-quadrato, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE, fig.cap = "Alcune distribuzioni Chi-quadrato."}</span></span>
<span id="cb15-378"><a href="#cb15-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-379"><a href="#cb15-379" aria-hidden="true" tabindex="-1"></a>distribution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dset, dfun, darg, name){</span>
<span id="cb15-380"><a href="#cb15-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_update</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>))</span>
<span id="cb15-381"><a href="#cb15-381" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dset, <span class="fu">aes</span>(<span class="at">x=</span>x))</span>
<span id="cb15-382"><a href="#cb15-382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(darg)){</span>
<span id="cb15-383"><a href="#cb15-383" aria-hidden="true" tabindex="-1"></a>        iarg <span class="ot">&lt;-</span> darg[[index]]</span>
<span id="cb15-384"><a href="#cb15-384" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">names</span>(iarg)</span>
<span id="cb15-385"><a href="#cb15-385" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">sapply</span>(params,</span>
<span id="cb15-386"><a href="#cb15-386" aria-hidden="true" tabindex="-1"></a>                         <span class="cf">switch</span>,</span>
<span id="cb15-387"><a href="#cb15-387" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'size'</span><span class="ot">=</span><span class="st">'n'</span>,</span>
<span id="cb15-388"><a href="#cb15-388" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'prob'</span><span class="ot">=</span><span class="st">'p'</span>,</span>
<span id="cb15-389"><a href="#cb15-389" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'lambda'</span><span class="ot">=</span><span class="st">'lambda'</span>,</span>
<span id="cb15-390"><a href="#cb15-390" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'shape'</span><span class="ot">=</span><span class="st">'alpha'</span>,</span>
<span id="cb15-391"><a href="#cb15-391" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'rate'</span><span class="ot">=</span><span class="st">'beta'</span>,</span>
<span id="cb15-392"><a href="#cb15-392" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'mean'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sd'</span><span class="ot">=</span><span class="st">'sigma'</span>,</span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'df'</span><span class="ot">=</span><span class="st">'df'</span>,</span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'meanlog'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sdlog'</span><span class="ot">=</span><span class="st">'sigma'</span>)</span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a>        label <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste</span>(params, <span class="fu">unlist</span>(iarg), <span class="at">sep=</span><span class="st">'=='</span>), <span class="at">collapse=</span><span class="st">'*</span><span class="sc">\'</span><span class="st">,</span><span class="sc">\'</span><span class="st">~~'</span>)</span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a>        gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size=</span><span class="fl">0.75</span>,</span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fun=</span>dfun,</span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a>                               <span class="at">args=</span>iarg,</span>
<span id="cb15-404"><a href="#cb15-404" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geom=</span><span class="st">'path'</span>)</span>
<span id="cb15-405"><a href="#cb15-405" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">'poisson|binomial'</span>, name))</span>
<span id="cb15-406"><a href="#cb15-406" aria-hidden="true" tabindex="-1"></a>            gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-407"><a href="#cb15-407" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-408"><a href="#cb15-408" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fun=</span>dfun,</span>
<span id="cb15-409"><a href="#cb15-409" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-410"><a href="#cb15-410" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">args=</span>iarg,</span>
<span id="cb15-411"><a href="#cb15-411" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">geom=</span><span class="st">'point'</span>)</span>
<span id="cb15-412"><a href="#cb15-412" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-413"><a href="#cb15-413" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"E"</span>,</span>
<span id="cb15-414"><a href="#cb15-414" aria-hidden="true" tabindex="-1"></a>                                <span class="at">name=</span><span class="st">'Parameters'</span>,</span>
<span id="cb15-415"><a href="#cb15-415" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">parse_format</span>())</span>
<span id="cb15-416"><a href="#cb15-416" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg <span class="sc">+</span></span>
<span id="cb15-417"><a href="#cb15-417" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'</span><span class="sc">\n</span><span class="st">y'</span>, <span class="at">y=</span><span class="st">'f(y)</span><span class="sc">\n</span><span class="st">'</span>) <span class="sc">+</span></span>
<span id="cb15-418"><a href="#cb15-418" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb15-419"><a href="#cb15-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(gg)</span>
<span id="cb15-420"><a href="#cb15-420" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-421"><a href="#cb15-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-422"><a href="#cb15-422" aria-hidden="true" tabindex="-1"></a>chi_squared_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb15-423"><a href="#cb15-423" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb15-424"><a href="#cb15-424" aria-hidden="true" tabindex="-1"></a>    darg <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">df=</span><span class="dv">1</span>),</span>
<span id="cb15-425"><a href="#cb15-425" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df=</span><span class="dv">3</span>),</span>
<span id="cb15-426"><a href="#cb15-426" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df=</span><span class="dv">5</span>),</span>
<span id="cb15-427"><a href="#cb15-427" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df=</span><span class="dv">9</span>))</span>
<span id="cb15-428"><a href="#cb15-428" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distribution_plot</span>(dset, dchisq, darg, <span class="at">name=</span><span class="st">'chi-squared'</span>)</span>
<span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a><span class="fu">chi_squared_plot</span>()</span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a><span class="fu">### Proprietà</span></span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>La distribuzione di densità $\chi^2_{~\nu}$ è asimmetrica.</span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Il valore atteso di una variabile $\chi^2_{~\nu}$ è uguale a $\nu$.</span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>La varianza di una variabile $\chi^2_{~\nu}$ è uguale a $2\nu$.</span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Per $k \rightarrow \infty$, la $\chi^2_{~\nu} \rightarrow \mathcal{N}$.</span>
<span id="cb15-440"><a href="#cb15-440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Se $X$ e $Y$ sono due variabili casuali chi-quadrato indipendenti con $\nu_1$ e $\nu_2$ gradi di libertà, ne segue che $X + Y \sim \chi^2_m$, con $m = \nu_1 + \nu_2$. Tale principio si estende a qualunque numero finito di variabili casuali chi-quadrato indipendenti.</span>
<span id="cb15-441"><a href="#cb15-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-442"><a href="#cb15-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione $t$ di Student</span></span>
<span id="cb15-443"><a href="#cb15-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-444"><a href="#cb15-444" aria-hidden="true" tabindex="-1"></a>Dalle distribuzioni Normale e Chi-quadrato deriva un'altra distribuzione molto nota, la $t$ di Student. Se $Z \sim \mathcal{N}$ e $W \sim \chi^2_{~\nu}$ sono due variabili casuali indipendenti, allora il rapporto</span>
<span id="cb15-445"><a href="#cb15-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-446"><a href="#cb15-446" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-447"><a href="#cb15-447" aria-hidden="true" tabindex="-1"></a>T = \frac{Z}{\Big( \frac{W}{\nu}\Big)^{\frac{1}{2}}}</span>
<span id="cb15-448"><a href="#cb15-448" aria-hidden="true" tabindex="-1"></a>$$ {#eq-student-t-distr}</span>
<span id="cb15-449"><a href="#cb15-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-450"><a href="#cb15-450" aria-hidden="true" tabindex="-1"></a>definisce la distribuzione $t$ di Student con $\nu$ gradi di libertà. Si usa scrivere $T \sim t_{\nu}$. L'andamento della distribuzione $t$ di Student è simile a quello della distribuzione Normale, ma ha una dispersione maggiore (ha le code più pesanti di una Normale, ovvero ha una varianza maggiore di 1).</span>
<span id="cb15-451"><a href="#cb15-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-452"><a href="#cb15-452" aria-hidden="true" tabindex="-1"></a>La @fig-alcune-t-student mostra alcune distribuzioni $t$ di Student variando il parametro $\nu$.</span>
<span id="cb15-453"><a href="#cb15-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-454"><a href="#cb15-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-alcune-t-student, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE, fig.cap = "Alcune distribuzioni $t$ di Student."}</span></span>
<span id="cb15-455"><a href="#cb15-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-456"><a href="#cb15-456" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-457"><a href="#cb15-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize statistical distributions</span></span>
<span id="cb15-458"><a href="#cb15-458" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb15-459"><a href="#cb15-459" aria-hidden="true" tabindex="-1"></a>distribution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dset, dfun, darg, name){</span>
<span id="cb15-460"><a href="#cb15-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_update</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>))</span>
<span id="cb15-461"><a href="#cb15-461" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dset, <span class="fu">aes</span>(<span class="at">x=</span>x))</span>
<span id="cb15-462"><a href="#cb15-462" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(darg)){</span>
<span id="cb15-463"><a href="#cb15-463" aria-hidden="true" tabindex="-1"></a>        iarg <span class="ot">&lt;-</span> darg[[index]]</span>
<span id="cb15-464"><a href="#cb15-464" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">names</span>(iarg)</span>
<span id="cb15-465"><a href="#cb15-465" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> <span class="fu">sapply</span>(params,</span>
<span id="cb15-466"><a href="#cb15-466" aria-hidden="true" tabindex="-1"></a>                         <span class="cf">switch</span>,</span>
<span id="cb15-467"><a href="#cb15-467" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'size'</span><span class="ot">=</span><span class="st">'n'</span>,</span>
<span id="cb15-468"><a href="#cb15-468" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'prob'</span><span class="ot">=</span><span class="st">'p'</span>,</span>
<span id="cb15-469"><a href="#cb15-469" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'lambda'</span><span class="ot">=</span><span class="st">'lambda'</span>,</span>
<span id="cb15-470"><a href="#cb15-470" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'shape'</span><span class="ot">=</span><span class="st">'alpha'</span>,</span>
<span id="cb15-471"><a href="#cb15-471" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'rate'</span><span class="ot">=</span><span class="st">'beta'</span>,</span>
<span id="cb15-472"><a href="#cb15-472" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'mean'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-473"><a href="#cb15-473" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sd'</span><span class="ot">=</span><span class="st">'sigma'</span>,</span>
<span id="cb15-474"><a href="#cb15-474" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'df'</span><span class="ot">=</span><span class="st">'df'</span>,</span>
<span id="cb15-475"><a href="#cb15-475" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'meanlog'</span><span class="ot">=</span><span class="st">'mu'</span>,</span>
<span id="cb15-476"><a href="#cb15-476" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'sdlog'</span><span class="ot">=</span><span class="st">'sigma'</span>)</span>
<span id="cb15-477"><a href="#cb15-477" aria-hidden="true" tabindex="-1"></a>        label <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste</span>(params, <span class="fu">unlist</span>(iarg), <span class="at">sep=</span><span class="st">'=='</span>), <span class="at">collapse=</span><span class="st">'*</span><span class="sc">\'</span><span class="st">,</span><span class="sc">\'</span><span class="st">~~'</span>)</span>
<span id="cb15-478"><a href="#cb15-478" aria-hidden="true" tabindex="-1"></a>        gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-479"><a href="#cb15-479" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-480"><a href="#cb15-480" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size=</span><span class="fl">0.75</span>,</span>
<span id="cb15-481"><a href="#cb15-481" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fun=</span>dfun,</span>
<span id="cb15-482"><a href="#cb15-482" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-483"><a href="#cb15-483" aria-hidden="true" tabindex="-1"></a>                               <span class="at">args=</span>iarg,</span>
<span id="cb15-484"><a href="#cb15-484" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geom=</span><span class="st">'path'</span>)</span>
<span id="cb15-485"><a href="#cb15-485" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">'poisson|binomial'</span>, name))</span>
<span id="cb15-486"><a href="#cb15-486" aria-hidden="true" tabindex="-1"></a>            gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">data=</span>dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label=</span>label),</span>
<span id="cb15-487"><a href="#cb15-487" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">aes</span>(<span class="at">colour=</span>label),</span>
<span id="cb15-488"><a href="#cb15-488" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fun=</span>dfun,</span>
<span id="cb15-489"><a href="#cb15-489" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n=</span><span class="fu">nrow</span>(dset),</span>
<span id="cb15-490"><a href="#cb15-490" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">args=</span>iarg,</span>
<span id="cb15-491"><a href="#cb15-491" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">geom=</span><span class="st">'point'</span>)</span>
<span id="cb15-492"><a href="#cb15-492" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-493"><a href="#cb15-493" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"E"</span>,</span>
<span id="cb15-494"><a href="#cb15-494" aria-hidden="true" tabindex="-1"></a>                                <span class="at">name=</span><span class="st">'Parameters'</span>,</span>
<span id="cb15-495"><a href="#cb15-495" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">parse_format</span>())</span>
<span id="cb15-496"><a href="#cb15-496" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">'</span><span class="sc">\n</span><span class="st">y'</span>, <span class="at">y=</span><span class="st">'f(y)</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb15-497"><a href="#cb15-497" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(gg)</span>
<span id="cb15-498"><a href="#cb15-498" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-499"><a href="#cb15-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-500"><a href="#cb15-500" aria-hidden="true" tabindex="-1"></a>student_t_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb15-501"><a href="#cb15-501" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb15-502"><a href="#cb15-502" aria-hidden="true" tabindex="-1"></a>    darg <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">df =</span> <span class="dv">1</span>),</span>
<span id="cb15-503"><a href="#cb15-503" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">2</span>),</span>
<span id="cb15-504"><a href="#cb15-504" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">30</span>),</span>
<span id="cb15-505"><a href="#cb15-505" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">50</span>))</span>
<span id="cb15-506"><a href="#cb15-506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distribution_plot</span>(dset, dt, darg, <span class="at">name=</span><span class="st">'student_t'</span>)</span>
<span id="cb15-507"><a href="#cb15-507" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-508"><a href="#cb15-508" aria-hidden="true" tabindex="-1"></a><span class="fu">student_t_plot</span>()</span>
<span id="cb15-509"><a href="#cb15-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-510"><a href="#cb15-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-511"><a href="#cb15-511" aria-hidden="true" tabindex="-1"></a><span class="fu">### Proprietà</span></span>
<span id="cb15-512"><a href="#cb15-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-513"><a href="#cb15-513" aria-hidden="true" tabindex="-1"></a>La variabile casuale $t$ di Student soddisfa le seguenti proprietà:</span>
<span id="cb15-514"><a href="#cb15-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-515"><a href="#cb15-515" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Per $\nu \rightarrow \infty$, $t_{\nu}$ tende alla normale standard $\mathcal{N}(0, 1)$.</span>
<span id="cb15-516"><a href="#cb15-516" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>La densità della $t_{\nu}$ è una funzione simmetrica con valore atteso nullo.</span>
<span id="cb15-517"><a href="#cb15-517" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Per $\nu &gt; 2$, la varianza della $t_{\nu}$ vale $\nu/(\nu - 2)$; pertanto è sempre maggiore di 1 e tende a 1 per $\nu \rightarrow \infty$.</span>
<span id="cb15-518"><a href="#cb15-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-519"><a href="#cb15-519" aria-hidden="true" tabindex="-1"></a><span class="fu">## Funzione beta di Eulero</span></span>
<span id="cb15-520"><a href="#cb15-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-521"><a href="#cb15-521" aria-hidden="true" tabindex="-1"></a>La funzione beta di Eulero è una funzione matematica, *non* una densità di probabilità. La menzioniamo qui perché viene utilizzata nella distribuzione Beta. La funzione beta di Eulero si può scrivere in molti modi diversi; per i nostri scopi la presentiamo così:</span>
<span id="cb15-522"><a href="#cb15-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-523"><a href="#cb15-523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-524"><a href="#cb15-524" aria-hidden="true" tabindex="-1"></a>B(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha + \beta)}\,,</span>
<span id="cb15-525"><a href="#cb15-525" aria-hidden="true" tabindex="-1"></a>$$ {#eq-eulero-function}</span>
<span id="cb15-526"><a href="#cb15-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-527"><a href="#cb15-527" aria-hidden="true" tabindex="-1"></a>dove $\Gamma(x)$ è la funzione Gamma, ovvero il fattoriale discendente, cioè</span>
<span id="cb15-528"><a href="#cb15-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-529"><a href="#cb15-529" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-530"><a href="#cb15-530" aria-hidden="true" tabindex="-1"></a>(x-1)(x-2)\ldots (x-n+1)\notag\,.</span>
<span id="cb15-531"><a href="#cb15-531" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-532"><a href="#cb15-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-533"><a href="#cb15-533" aria-hidden="true" tabindex="-1"></a>::: {#exr-beta-function-1}</span>
<span id="cb15-534"><a href="#cb15-534" aria-hidden="true" tabindex="-1"></a>Per esempio, posti $\alpha = 3$ e $\beta = 9$, la funzione beta assume il valore</span>
<span id="cb15-535"><a href="#cb15-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-538"><a href="#cb15-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-539"><a href="#cb15-539" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.special <span class="im">as</span> sc</span>
<span id="cb15-540"><a href="#cb15-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-541"><a href="#cb15-541" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-542"><a href="#cb15-542" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb15-543"><a href="#cb15-543" aria-hidden="true" tabindex="-1"></a>sc.beta(alpha, beta)</span>
<span id="cb15-544"><a href="#cb15-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-545"><a href="#cb15-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-546"><a href="#cb15-546" aria-hidden="true" tabindex="-1"></a>Lo stesso risultato si ottiene con</span>
<span id="cb15-547"><a href="#cb15-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-550"><a href="#cb15-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-551"><a href="#cb15-551" aria-hidden="true" tabindex="-1"></a>((<span class="dv">2</span>) <span class="op">*</span> (<span class="dv">8</span> <span class="op">*</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">4</span> <span class="op">*</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">2</span>)) <span class="op">/</span> (<span class="dv">11</span> <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> <span class="dv">9</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">*</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">4</span> <span class="op">*</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb15-552"><a href="#cb15-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-553"><a href="#cb15-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-554"><a href="#cb15-554" aria-hidden="true" tabindex="-1"></a>ovvero</span>
<span id="cb15-555"><a href="#cb15-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-558"><a href="#cb15-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-559"><a href="#cb15-559" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-560"><a href="#cb15-560" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb15-561"><a href="#cb15-561" aria-hidden="true" tabindex="-1"></a>sc.gamma(alpha) <span class="op">*</span> sc.gamma(beta) <span class="op">/</span> sc.gamma(alpha <span class="op">+</span> beta)</span>
<span id="cb15-562"><a href="#cb15-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-563"><a href="#cb15-563" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-564"><a href="#cb15-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-565"><a href="#cb15-565" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione Beta</span></span>
<span id="cb15-566"><a href="#cb15-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a>La distribuzione Beta è una distribuzione usata per modellare percentuali e proporzioni in quanto è definita sull'intervallo $(0; 1)$ -- ovvero, non include i valori 0 o 1.</span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-569"><a href="#cb15-569" aria-hidden="true" tabindex="-1"></a>::: {#def-beta-distribution}</span>
<span id="cb15-570"><a href="#cb15-570" aria-hidden="true" tabindex="-1"></a>Sia $\pi$ una variabile casuale che può assumere qualsiasi valore compreso tra 0 e 1, cioè $\pi \in <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$. Diremo che $\pi$ segue la distribuzione Beta di parametri $\alpha$ e $\beta$, $\pi \sim \text{Beta}(\alpha, \beta)$, se la sua densità è</span>
<span id="cb15-571"><a href="#cb15-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-572"><a href="#cb15-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-573"><a href="#cb15-573" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb15-574"><a href="#cb15-574" aria-hidden="true" tabindex="-1"></a>\text{Beta}(\pi \mid \alpha, \beta) &amp;= \frac{1}{B(\alpha, \beta)}\pi^{\alpha-1} (1-\pi)^{\beta-1}\notag<span class="sc">\\</span> </span>
<span id="cb15-575"><a href="#cb15-575" aria-hidden="true" tabindex="-1"></a>&amp;=  \frac{\Gamma(\alpha+ \beta)}{\Gamma(\alpha)\Gamma(\beta)}\pi^{\alpha-1} (1-\pi)^{\beta-1} \quad \text{per } \pi \in <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>\,,</span>
<span id="cb15-576"><a href="#cb15-576" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb15-577"><a href="#cb15-577" aria-hidden="true" tabindex="-1"></a>$$ {#eq-beta-distr-formula}</span>
<span id="cb15-578"><a href="#cb15-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-579"><a href="#cb15-579" aria-hidden="true" tabindex="-1"></a>laddove $B(\alpha, \beta)$ è la funzione beta di Eulero.</span>
<span id="cb15-580"><a href="#cb15-580" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-581"><a href="#cb15-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-582"><a href="#cb15-582" aria-hidden="true" tabindex="-1"></a>I termini $\alpha$ e $\beta$ sono i parametri della distribuzione Beta e devono essere entrambi positivi. Tali parametri possono essere interpretati come l'espressione delle nostre credenze a priori relative ad una sequenza di prove Bernoulliane. Il parametro $\alpha$ rappresenta il numero di "successi" e il parametro $\beta$ il numero di "insuccessi":</span>
<span id="cb15-583"><a href="#cb15-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-584"><a href="#cb15-584" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-585"><a href="#cb15-585" aria-hidden="true" tabindex="-1"></a>\frac{\text{Numero di successi}}{\text{Numero di successi} + \text{Numero di insuccessi}} = \frac{\alpha}{\alpha + \beta}\notag\,.</span>
<span id="cb15-586"><a href="#cb15-586" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-587"><a href="#cb15-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-588"><a href="#cb15-588" aria-hidden="true" tabindex="-1"></a>Il rapporto $\frac{1}{B(\alpha, \beta)} = \frac{\Gamma(\alpha+b)}{\Gamma(\alpha)\Gamma(\beta)}$ è una costante di normalizzazione:</span>
<span id="cb15-589"><a href="#cb15-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-590"><a href="#cb15-590" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-591"><a href="#cb15-591" aria-hidden="true" tabindex="-1"></a>\int_0^1 \pi^{\alpha-1} (1-\pi)^{\beta-1} = \frac{\Gamma(\alpha+b)}{\Gamma(\alpha)\Gamma(\beta)}\,.</span>
<span id="cb15-592"><a href="#cb15-592" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-593"><a href="#cb15-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-594"><a href="#cb15-594" aria-hidden="true" tabindex="-1"></a>Ad esempio, con $\alpha = 3$ e $\beta = 9$ abbiamo</span>
<span id="cb15-595"><a href="#cb15-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-598"><a href="#cb15-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-599"><a href="#cb15-599" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-600"><a href="#cb15-600" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> quad</span>
<span id="cb15-601"><a href="#cb15-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-602"><a href="#cb15-602" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrand(p, a, b):</span>
<span id="cb15-603"><a href="#cb15-603" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p<span class="op">**</span>(a<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>p)<span class="op">**</span>(b<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb15-604"><a href="#cb15-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-605"><a href="#cb15-605" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-606"><a href="#cb15-606" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb15-607"><a href="#cb15-607" aria-hidden="true" tabindex="-1"></a>result, error <span class="op">=</span> quad(integrand, <span class="dv">0</span>, <span class="dv">1</span>, args<span class="op">=</span>(a, b))</span>
<span id="cb15-608"><a href="#cb15-608" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb15-609"><a href="#cb15-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-610"><a href="#cb15-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-611"><a href="#cb15-611" aria-hidden="true" tabindex="-1"></a>ovvero</span>
<span id="cb15-612"><a href="#cb15-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-615"><a href="#cb15-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-616"><a href="#cb15-616" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb15-617"><a href="#cb15-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-618"><a href="#cb15-618" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-619"><a href="#cb15-619" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb15-620"><a href="#cb15-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-621"><a href="#cb15-621" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> math.gamma(a) <span class="op">*</span> math.gamma(b) <span class="op">/</span> math.gamma(a <span class="op">+</span> b)</span>
<span id="cb15-622"><a href="#cb15-622" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb15-623"><a href="#cb15-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-624"><a href="#cb15-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-625"><a href="#cb15-625" aria-hidden="true" tabindex="-1"></a>ovvero</span>
<span id="cb15-626"><a href="#cb15-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-629"><a href="#cb15-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>sc.beta(a, b)</span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a>Il valore atteso, la moda e la varianza di una distribuzione Beta sono dati dalle seguenti equazioni:</span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a>\mathbb{E}(\pi) = \frac{\alpha}{\alpha+\beta}\,,</span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>$$ {#eq-beta-mean}</span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>\mbox{Mo}(\pi) = \frac{\alpha-1}{\alpha+\beta-2}\,,</span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>$$ {#eq-beta-mode}</span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>\mathbb{V}(\pi) = \frac{\alpha \beta}{(\alpha+\beta)^2 (\alpha+\beta+1)}\,.</span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a>$$ {#eq-beta-var}</span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a>Al variare di $\alpha$ e $\beta$ si ottengono molte distribuzioni di forma diversa; un'illustrazione è fornita dalla seguente <span class="co">[</span><span class="ot">GIF animata</span><span class="co">](https://en.wikipedia.org/wiki/File:PDF_of_the_Beta_distribution.gif)</span>.</span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>Si può ottenere una rappresentazione grafica della distribuzione $\mbox{Beta}(\pi \mid \alpha, \beta)$ nel modo seguente.</span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">3</span>, <span class="dv">9</span></span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>, <span class="fl">0.999</span>, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a>plt.plot(x, beta.pdf(x, a, b), <span class="st">'r-'</span>)</span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="fl">0.0</span>, <span class="fl">1.0</span>)</span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribuzione Beta'</span>)</span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valori di una variabile casuale X (0, 1)'</span>)</span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Densità'</span>)</span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a>La funzione <span class="in">`beta_mean_mode_variance()`</span> ci restituisce la media, moda e varianza della distribuzione Beta.</span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> beta_mean_mode_variance(alpha, beta):</span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> alpha <span class="op">/</span> (alpha <span class="op">+</span> beta)</span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> (alpha <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (alpha <span class="op">+</span> beta <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a>    variance <span class="op">=</span> alpha <span class="op">*</span> beta <span class="op">/</span> ((alpha <span class="op">+</span> beta)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (alpha <span class="op">+</span> beta <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mean, mode, variance</span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a>Per esempio:</span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-687"><a href="#cb15-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-688"><a href="#cb15-688" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a>mean, mode, variance <span class="op">=</span> beta_mean_mode_variance(alpha, beta)</span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Mean: </span><span class="sc">{</span>mean<span class="sc">}</span><span class="ss">, Mode: </span><span class="sc">{</span>mode<span class="sc">}</span><span class="ss">, Variance: </span><span class="sc">{</span>variance<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a>::: remark</span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a>Attenzione alle parole: in questo contesto, il termine "beta" viene utilizzato con tre significati diversi:</span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>la distribuzione di densità Beta,</span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>la funzione matematica beta,</span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>il parametro $\beta$.</span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione di Cauchy</span></span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-704"><a href="#cb15-704" aria-hidden="true" tabindex="-1"></a>La distribuzione di Cauchy è un caso speciale della distribuzione di $t$ di Student con 1 grado di libertà. È definita da una densità di probabilità che corrisponde alla seguente funzione, dipendente da due parametri $\theta$ e $d$ (con la condizione $d &gt; 0$),</span>
<span id="cb15-705"><a href="#cb15-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-707"><a href="#cb15-707" aria-hidden="true" tabindex="-1"></a>f(x; \theta, d) = \frac{1}{\pi d} \frac{1}{1 + \left(\frac{x - \theta}{d} \right)^2},</span>
<span id="cb15-708"><a href="#cb15-708" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cauchy-formula}</span>
<span id="cb15-709"><a href="#cb15-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-710"><a href="#cb15-710" aria-hidden="true" tabindex="-1"></a>dove $\theta$ è la mediana della distribuzione e $d$ ne misura la larghezza a metà altezza.</span>
<span id="cb15-711"><a href="#cb15-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-712"><a href="#cb15-712" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione log-normale</span></span>
<span id="cb15-713"><a href="#cb15-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-714"><a href="#cb15-714" aria-hidden="true" tabindex="-1"></a>Sia $y$ una variabile casuale avente distribuzione normale con media $\mu$ e varianza $\sigma^2$. Definiamo poi una nuova variabile casuale $x$ attraverso la relazione</span>
<span id="cb15-715"><a href="#cb15-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-716"><a href="#cb15-716" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-717"><a href="#cb15-717" aria-hidden="true" tabindex="-1"></a>x = e^y \quad \Longleftrightarrow \quad y = \log x.</span>
<span id="cb15-718"><a href="#cb15-718" aria-hidden="true" tabindex="-1"></a>$$ Il dominio di definizione della $x$ è il semiasse $x &gt; 0$ e la densità di probabilità $f(x)$ è data da</span>
<span id="cb15-719"><a href="#cb15-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-720"><a href="#cb15-720" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-721"><a href="#cb15-721" aria-hidden="true" tabindex="-1"></a>f(x) = \frac{1}{\sigma \sqrt{2 \pi}} \frac{1}{x} \exp \left<span class="sc">\{</span>-\frac{(\log x -  \mu)^2}{2 \sigma^2} \right<span class="sc">\}</span>.</span>
<span id="cb15-722"><a href="#cb15-722" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lognormal-formula}</span>
<span id="cb15-723"><a href="#cb15-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-724"><a href="#cb15-724" aria-hidden="true" tabindex="-1"></a>Questa funzione di densità è chiamata log-normale.</span>
<span id="cb15-725"><a href="#cb15-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-726"><a href="#cb15-726" aria-hidden="true" tabindex="-1"></a>Il valore atteso e la varianza di una distribuzione log-normale sono dati dalle seguenti equazioni:</span>
<span id="cb15-727"><a href="#cb15-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-728"><a href="#cb15-728" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-729"><a href="#cb15-729" aria-hidden="true" tabindex="-1"></a>\mathbb{E}(x) = \exp \left<span class="sc">\{</span>\mu + \frac{\sigma^2}{2} \right<span class="sc">\}</span>.</span>
<span id="cb15-730"><a href="#cb15-730" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-731"><a href="#cb15-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a>\mathbb{V}(x) = \exp \left<span class="sc">\{</span>2 \mu + \sigma^2 \right<span class="sc">\}</span> \left(\exp \left<span class="sc">\{</span>\sigma^2 \right<span class="sc">\}</span>  -1\right).</span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a>Si può dimostrare che il prodotto di variabili casuali log-normali ed indipendenti segue una distribuzione log-normale.</span>
<span id="cb15-737"><a href="#cb15-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-738"><a href="#cb15-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzione di Pareto</span></span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a>La distribuzione paretiana (o distribuzione di Pareto) è una distribuzione di probabilità continua e così chiamata in onore di Vilfredo Pareto. La distribuzione di Pareto è una distribuzione di probabilità con legge di potenza utilizzata nella descrizione di fenomeni sociali e molti altri tipi di fenomeni osservabili. Originariamente applicata per descrivere la distribuzione del reddito in una società, adattandosi alla tendenza che una grande porzione di ricchezza è detenuta da una piccola frazione della popolazione, la distribuzione di Pareto è diventata colloquialmente nota e indicata come il principio di Pareto, o "regola 80-20". Questa regola afferma che, ad esempio, l'80% della ricchezza di una società è detenuto dal 20% della sua popolazione. Viene spesso applicata nello studio della distribuzione del reddito, della dimensione dell'impresa, della dimensione di una popolazione e nelle fluttuazioni del prezzo delle azioni.</span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a>La densità di una distribuzione di Pareto è</span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a>f(x)=(x_m/x)^\alpha,</span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pareto-formula}</span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>dove $x_m$ (parametro di scala) è il minimo (necessariamente positivo) valore possibile di $X$ e $\alpha$ è un parametro di forma.</span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.05</span>)</span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span>  <span class="dv">3</span><span class="sc">/</span>x<span class="sc">^</span>(<span class="dv">4</span>)</span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span>  <span class="dv">2</span><span class="sc">/</span>x<span class="sc">^</span>(<span class="dv">3</span>)</span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">/</span>x<span class="sc">^</span>(<span class="dv">2</span>)</span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span>  <span class="fu">bind_rows</span>(</span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">p=</span>a3, <span class="at">alpha=</span><span class="st">'3'</span>), </span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">p=</span>a2, <span class="at">alpha=</span><span class="st">'2'</span>), </span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">p=</span>a1, <span class="at">alpha=</span><span class="st">'1'</span>)</span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> p, <span class="at">group =</span> alpha)) <span class="sc">+</span></span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> alpha)) <span class="sc">+</span></span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Densità di Pareto per alcuni valori del parametro di forma'</span>) <span class="sc">+</span></span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'P(X = x)'</span>) <span class="sc">+</span></span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(</span>
<span id="cb15-767"><a href="#cb15-767" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"E"</span>,</span>
<span id="cb15-768"><a href="#cb15-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">parse_format</span>()</span>
<span id="cb15-769"><a href="#cb15-769" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-770"><a href="#cb15-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-771"><a href="#cb15-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">y'</span>,</span>
<span id="cb15-772"><a href="#cb15-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'f(y)</span><span class="sc">\n</span><span class="st">'</span></span>
<span id="cb15-773"><a href="#cb15-773" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-774"><a href="#cb15-774" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gg)</span>
<span id="cb15-775"><a href="#cb15-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-776"><a href="#cb15-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-777"><a href="#cb15-777" aria-hidden="true" tabindex="-1"></a>\noindent La distribuzione di Pareto ha una asimmetria positiva. Il supporto della distribuzione di Pareto è la retta reale positiva. Tutti i valori devono essere maggiori del parametro di scala $x_m$, che è in realtà un parametro di soglia.</span>
<span id="cb15-778"><a href="#cb15-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-779"><a href="#cb15-779" aria-hidden="true" tabindex="-1"></a><span class="fu">## Commenti e considerazioni finali {.unnumbered}</span></span>
<span id="cb15-780"><a href="#cb15-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-781"><a href="#cb15-781" aria-hidden="true" tabindex="-1"></a>In questa dispensa le densità continue che useremo più spesso sono la distribuzione gaussiana e la distribuzione Beta. Faremo un uso limitato della distribuzione $t$ di Student e della distribuzione di Cauchy. Le altre distribuzioni qui descritte sono stato presentate per completezza.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>