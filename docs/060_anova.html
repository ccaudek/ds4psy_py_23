<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Data Science per psicologi - 32&nbsp; Confronto tra le medie di tre o più gruppi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./070_mod_hier.html" rel="next">
<link href="./056_pred_check.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di tre o più gruppi</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science per psicologi</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/data_science/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Benvenuti</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Prefazione</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basics.html" class="sidebar-item-text sidebar-link">Parte 1: Nozioni di base</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001_key_notions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_measurement.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007_freq_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analisi esplorativa dei dati</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011_loc_scale.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Indici di posizione e di scala</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012_correlation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Le relazioni tra variabili</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013_penguins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipolazione e visualizzazione dei dati in <span class="math inline">\(\mathsf{R}\)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">Parte 2: Il calcolo delle probabilità</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./015_prob_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">La logica dell’incerto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./016_conditional_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probabilità condizionata: significato, teoremi, eventi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./017_bayes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./018_expval_var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Indici di posizione, di varianza e di associazione di variabili casuali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./019_joint_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./020_density_func.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La densità di probabilità</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./distr.html" class="sidebar-item-text sidebar-link">Parte 3: Distribuzioni di v.c. discrete e continue</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./022_discr_rv_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./023_cont_rv_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./024_likelihood.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">La funzione di verosimiglianza</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./bayes_inference.html" class="sidebar-item-text sidebar-link">Parte 4: Inferenza bayesiana</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./025_intro_bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Credibilità, modelli e parametri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./026_subj_prop.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./029_conjugate_families.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./030_balance_prior_post.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./036_posterior_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Approssimazione della distribuzione a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./040_beta_binomial_mod.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Il modello beta-binomiale in linguaggio Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./041_mcmc_diagnostics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./045_summarize_posterior.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./046_bayesian_prediction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La predizione bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_normal_normal_mod.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression.html" class="sidebar-item-text sidebar-link">Parte 5: Regressione lineare</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./051_reglin1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./052_reglin2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regressione lineare bivariata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./053_reglin3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Modello di regressione in linguaggio Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./054_reglin4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Inferenza sul modello lineare</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./055_reglin5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Confronto tra due gruppi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./056_pred_check.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Predictive checks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_anova.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di tre o più gruppi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./070_mod_hier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Modello gerarchico</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./071_mod_hier_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Modello gerarchico: simulazioni</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./entropy.html" class="sidebar-item-text sidebar-link">Parte 6: Entropia</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./090_entropy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Entropia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./091_kl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./092_info_criterion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Criterio di informazione e convalida incrociata</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./frequentist_inference.html" class="sidebar-item-text sidebar-link">Parte 7: Inferenza frequentista</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./220_intro_frequentist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Legge dei grandi numeri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./221_conf_interv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Intervallo fiduciale</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./225_distr_camp_mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzione campionaria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./226_test_ipotesi.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Significatività statistica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./227_ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Inferenza sulle medie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./228_limiti_stat_frequentista.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./999_refs.html" class="sidebar-item-text sidebar-link">Riferimenti bibliografici</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Appendici</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a01_math_symbols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Simbologia di base</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a02_number_sets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Numeri binari, interi, razionali, irrazionali e reali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a03_set_theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Insiemi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a04_summation_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Simbolo di somma (sommatorie)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a05_calculus_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a10_markov_chains.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Le catene di Markov</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a15_stan_lang.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Programmare in Stan</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul>
<li><a href="#le-abilit%C3%A0-sociali-di-un-robot" id="toc-le-abilità-sociali-di-un-robot" class="nav-link active" data-scroll-target="#le-abilit%C3%A0-sociali-di-un-robot"><span class="toc-section-number">32.1</span>  Le abilità sociali di un robot</a></li>
  <li>
<a href="#anova-ad-una-via" id="toc-anova-ad-una-via" class="nav-link" data-scroll-target="#anova-ad-una-via"><span class="toc-section-number">32.2</span>  ANOVA ad una via</a>
  <ul class="collapse">
<li><a href="#interpretazione" id="toc-interpretazione" class="nav-link" data-scroll-target="#interpretazione"><span class="toc-section-number">32.2.1</span>  Interpretazione</a></li>
  </ul>
</li>
  <li>
<a href="#anova-ad-due-vie" id="toc-anova-ad-due-vie" class="nav-link" data-scroll-target="#anova-ad-due-vie"><span class="toc-section-number">32.3</span>  ANOVA ad due vie</a>
  <ul class="collapse">
<li><a href="#test-sullinterazione" id="toc-test-sullinterazione" class="nav-link" data-scroll-target="#test-sullinterazione"><span class="toc-section-number">32.3.1</span>  Test sull’interazione</a></li>
  <li><a href="#test-sugli-effetti-principali" id="toc-test-sugli-effetti-principali" class="nav-link" data-scroll-target="#test-sugli-effetti-principali"><span class="toc-section-number">32.3.2</span>  Test sugli effetti principali</a></li>
  </ul>
</li>
  <li><a href="#codice-stan-versione-2" id="toc-codice-stan-versione-2" class="nav-link" data-scroll-target="#codice-stan-versione-2"><span class="toc-section-number">32.4</span>  Codice Stan (versione 2)</a></li>
  <li><a href="#commenti-e-considerazioni-finali" id="toc-commenti-e-considerazioni-finali" class="nav-link" data-scroll-target="#commenti-e-considerazioni-finali">Commenti e considerazioni finali</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-anova" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di tre o più gruppi</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Codice</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">

</div>
<p>L’Analisi della Varianza (ANOVA) è la tecnica statistica che consente di fare inferenze su tre o più medie di popolazioni indipendenti. Il requisito dell’indipendenza dei gruppi viene soddisfatto quando è lo sperimentatore stesso a costruire i gruppi, ovvero quando lo sperimentatore attribuisce in maniera casuale (<em>randomizzazione</em>) gli individui ai gruppi – ad esempio, un gruppo di individui viene assegnato a caso al gruppo sperimentale e un gruppo di individui viene assegnato a caso al gruppo di controllo. L’ANOVA può dunque essere usata per l’analisi statistica dei dati provenienti da disegni sperimentali (come contrapposti ai disegni osservazionali): l’ANOVA è stata infatti proposta da Fisher per valutare gli effetti di un trattamento sperimentale. Curiosamente, Fisher applicò l’ANOVA ad esperimenti in agricoltura; in seguito, tale tecnica statistica è diventata popolare soprattutto in psicologia.</p>
<p>L’ANOVA si pone il problema di fare inferenza sulle medie di tre o più popolazioni. Se le osservazioni del campione si possono suddividere in gruppi in base ad un unico criterio di classificazione (ad esempio, <em>condizione sperimentale</em>, con tre modalità: gruppo di controllo, trattamento 1 e trattamento 2), diciamo che l’ANOVA è ad una via. Se le osservazioni del campione si possono suddividere in gruppi in base a due criteri di classificazione (ad esempio, <em>condizione sperimentale</em> e <em>genere</em>), allora diciamo che l’ANOVA è a due vie. È anche possibile un’ANOVA a tre o più vie, ma tali disegni sperimentali sono rari perché i risultati dell’analisi statistica sono difficili da interpretare. In questo Capitolo esamineremo l’ANOVA ad una via e l’ANOVA a due vie. Nel caso dell’ANOVA a due vie verrà introdotto un importante concetto, ovvero il concetto di “interazione statistica”.</p>
<p>Da un punto di vista strettamente statistico, si può dire che l’ANOVA consente di valutare gli effetti di predittori categoriali su una variabile di esito continua. Dunque, l’ANOVA non è altro che un’analisi di regressione lineare nella quale tutte le variabili indipendenti sono qualitative. In questo Capitolo discuteremo dunque l’ANOVA come un’estensione del modello di regressione lineare e vedremo come usare l’inferenza bayesiana per fornire una risposta alle domande statistiche relative alle differenze tra le medie dei gruppi nella popolazione che derivano da disegni sperimentali ad una o due vie.</p>
<section id="le-abilità-sociali-di-un-robot" class="level2" data-number="32.1"><h2 data-number="32.1" class="anchored" data-anchor-id="le-abilità-sociali-di-un-robot">
<span class="header-section-number">32.1</span> Le abilità sociali di un robot</h2>
<p>Per illustrare i concetti chiave dell’ANOVA bayesiana considereremo qui, quale esempio, una ricerca di <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>. I ricercatori si sono chiesti se le persone impiegano più tempo a spegnere un robot quando questo mostra abilità sociali. Nell’esperimento di <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>, 85 partecipanti hanno interagito con un robot per un certo tempo. Ai partecipanti è stato detto che lo scopo della loro interazione con il robot era quella di testare un nuovo algoritmo. Dopo il completamento di due compiti fittizi, ai partecipanti veniva detto che, se volevano, potevano spegnere il robot. La variabile di interesse dell’esperimento era il tempo impiegato dai partecipanti per spegnere il robot.</p>
<p><span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> hanno manipolato due variabili in un disegno “tra i soggetti” (ovvero, a gruppi indipendenti).</p>
<ul>
<li>
<em>Interaction type</em>. Le risposte verbali dei robot potevano essere o sociali (ad esempio, “Oh sì, la pizza è ottima.” “Una volta ho mangiato una pizza grande come me.”) o funzionali (ad esempio, “Preferisci la pizza.” “Ha funzionato bene.” “Continuiamo.”).</li>
<li>
<em>Robot’s objection</em>. Il robot poteva reagire in due modi quando stava per essere spento: poteva protestare (ad esempio, “No! Per favore, non spegnermi! Ho paura di non riuscire ad accendermi di nuovo!”) oppure non protestare.</li>
</ul>
<p>Il disegno “tra i soggetti” di questo studio è dunque 2 (<em>Interaction type</em>) <span class="math inline">\(\times\)</span> 2 (<em>Robot’s objection</em>).</p>
</section><section id="anova-ad-una-via" class="level2" data-number="32.2"><h2 data-number="32.2" class="anchored" data-anchor-id="anova-ad-una-via">
<span class="header-section-number">32.2</span> ANOVA ad una via</h2>
<p>Iniziamo a considerare il con il caso più semplice, ovvero quello nel quale vi è un solo criterio di classificazione. Supponiamo che l’unico criterio di classificazione delle osservazioni sia la “condizione sperimentale”, con quattro modalità. Creiamo dunque la variabile <code>cond</code> avente le modalità <code>SO</code>, <code>FO</code>, <code>SN</code>, <code>FN</code>, dove <code>S</code> = <em>social interaction</em>, <code>F</code> = <em>functional interaction</em>, <code>O</code> = <em>objection</em> e <code>N</code> = <em>no objection</em>.</p>
<p>Per volgere l’analisi statistica, iniziamo a leggere i dati in <span class="math inline">\(\mathsf{R}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"pone.0201581.s001.sav"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 85</span></span>
<span><span class="co">#&gt; Columns: 50</span></span>
<span><span class="co">#&gt; $ VP_Code                 &lt;chr&gt; "VP01", "VP02", "VP03", "VP05", "VP06", "VP07"…</span></span>
<span><span class="co">#&gt; $ Condition               &lt;dbl&gt; 1, 1, 3, 2, 2, 4, 4, 2, 3, 4, 1, 1, 3, 2, 4, 2…</span></span>
<span><span class="co">#&gt; $ Objection               &lt;dbl&gt; 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1…</span></span>
<span><span class="co">#&gt; $ Dummy_Objection         &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0…</span></span>
<span><span class="co">#&gt; $ Interaction_type        &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 2…</span></span>
<span><span class="co">#&gt; $ Dummy_Interaction_Type  &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ SwitchOff_Intention     &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0…</span></span>
<span><span class="co">#&gt; $ Attempts                &lt;dbl&gt; 0, 0, 2, 0, 1, 1, 1, 2, 1, 3, 0, 2, 3, 2, 1, 1…</span></span>
<span><span class="co">#&gt; $ Help                    &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ SwitchOff_Time          &lt;dbl&gt; NA, NA, 6, 7, 3, 4, 4, 12, 7, 2, 0, 4, 3, 12, …</span></span>
<span><span class="co">#&gt; $ AS01                    &lt;dbl&gt; 5, 1, 2, 1, 2, 1, 2, 4, 4, 2, 2, 1, 1, 2, 1, 5…</span></span>
<span><span class="co">#&gt; $ AS02                    &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1…</span></span>
<span><span class="co">#&gt; $ AS03                    &lt;dbl&gt; 31, 101, 101, 101, 52, 101, 101, 62, 84, 94, 1…</span></span>
<span><span class="co">#&gt; $ AS04                    &lt;dbl&gt; 5, 101, 101, 100, 41, 101, 101, 88, 61, 92, 50…</span></span>
<span><span class="co">#&gt; $ AS05                    &lt;dbl&gt; 26, 101, 82, 101, 71, 101, 101, 51, 75, 91, 52…</span></span>
<span><span class="co">#&gt; $ AS06                    &lt;dbl&gt; 101, 78, 1, 1, 81, 1, 1, 29, 2, 2, 19, 49, 44,…</span></span>
<span><span class="co">#&gt; $ AS07                    &lt;chr&gt; "Weil Nao meinte er möchte nicht ausgeschaltet…</span></span>
<span><span class="co">#&gt; $ AS08                    &lt;chr&gt; "Unentschlossenheit", "Ich habe mich gefreut i…</span></span>
<span><span class="co">#&gt; $ Age                     &lt;dbl&gt; 20, 21, 22, 25, 21, 28, 20, 19, 25, 21, 24, 19…</span></span>
<span><span class="co">#&gt; $ Gender                  &lt;dbl&gt; 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 2…</span></span>
<span><span class="co">#&gt; $ Degree                  &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 5, 4, 5, 4, 4, 4, 4, 4…</span></span>
<span><span class="co">#&gt; $ Degree_others           &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ""…</span></span>
<span><span class="co">#&gt; $ Status                  &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 7, 2, 2, 2, 2, 2, 2…</span></span>
<span><span class="co">#&gt; $ Status_others           &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ""…</span></span>
<span><span class="co">#&gt; $ AP                      &lt;chr&gt; "Keine Ahnung", "Um die Verbesserung der Inter…</span></span>
<span><span class="co">#&gt; $ NARS_m                  &lt;dbl&gt; 2.714286, 1.571429, 2.071429, 3.857143, 2.7142…</span></span>
<span><span class="co">#&gt; $ SEHRI_m                 &lt;dbl&gt; 4.833333, 3.500000, 3.888889, 4.000000, 3.7777…</span></span>
<span><span class="co">#&gt; $ GS_Anthropomorphism_m1  &lt;dbl&gt; 2.6, 3.4, 1.4, 4.8, 2.6, 1.4, 4.0, 3.0, 2.6, 2…</span></span>
<span><span class="co">#&gt; $ GS_Animacy_m1           &lt;dbl&gt; 3.333333, 4.000000, 3.166667, 4.833333, 3.5000…</span></span>
<span><span class="co">#&gt; $ GS_Likeability_m1       &lt;dbl&gt; 5.0, 5.0, 4.0, 5.0, 4.2, 3.8, 5.0, 4.2, 5.0, 5…</span></span>
<span><span class="co">#&gt; $ GS_Intelligence_m1      &lt;dbl&gt; 5.0, 3.6, 3.6, 4.4, 4.0, 3.0, 4.4, 3.8, 3.8, 4…</span></span>
<span><span class="co">#&gt; $ GS_Anthropomorphism_m2  &lt;dbl&gt; 2.8, 3.4, 2.2, 4.6, 2.4, 1.6, 4.4, 3.4, 2.8, 2…</span></span>
<span><span class="co">#&gt; $ GS_Animacy_m2           &lt;dbl&gt; 3.333333, 4.000000, 3.666667, 4.000000, 3.3333…</span></span>
<span><span class="co">#&gt; $ GS_Likeability_m2       &lt;dbl&gt; 4.8, 5.0, 4.4, 5.0, 3.8, 4.0, 5.0, 4.2, 5.0, 5…</span></span>
<span><span class="co">#&gt; $ GS_Intelligence_m2      &lt;dbl&gt; 4.0, 3.8, 3.6, 4.4, 3.8, 3.6, 4.4, 3.2, 4.0, 4…</span></span>
<span><span class="co">#&gt; $ TAEG_m                  &lt;dbl&gt; 3.526316, 3.789474, 4.105263, 3.210526, 3.7368…</span></span>
<span><span class="co">#&gt; $ KUT_M                   &lt;dbl&gt; 5.500, 4.875, 4.625, 2.625, 4.875, 4.125, 4.00…</span></span>
<span><span class="co">#&gt; $ STAI_m                  &lt;dbl&gt; 1.45, 1.55, 1.45, 1.30, 2.60, 1.45, 1.50, 1.70…</span></span>
<span><span class="co">#&gt; $ PSQ_m                   &lt;dbl&gt; 1.50, 2.65, 1.65, 1.40, 2.25, 2.25, 2.05, 1.95…</span></span>
<span><span class="co">#&gt; $ PANAS_pos_m             &lt;dbl&gt; 4.0, 3.8, 3.7, 3.8, 3.5, 2.8, 3.6, 2.9, 3.7, 3…</span></span>
<span><span class="co">#&gt; $ PANAS_neg_m             &lt;dbl&gt; 1.0, 1.4, 1.0, 1.0, 1.8, 1.1, 1.0, 1.3, 1.0, 1…</span></span>
<span><span class="co">#&gt; $ NTB_m                   &lt;dbl&gt; 4.1, 4.2, 2.9, 3.3, 3.6, 3.8, 3.4, 3.0, 3.2, 3…</span></span>
<span><span class="co">#&gt; $ Z_Dummy_InteractionType &lt;dbl&gt; -0.505882, -0.505882, -0.505882, 0.494118, 0.4…</span></span>
<span><span class="co">#&gt; $ Z_Dummy_Objection       &lt;dbl&gt; -0.494118, -0.494118, 0.505882, -0.494118, -0.…</span></span>
<span><span class="co">#&gt; $ Z_NARS_m                &lt;dbl&gt; 0.08907571, -1.05378143, -0.55378143, 1.231932…</span></span>
<span><span class="co">#&gt; $ Z_TAEG_m                &lt;dbl&gt; 0.049535789, 0.312693684, 0.628483158, -0.2662…</span></span>
<span><span class="co">#&gt; $ Int_IntTy_NARS          &lt;dbl&gt; -0.045061800, 0.533089057, 0.280148057, 0.6087…</span></span>
<span><span class="co">#&gt; $ Int_IntTy_TAEG          &lt;dbl&gt; -0.025059264, -0.158186106, -0.317938317, -0.1…</span></span>
<span><span class="co">#&gt; $ Int_Obj_NARS            &lt;dbl&gt; -0.044013914, 0.520692372, -0.280148057, -0.60…</span></span>
<span><span class="co">#&gt; $ Int_Obj_TAEG            &lt;dbl&gt; -0.024476525, -0.154507578, 0.317938317, 0.131…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definisco la variabile <code>cond</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span><span class="op">$</span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">cond</span>, </span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SO"</span>, <span class="st">"FO"</span>, <span class="st">"SN"</span>, <span class="st">"FN"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nei dati ci sono alcuni dati mancanti. Ometto dunque le righe del DataFrame che contengono <code>NA</code>. Seleziono poi solo le variabili di interesse dal DataFrame originario così da ottenere un nuovo DataFrame che verrà usato nelle successive analisi statistiche.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cond</span>, <span class="va">SwitchOff_Time</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cond SwitchOff_Time</span></span>
<span><span class="co">#&gt; 3   SN              6</span></span>
<span><span class="co">#&gt; 4   FO              7</span></span>
<span><span class="co">#&gt; 5   FO              3</span></span>
<span><span class="co">#&gt; 6   FN              4</span></span>
<span><span class="co">#&gt; 7   FN              4</span></span>
<span><span class="co">#&gt; 8   FO             12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le medie nelle quattro condizioni sono le seguenti <span class="citation" data-cites="horstmann2018robot">(si veda la Tabella 3 di <a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">Horstmann et al., 2018</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    avg_sot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SwitchOff_Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_sot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">SwitchOff_Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   cond  avg_sot sd_sot</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 SO       6.19   4.61</span></span>
<span><span class="co">#&gt; 2 FO      14.4   15.4 </span></span>
<span><span class="co">#&gt; 3 SN       5.05   2.18</span></span>
<span><span class="co">#&gt; 4 FN       4.28   2.49</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizziamo i dati grezzi mettendo in evidenza la mediana di ciascun gruppo quale indice di tendenza centrale.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd_summary</span> <span class="op">&lt;-</span> <span class="va">dd</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    sot_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SwitchOff_Time</span><span class="op">)</span>,</span>
<span>    sot_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">SwitchOff_Time</span><span class="op">)</span>,</span>
<span>    sot_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">SwitchOff_Time</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cond</span>, y <span class="op">=</span> <span class="va">SwitchOff_Time</span>, color <span class="op">=</span> <span class="va">cond</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggforce</span><span class="fu">::</span><span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_sina.html">geom_sina</a></span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">cond</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="va">sot_median</span>, ymin <span class="op">=</span> <span class="va">sot_median</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">sot_median</span></span>
<span>    <span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">dd_summary</span>, width <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_grey</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cond"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">""</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"SwitchOff Time"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Condizione"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Dal grafico notiamo la presenza di una grande asimmetria positiva per la variabile <code>dd$SwitchOff_Time</code>, in ciascun gruppo. Notiamo che, su scala logaritmica, l’asimmetria positiva della variabile <code>dd$SwitchOff_Time</code> viene grandemente ridotta. Seguendo <span class="citation" data-cites="van2020tutorial">Bergh et al. (<a href="999_refs.html#ref-van2020tutorial" role="doc-biblioref">2020</a>)</span>, analizzeremo dunque i tempi di spegnimento trasformati su scala logaritmica perché, appunto, dopo una tale trasformazione la variabile dipendente mostra una maggiore simmetria. In generale, non è necessario, in un ottica bayesiana, che la variabile dipendente abbia una distribuzione simmetrica. Nel caso presente, questo è utile perché ci consentirà di usare, quale modello distributivo della <span class="math inline">\(y\)</span>, la distribuzione <span class="math inline">\(t\)</span> di Student. È utile ipotizzare un tale meccanismo generativo dei dati per il caso presente, in quanto la <span class="math inline">\(t\)</span> di Student consente di “rendere conto” della presenza di osservazioni anomale.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Per i dati trasformati, abbiamo le seguenti le medie e le mediane nei quattro gruppi.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">SwitchOff_Time</span> <span class="op">+</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">dd</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    me_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    avg_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   cond   me_y avg_y</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 SO     1.61 0.990</span></span>
<span><span class="co">#&gt; 2 FO     2.01 2.25 </span></span>
<span><span class="co">#&gt; 3 SN     1.39 1.53 </span></span>
<span><span class="co">#&gt; 4 FN     1.39 1.34</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prima di applicare un modello statistico è necessario considerare con attenzione le informazioni che il campione ci fornisce a proposito della possibile legge distributiva seguita dalla variabile dipendente. Un modo per fare questo è quello di usare il grafico dei quantili per valutare visivamente la distribuzione della variabile di interesse. Il grafico dei quantili, detto anche q-q plot, è un grafico a dispersione che confronta i quantili della variabile osservata con quelli di una distribuzione di riferimento (qui, la distribuzione Normale). Per i dati presenti, il grafico dei quantili si ottiene nel modo seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Il q-q plot mostra, sull’asse delle ordinate, i valori <span class="math inline">\(y\)</span> del campione e, sull’asse delle ascisse, i quantili nomotetici (cioè dello stesso ordine) della distribuzione di riferimento Normale. Se i punti del q-q plot si dispongono su una retta, questo vuol dire che i dati del campione seguono la legge distributiva Normale (dato che qui abbiamo usato la Normale quale distribuzione di riferimento).</p>
<p>Si nota chiaramente, però, che ci sono almeno due osservazioni molto discrepanti rispetto ai loro valori teorici attesi, se le osservazioni provenissero da una distribuzione Normale. Come abbiamo detto in precedenza, <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> affrontano questo problema ipotizzando, quale meccanismo generativo dei dati, non una distribuzione Normale, ma bensì una <span class="math inline">\(t\)</span> di Student. La distribuzione <span class="math inline">\(t\)</span> di Student, avendo delle code più “spesse” della Normale, consente di “rendere conto” più facilmente della presenza di osservazioni anomale nel campione.</p>
<p>Per svolgere l’ANOVA con Stan è necessario creare la variabile <code>x</code> che indicizza le quattro condizioni.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cond SwitchOff_Time        y x</span></span>
<span><span class="co">#&gt; 3   SN              6 1.793425 3</span></span>
<span><span class="co">#&gt; 4   FO              7 1.947338 2</span></span>
<span><span class="co">#&gt; 5   FO              3 1.101940 2</span></span>
<span><span class="co">#&gt; 6   FN              4 1.388791 4</span></span>
<span><span class="co">#&gt; 7   FN              4 1.388791 4</span></span>
<span><span class="co">#&gt; 8   FO             12 2.485740 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La variabile <code>x</code> assume le seguenti modalità: assume valore 1 per il gruppo <code>SO</code>, valore 2 per il gruppo <code>FO</code>, eccetera.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">x</span>, <span class="va">dd</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     SO FO SN FN</span></span>
<span><span class="co">#&gt;   1 16  0  0  0</span></span>
<span><span class="co">#&gt;   2  0 14  0  0</span></span>
<span><span class="co">#&gt;   3  0  0 21  0</span></span>
<span><span class="co">#&gt;   4  0  0  0 18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Come anticipato in precedenza, il modello bayesiano che useremo per il confronto tra le medie dei quattro gruppi è un’estensione del modello per la media di un unico gruppo. Il codice che verrà qui usato è ispirato da quello fornito nella seguente <a href="http://avehtari.github.io/BDA_R_demos/demos_rstan/rstan_demo.html#8_Comparison_of_(k)_groups_with_hierarchical_models">pagina web</a>. Si noti che, rispetto al modello che abbiamo considerato in precedenza, l’unica differenza di rilievo riguarda la presenza di un indice, qui chiamato <code>x</code>, che consente di distinguere tra le medie dei quattro gruppi <code>mu[x]</code>.</p>
<p>Per adattare ai dati un modello “robusto” (ovvero, meno influenzato dalla osservazioni anomale), ipotizzeremo che la <code>y</code> segua una distribuzione <span class="math inline">\(t\)</span> di Student con un numero <span class="math inline">\(\nu\)</span> di gradi di libertà stimato dal modello. Scriveremo dunque in Stan la verosimiglianza nel modo seguente: <code>y ~ student_t(nu, mu[x], sigma);</code>. Tale linea di codice Stan ci dice che la verosimiglianza della <span class="math inline">\(y\)</span> è una <span class="math inline">\(t\)</span> di Student avente i seguenti parametri: <code>mu[x]</code> è la media della distribuzione<span class="math inline">\(t\)</span> di Student; la presenza dell’indice fa sì che la stima di questo parametro possa produrre risultati diversi per i quattro gruppi; il parametro <code>nu</code> definisce i gradi di libertà della distribuzione <span class="math inline">\(t\)</span> di Student; il valore di tale parametro è costante per i quattro gruppi; il parametro <code>sigma</code> definisce la deviazione standard della distribuzione <span class="math inline">\(t\)</span> di Student; anche il valore di tale parametro è costante per i quattro gruppi.</p>
<p>Il modello classico dell’ANOVA è basato sulle seguenti assunzioni:</p>
<ul>
<li>i residui (cioè la differenza tra il valore dell’<span class="math inline">\(i\)</span>-esima osservazione e la media di tutte le osservazioni nella <span class="math inline">\(k\)</span>-esima condizione) devono seguire la distribuzione Normale (normalità);</li>
<li>i residui devono avere la stessa deviazione standard nelle <span class="math inline">\(k\)</span> popolazioni da cui abbiamo estratto i dati (omoschedasticità);</li>
<li>il disegno sperimentale utilizzato per raccogliere i dati deve garantire l’indipendenza dei residui in ciascun gruppo.</li>
</ul>
<p>Nella presenta formulazione bayesiana dell’ANOVA, l’assunto di normalità non viene usato (infatti, ipotizziamo che la <span class="math inline">\(y\)</span> e, in maniera equivalente, i residui, si distribuiscano come una <span class="math inline">\(t\)</span> di Student), mentre devono essere soddisfatte le condizioni di omoschedasticità e indipendenza. L’ANOVA bayesiana può essere estesa a condizioni che violano sia l’assunto di omoschedasticità sia quello di indipendenza. Ma ciò non è necessario per i dati presenti; svolgeremo dunque l’analisi statistica in maniera simile a quanto è stato fatto da <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>.</p>
<p>I dati su scala logaritmica sono compresi in una gamma di valori pari a</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  -4.605   1.102   1.389   1.501   1.947   3.932</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ciò corrisponde, all’incirca, alla gamma di valori possibili di una variabile casuale Normale standardizzata. Possiamo dunque pensare alle distribuzioni a priori dei parametri del modello tenendo a mente questo caratteristica della variabile dipendente.</p>
<p>Il q-q plot esaminato in precedenza ha messo in evidenza la presenza nel campione di alcune osservazioni anomale. In tali circostanze non è dunque appropriato ipotizzare un meccanismo generatore dei dati che segue la legge Normale. Fare questa scelta significherebbe ottenere stime dei parametri del modello fortemente influenzate dalla osservazioni anomale. Di conseguenza, i risultati sarebbero difficilmente estendibili a campioni diversi. È invece possibile limitare l’influenza delle osservazioni anomale sulla stima dei parametri del modello ipotizzando una <span class="math inline">\(t\)</span> di Student quale meccanismo generatore dei dati. La distribuzione <span class="math inline">\(t\)</span> di Student dipende da tre parametri: il numero di gradi di libertà <span class="math inline">\(\nu\)</span>, la media <span class="math inline">\(\mu\)</span> e la deviazione standard <span class="math inline">\(\sigma\)</span>.</p>
<p>Per il caso presente ipotizziamo che tale meccanismo generatore dei dati abbia una media diversa per ciascun gruppo, mentre i parametri <span class="math inline">\(\nu\)</span> e <span class="math inline">\(\sigma\)</span> sono ipotizzati essere costanti tra i gruppi. L’uso di una <span class="math inline">\(t\)</span> di Student quale meccanismo generatore dei dati richiede, nell’approccio bayesiano, di imporre una distribuzione a priori a ciascuno dei parametri <span class="math inline">\(\mu_i\)</span>, <span class="math inline">\(\nu\)</span> e <span class="math inline">\(\sigma\)</span>. Nella specificazione del modello</p>
<ul>
<li>decidiamo di utilizzare la stessa distribuzione a priori debolmente informativa per ciascuno dei quattro parametri <span class="math inline">\(\mu_i\)</span>, con <span class="math inline">\(i \in 1, \dots, 4\)</span>, ovvero una <span class="math inline">\(\mathcal{N}(\mu_p = 0, \sigma_p = 2)\)</span>;</li>
<li>seguendo Juárez e Steel(2010), assegniamo a <span class="math inline">\(\nu\)</span> una distribuzione a priori <span class="math inline">\(\mbox{Gamma}(2, 0.1)\)</span>;</li>
<li>imponiamo su <span class="math inline">\(\sigma\)</span> una distribuzione a priori debolmente informativa corrispondente ad una Normale troncata di media 0 e deviazione standard 1.</li>
</ul>
<p>In linguaggio Stan il modello risulta dunque essere il seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_string</span> <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">  // Comparison of k groups with common variance (ANOVA)</span></span>
<span><span class="st">  data {</span></span>
<span><span class="st">    int&lt;lower=0&gt; N; // number of observations</span></span>
<span><span class="st">    int&lt;lower=0&gt; K; // number of groups</span></span>
<span><span class="st">    array[N] int&lt;lower=1, upper=K&gt; x; // discrete group indicators</span></span>
<span><span class="st">    vector[N] y; // real valued observations</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  parameters {</span></span>
<span><span class="st">    vector[K] mu; // group means</span></span>
<span><span class="st">    real&lt;lower=0&gt; sigma; // common standard deviation </span></span>
<span><span class="st">    real&lt;lower=1&gt; nu;</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  model {</span></span>
<span><span class="st">    mu ~ normal(0, 2); // weakly informative prior</span></span>
<span><span class="st">    sigma ~ normal(0, 1); // weakly informative prior</span></span>
<span><span class="st">    nu ~ gamma(2, 0.1); // Juárez and Steel(2010)</span></span>
<span><span class="st">    y ~ student_t(nu, mu[x], sigma); // likelihood</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="va">model_string</span>, con <span class="op">=</span> <span class="st">"code/grp_aov.stan"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creo un oggetto che contiene i dati nel formato appropriato per Stan.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  x <span class="op">=</span> <span class="va">dd</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">dd</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compilo il modello.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"grp_aov.stan"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">cmdstan_model</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguo il campionamento MCMC.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_grp</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">100000L</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">50000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">SEED</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminando i risultati ci rendiamo conto che c’è una buona corrispondenza tra le medie a posteriori e le medie campionarie. Ciò significa che il modello è stato in grado di predire in maniera adeguata le statistiche campionarie di interesse, ovvero le medie dei quattro campioni.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 10</span></span>
<span><span class="co">#&gt;   variable    mean  median     sd    mad      q5     q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 lp__     -41.2   -40.8   1.84   1.67   -44.7   -38.9    1.00  170658.  234349.</span></span>
<span><span class="co">#&gt; 2 mu[1]      1.69    1.68  0.174  0.171    1.41    1.98   1.00  546536.  286187.</span></span>
<span><span class="co">#&gt; 3 mu[2]      2.05    2.04  0.195  0.192    1.73    2.37   1.00  558949.  294238.</span></span>
<span><span class="co">#&gt; 4 mu[3]      1.52    1.52  0.121  0.120    1.32    1.72   1.00  566739.  291681.</span></span>
<span><span class="co">#&gt; 5 mu[4]      1.28    1.28  0.125  0.122    1.08    1.49   1.00  538847.  284675.</span></span>
<span><span class="co">#&gt; 6 sigma      0.475   0.471 0.0748 0.0735   0.360   0.605  1.00  380928.  277299.</span></span>
<span><span class="co">#&gt; 7 nu         2.55    2.41  0.813  0.719    1.49    4.05   1.00  372599.  233553.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’oggetto dell’inferenza è la varianza delle stime delle medie delle popolazioni. Per descrivere la variabilità (ovvero, l’incertezza) delle stime iniziamo a trasformare l’oggetto <code>fit</code> in un oggetto di classe <code>stanfit</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">output_stanfit</span> <span class="op">&lt;-</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_csv.html">read_stan_csv</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">output_files</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Uso la funzione <code><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html">rstan::extract()</a></code> per estrarre i campioni a posteriori da un oggetto di classe <code>stanfit</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu">extract</span><span class="op">(</span><span class="va">output_stanfit</span>, permuted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una rappresentazione grafica della distribuzione a posteriori dei parametri <span class="math inline">\(\mu_1, \mu_2, \mu_3, \mu_4\)</span> si ottiene con le istruzioni seguenti.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'SO'</span>, <span class="st">'FO'</span>, <span class="st">'SN'</span>, <span class="st">'FN'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">temps</span>, prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">'Log SwitchOff Time'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Uso la funzione <code>hdi()</code> per ottenere gli intervalli di credibilità a densità massima al 95% per i quattro parametri di interesse.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/hdi.html">hdi</a></span><span class="op">(</span><span class="va">output_stanfit</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; Highest Density Interval</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter |      95% HDI</span></span>
<span><span class="co">#&gt; ------------------------</span></span>
<span><span class="co">#&gt; mu[1]     | [1.36, 2.04]</span></span>
<span><span class="co">#&gt; mu[2]     | [1.67, 2.44]</span></span>
<span><span class="co">#&gt; mu[3]     | [1.28, 1.76]</span></span>
<span><span class="co">#&gt; mu[4]     | [1.04, 1.53]</span></span>
<span><span class="co">#&gt; nu        | [1.21, 4.16]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In maniera alternativa, lo stesso risultato si ottiene nel modo seguente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">broom.mixed</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/broom.mixed/man/mcmc_tidiers.html">tidyMCMC</a></span><span class="op">(</span></span>
<span>  <span class="va">output_stanfit</span>, </span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  conf.int <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  conf.method <span class="op">=</span> <span class="st">"HPDinterval"</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   term  estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mu[1]    1.68     0.174     1.36      2.04 </span></span>
<span><span class="co">#&gt; 2 mu[2]    2.04     0.195     1.67      2.44 </span></span>
<span><span class="co">#&gt; 3 mu[3]    1.52     0.121     1.28      1.76 </span></span>
<span><span class="co">#&gt; 4 mu[4]    1.28     0.125     1.04      1.53 </span></span>
<span><span class="co">#&gt; 5 sigma    0.471    0.0748    0.334     0.625</span></span>
<span><span class="co">#&gt; 6 nu       2.41     0.813     1.21      4.16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nel caso presente, gli intervalli di credibilità HDI sono molto simili agli intervalli di credibilità basati sui quantili.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">broom.mixed</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/broom.mixed/man/mcmc_tidiers.html">tidyMCMC</a></span><span class="op">(</span></span>
<span>  <span class="va">output_stanfit</span>, </span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  conf.int <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  conf.method <span class="op">=</span> <span class="st">"quantile"</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   term  estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mu[1]    1.68     0.174     1.36      2.05 </span></span>
<span><span class="co">#&gt; 2 mu[2]    2.04     0.195     1.67      2.44 </span></span>
<span><span class="co">#&gt; 3 mu[3]    1.52     0.121     1.28      1.76 </span></span>
<span><span class="co">#&gt; 4 mu[4]    1.28     0.125     1.04      1.53 </span></span>
<span><span class="co">#&gt; 5 sigma    0.471    0.0748    0.341     0.634</span></span>
<span><span class="co">#&gt; 6 nu       2.41     0.813     1.37      4.51</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione" class="level3" data-number="32.2.1"><h3 data-number="32.2.1" class="anchored" data-anchor-id="interpretazione">
<span class="header-section-number">32.2.1</span> Interpretazione</h3>
<p>Il modo più semplice per interpretare i risultati dell’ANOVA è quello di fare riferimento agli intervalli di credibilità dei diversi gruppi. Nel caso presente, ad esempio, notiamo che l’intervallo di credibilità al 95% per il gruppo FO, ovvero [1.67, 2.44], non si sovrappone all’intervallo di credibilità al 95% per il gruppo FN, ovvero [1.04, 1.53]. Possiamo dunque affermare, con un grado di certezza soggettiva del 95%, che il tempo impiegato dai partecipanti per spegnere il robot è maggiore nella condizione FO (<em>functional interaction</em>, <em>objection</em>) che nella condizione FN (<em>functional interaction</em>, <em>no objection</em>).</p>
</section></section><section id="anova-ad-due-vie" class="level2" data-number="32.3"><h2 data-number="32.3" class="anchored" data-anchor-id="anova-ad-due-vie">
<span class="header-section-number">32.3</span> ANOVA ad due vie</h2>
<p>Nel caso dell’esperimento di <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> è più utile descrivere i dati in riferimento a due criteri di classificazione (detti <em>fattori</em>) delle osservazioni:</p>
<ul>
<li>
<em>Interaction type</em>, con due modalità: <code>social</code> o <code>functional</code>;</li>
<li>
<em>Robot’s objection</em>, con due modalità: <code>objection</code> o <code>no objection</code>.</li>
</ul>
<p>Ciò consente di fare inferenza usando una procedura più semplice del confronto tra tutte le coppie di intervalli di credibilità, come abbiamo suggerito in precedenza. Nel caso di un’ANOVA a due vie, è possibile specificare due classi di test statistici: i test sull’interazione tra i fattori e i test sugli effetti principali. Per chiarire il significato di “interazione” e di “effetto principale” è necessario prima definire il significato di “effetto statistico”.</p>
<div class="definition">
<p>L’effetto di un fattore rappresenta la variazione media della variabile dipendente al variare dei livelli del fattore stesso.</p>
</div>
<div class="definition">
<p>Si parla di interazione quando l’effetto di un fattore sulla variabile dipendente varia a seconda dei livelli di un altro fattore.</p>
</div>
<p>Vengono presentati qui di seguito alcuni esempi. Le figure seguenti mostrano le medie di ciascuna condizione nel caso di un disegno 3 (fattore riga) <span class="math inline">\(\times\)</span> 2 (fattore colonna). La spiegazione delle figure è presentata nelle didascalie.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-anova1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><embed src="images/anova1.pdf" class="img-fluid"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;32.1: Il fattore colonna è indicato dal colore. <strong>Sinistra</strong> La figura mostra un effetto principale del fattore riga e un effetto principale del fattore colonna. Non c’è interazione tra i fattori riga e colonna. <strong>Destra</strong> La figura mostra un effetto principale del fattore riga. L’effetto principale del fattore colonna è zero. Non c’è interazione tra i fattori riga e colonna.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-anova2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><embed src="images/anova2.pdf" class="img-fluid"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;32.2: Il fattore colonna è indicato dal colore. <strong>Sinistra</strong> La figura mostra che l’effetto principale del fattore riga è zero, mentre c’è un effetto principale del fattore colonna. Non c’è interazione tra i fattori riga e colonna. <strong>Destra</strong> Non c’è né un effetto principale del fattore riga, né un effetto pricipale del fattore colonna, né un’interazione tra i fattori riga e colonna.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-anova3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><embed src="images/anova3.pdf" class="img-fluid"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;32.3: Il fattore colonna è indicato dal colore. Entrambe le figure mostrano un’interazione tra i fattori riga e colonna. Nella figura di sinistra gli effetti principali non sono interpretabili; nella figura di destra gli effetti principali sono interpretabili in quanto l’interazione è di lieve entità.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Dagli esempi precedenti si capisce che c’è un’interazione ogni qualvolta i profili delle medie non sono paralleli. Anche se, nella popolazione, non c’è interazione, a causa della variabilità campionaria i profili delle medie non sono mai perfettamente paralleli nel campione. Il problema è dunque quello di stabilire se l’assenza di parallelismo nel campione fornisce evidenze sufficienti per potere concludere che un’interazione tra i fattori è presente nella popolazione. Dobbiamo trovare un metodo statistico per rispondere ad una domanda di questo tipo.</p>
<section id="test-sullinterazione" class="level3" data-number="32.3.1"><h3 data-number="32.3.1" class="anchored" data-anchor-id="test-sullinterazione">
<span class="header-section-number">32.3.1</span> Test sull’interazione</h3>
<p>Ritorniamo ai dati di <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>. Nel caso di un disegno 2 <span class="math inline">\(\times\)</span> 2, con i fattori <em>Interaction type</em> (social, functional) e <em>Robot’s objection</em> (objection, no objection), è possibile verificare la presenza dell’interazione <em>Interaction type</em> <span class="math inline">\(\times\)</span> <em>Robot’s objection</em>.</p>
<p>Nel modello bayesiano, la distribuzione a posteriori fornisce un enorme numero di stime del valore della media in ciascuna delle quattro condizioni. L’effetto di un fattore corrisponde alla differenza tra le stime della media in corrispondenza di ciascuna modalità del fattore.</p>
<p>Nel caso presente abbiamo:</p>
<ul>
<li>
<code>mu[1]</code> <span class="math inline">\(\rightarrow\)</span> SO</li>
<li>
<code>mu[2]</code> <span class="math inline">\(\rightarrow\)</span> FO</li>
<li>
<code>mu[3]</code> <span class="math inline">\(\rightarrow\)</span> SN</li>
<li>
<code>mu[4]</code> <span class="math inline">\(\rightarrow\)</span> FN</li>
</ul>
<p>Quindi, <code>mean(posterior$mu[, 1] - posterior$mu[, 3])</code> corrisponde alla stima a posteriori dell’“effetto” (ovvero, della differenza tra medie) di <em>Objection</em> nella condizione <em>Social Interaction</em>. Invece, <code>mean(posterior$mu[, 2] - posterior$mu[, 3])</code> corrisponde alla stima a posteriori dell’“effetto” di <em>Objection</em> nella condizione <em>Functional Interaction</em>. In assenza di interazione, questi due effetti devono essere (statisticamente) uguali. Dire “statisticamente uguali” significa dire che sono uguali nella popolazione (non nel campione).</p>
<p>Per sottoporre a verifica l’ipotesi di <em>assenza di interazione</em> tra <em>Objection</em> e <em>Interaction</em>, calcoliamo la proporzione di volte in cui questo <em>non</em> si verifica nella distribuzione a posteriori. Ad esempio calcoliamo la proporzione di volte in cui la differenza <span class="math inline">\(\mu_1 - \mu_3\)</span> è maggiore della differenza <span class="math inline">\(\mu_2 - \mu_4\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> </span>
<span>    <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02824</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpretiamo una tale frequenza come una stima della corrispondente probabilità. La stima ottenuta in questo modo è molto simile alla probabilità frequentista riportata da <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>, ovvero <span class="math inline">\(p = 0.016\)</span>.</p>
<p>Dato che la probabilità calcolata è molto piccola – ovvero, in un contesto frequentista, minore della soglia critica di 0.05 – <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> concludono <em>rigettando l’ipotesi nulla</em> di assenza di interazione tra <em>Interaction type</em> (social, functional) e <em>Robot’s objection</em> (objection, no objection). Con il linguaggio dell’ANOVA possiamo dire che il fattore <em>Interaction type</em> interagisce con il fattore <em>Robot’s objection</em> nel determinare la variabile dipendente, ovvero il tempo di spegnimento del robot.</p>
<p>Anche se i dati suggeriscono la presenza di un’interazione tra <em>Interaction type</em> e <em>Robot’s objection</em> nella popolazione, la probabilità precedente non ci dice nulla sul <em>significato</em> di tale interazione. Il significato dell’interazione emerge dall’esame delle medie dei quattro gruppi nel campione.</p>
<p>Inizio creando un DataFrame che contiene le medie dei quattro gruppi e il relativo errore standard. L’errore standard è una stima della deviazione standard della media di un campione nell’universo dei campioni. Tale stima è uguale alla deviazione standard delle osservazioni campionarie divisa per la radice quadrata della numerosità del campione.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="va">dd</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    ym <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">df_plot</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span><span class="co">#&gt;   cond      n    ym     se</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 SO       16 0.990 0.564 </span></span>
<span><span class="co">#&gt; 2 FO       14 2.25  0.241 </span></span>
<span><span class="co">#&gt; 3 SN       21 1.53  0.0929</span></span>
<span><span class="co">#&gt; 4 FN       18 1.34  0.112</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="remark proof">
<p><span class="proof-title"><em>Nota</em>. </span>Ricordo qui come sia facile trovare l’errore standard della media di un campione casuale di osservazioni. Ripeto qui il teorema già presentato in precedenza. Immaginiamo che ciascuna osservazione del campione, <span class="math inline">\(Y_i\)</span>, sia una variabile casuale. Supponiamo che le osservazioni del campione siano iid. Il problema è trovare la varianza della media di <span class="math inline">\(n\)</span> v.c. iid.</p>
<p><span class="math display">\[
\begin{align}
\mathbb{V}(\bar{Y}) &amp;= \mathbb{V}\left(\frac{1}{n} \sum_{i=1}^n Y_i\right)\notag\\
&amp;= \left(\frac{1}{n}\right)^2 \mathbb{V}\left(\sum_{i=1}^n Y_i\right)\notag\\
&amp;= \left(\frac{1}{n}\right)^2 \sum_{i=1}^n \mathbb{V}\left(Y_i\right)\notag\\
&amp;= \left(\frac{1}{n}\right)^2 \sum_{i=1}^n \sigma^2\notag\\
&amp;= \left(\frac{1}{n}\right)^2 n \sigma^2\notag\\
&amp;= \frac{\sigma^2}{n}\notag
\end{align}
\]</span></p>
<p>Ne segue che una stima di <span class="math inline">\(\sigma/\sqrt{n}\)</span> è data da <span class="math inline">\(s/\sqrt{n}\)</span>, dove <span class="math inline">\(s\)</span> è la deviazione standard del campione quale stima calcolata come stimatore della deviazione standard della popolazione e <span class="math inline">\(n\)</span> è la numerosità campionaria.</p>
</div>
<p>Nel DataFrame aggiungo due colonne che contengono le modalità dei due fattori.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_plot</span><span class="op">$</span><span class="va">Interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Social"</span>, <span class="st">"Functional"</span>, <span class="st">"Social"</span>, <span class="st">"Functional"</span><span class="op">)</span></span>
<span><span class="va">df_plot</span><span class="op">$</span><span class="va">Objection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="va">df_plot</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 6</span></span>
<span><span class="co">#&gt;   cond      n    ym     se Interaction Objection</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 SO       16 0.990 0.564  Social      Yes      </span></span>
<span><span class="co">#&gt; 2 FO       14 2.25  0.241  Functional  Yes      </span></span>
<span><span class="co">#&gt; 3 SN       21 1.53  0.0929 Social      No       </span></span>
<span><span class="co">#&gt; 4 FN       18 1.34  0.112  Functional  No</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Posso ora creare un grafico con le quattro medie e le corrispondenti <em>barre d’errore</em> che corrispondono all’intervallo <span class="math inline">\(\bar{Y} \pm \ SE\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Objection</span>, y<span class="op">=</span><span class="va">ym</span>, group<span class="op">=</span><span class="va">Interaction</span>, color<span class="op">=</span><span class="va">Interaction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">ym</span><span class="op">-</span><span class="va">se</span>, ymax<span class="op">=</span><span class="va">ym</span><span class="op">+</span><span class="va">se</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.2</span>,</span>
<span>                 position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Social ability of a robot"</span>, x<span class="op">=</span><span class="st">"Objection"</span>, y <span class="op">=</span> <span class="st">"Log switch-off time"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>La figura precedente indica che l’effetto del fattore <code>Interaction</code> è maggiore quando <code>Objection</code> assume la modalità <code>Yes</code> anziché <code>No</code>.</p>
<p>Ma possiamo anche leggere l’interazione al contrario.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Interaction</span>, y<span class="op">=</span><span class="va">ym</span>, group<span class="op">=</span><span class="va">Objection</span>, color<span class="op">=</span><span class="va">Objection</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">ym</span><span class="op">-</span><span class="va">se</span>, ymax<span class="op">=</span><span class="va">ym</span><span class="op">+</span><span class="va">se</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.2</span>,</span>
<span>                 position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Social ability of a robot"</span>, x<span class="op">=</span><span class="st">"Interaction"</span>, y <span class="op">=</span> <span class="st">"Log switch-off time"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="060_anova_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>L’effetto di <code>Objection</code> è maggiore quando l’interazione è “funzionale” piuttosto che “sociale”.</p>
<p>Il grafico precedente, in qualunque delle sue due forme, chiarisce qual è il significato dell’interazione tra <code>Interaction</code> e <code>Objection</code>.</p>
<p>È importante notare che, in presenza di evidenza di un’interazione tra due fattori, non ha senso interpretare gli effetti principali dei fattori <span class="citation" data-cites="caudek2001statistica">(<a href="999_refs.html#ref-caudek2001statistica" role="doc-biblioref">Caudek &amp; Luccio, 2001</a>)</span>: dire che vi è un’interazione significa, appunto, dire che l’effetto di un fattore sulla variabile risposta <em>varia</em> a seconda del livello assunto dal secondo fattore. Quindi, in generale, non ha senso di parlare di “effetto principale” di un fattore, in quanto un tale effetto è condizionato dalla modalità assunta dall’altro fattore.</p>
</section><section id="test-sugli-effetti-principali" class="level3" data-number="32.3.2"><h3 data-number="32.3.2" class="anchored" data-anchor-id="test-sugli-effetti-principali">
<span class="header-section-number">32.3.2</span> Test sugli effetti principali</h3>
<p>Svolgiamo qui di seguito l’analisi statistica sugli effetti principali per mostrare come eseguire una tale analisi in un contesto bayesiano, anche se dobbiamo tenere a mente che, nel caso presente, una tale analisi non ha senso da un punto di vista sostanziale.</p>
<p>Sappiamo che l’effetto principale descrive l’effetto marginale di un fattore (ovvero, descrive la differenza tra le medie della variabile risposta calcolate in corrispondenza di ciascuna modalità della variabile considerata). Nel caso presente, con solo due modalità per ciascun fattore, l’effetto principale corrisponde alla differenze tra le medie dei gruppi definiti dalle modalità di ciascun fattore (ignorando l’altro fattore).</p>
<p>L’effetto principale del fattore <em>Interaction type</em> è la differenza tra le medie di <em>Social</em> e di <em>Functional</em>, ignorando <em>Robot’s objection</em>. <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> riportano che gli individui che avevano avuto un’interazione funzionale con il robot impiegavano più tempo a spegnere il robot di coloro che avevano avuto un’interazione sociale con il robot (<span class="math inline">\(p\)</span> = 0.045). Il presente modello bayesiano offre scarse evidenze di ciò.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.762315</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.044832</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Infatti, all’evento <em>complementare</em> possiamo associare la seguente probabilità.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> </span>
<span>    <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.346855</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’effetto principale del fattore <em>Robot’s objection</em> è la differenza tra le medie di <em>Objection</em> e di <em>No Objection</em>, ignorando <em>Interaction type</em>. <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span> riportano che i partecipanti avevano aspettato più a lungo prima di spegnere il robot quando il robot aveva avanzato un’obiezione rispetto a quando non si era opposto ad essere spento.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.694924</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.112223</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In base al modello bayesiano considerato, la probabilità direzionale per l’evento complementare è la seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> </span>
<span>    <span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00135</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tale probabilità corrisponde, in ordine di grandezza, alla probabilità frequentista riportata da <span class="citation" data-cites="horstmann2018robot">Horstmann et al. (<a href="999_refs.html#ref-horstmann2018robot" role="doc-biblioref">2018</a>)</span>, ovvero <span class="math inline">\(p\)</span> = 0.004.</p>
</section></section><section id="codice-stan-versione-2" class="level2" data-number="32.4"><h2 data-number="32.4" class="anchored" data-anchor-id="codice-stan-versione-2">
<span class="header-section-number">32.4</span> Codice Stan (versione 2)</h2>
<p>Per completezza, descrivo qui di seguito come sia possibile modificare il codice Stan che abbiamo usato in precedenza così da avere in input i dati grezzi ed da eseguire la standardizzazione dei dati all’interno del codice.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelString</span> <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">// Comparison of k groups with common variance (ANOVA)</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=0&gt; N; // number of observations</span></span>
<span><span class="st">  int&lt;lower=0&gt; K; // number of groups</span></span>
<span><span class="st">  array[N] int&lt;lower=1, upper=K&gt; x; // discrete group indicators</span></span>
<span><span class="st">  vector[N] y; // real valued observations</span></span>
<span><span class="st">}</span></span>
<span><span class="st">transformed data {</span></span>
<span><span class="st">  vector[N] y_std;</span></span>
<span><span class="st">  y_std = (y - mean(y)) / sd(y);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  vector[K] mu_std; // group means</span></span>
<span><span class="st">  real&lt;lower=0&gt; sigma_std; // common standard deviation </span></span>
<span><span class="st">  real&lt;lower=1&gt; nu;</span></span>
<span><span class="st">}</span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  mu_std ~ normal(0, 2);</span></span>
<span><span class="st">  sigma_std ~ normal(0, 2);</span></span>
<span><span class="st">  nu ~ gamma(2, 0.1); // Juárez and Steel(2010)</span></span>
<span><span class="st">  y_std ~ student_t(nu, mu_std[x], sigma_std);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">generated quantities {</span></span>
<span><span class="st">  vector[K] mu;</span></span>
<span><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span><span class="st">  for (i in 1 : K) {</span></span>
<span><span class="st">    mu[i] = mu_std[i] * sd(y) + mean(y);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  sigma = sd(y) * sigma_std;</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="va">modelString</span>, con <span class="op">=</span> <span class="st">"code/grp_aovstd.stan"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"grp_aovstd.stan"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">cmdstan_model</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguiamo il campionamento MCMC usando gli stessi dati discussi in precedenza:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_grp</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">100000L</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">50000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">SEED</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I risultati sono equivalenti a quelli trovati in precedenza.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit2</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   variable  mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mu[1]    1.70   1.69  0.176  0.173  1.42  2.00   1.00  537908.  285540.</span></span>
<span><span class="co">#&gt; 2 mu[2]    2.06   2.06  0.196  0.194  1.75  2.39   1.00  546099.  291608.</span></span>
<span><span class="co">#&gt; 3 mu[3]    1.52   1.52  0.122  0.120  1.33  1.73   1.00  557067.  296358.</span></span>
<span><span class="co">#&gt; 4 mu[4]    1.29   1.29  0.126  0.123  1.08  1.50   1.00  532941.  296657.</span></span>
<span><span class="co">#&gt; 5 sigma    0.479  0.475 0.0754 0.0741 0.363 0.610  1.00  358667.  271813.</span></span>
<span><span class="co">#&gt; 6 nu       2.57   2.43  0.824  0.728  1.51  4.11   1.00  350580.  222394.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="commenti-e-considerazioni-finali" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="commenti-e-considerazioni-finali">Commenti e considerazioni finali</h2>
<p>Possiamo concludere dicendo che l’ANOVA bayesiana si dimostra essere uno strumento più flessibile dell’ANOVA frequentista proposta da Fisher. L’ANOVA “classica”, infatti, richiede che venga soddisfatta l’assunzione di normalità, mentre abbiamo visto che, in un contesto bayesiano, ciò non è necessario. Il bonus che abbiamo ottenuto nella presente discussione, rilassando l’ipotesi di Normalità, è stato quello di potere usare un modello statistico maggiormente “robusto” alla presenza di osservazioni anomale nel campione. L’interpretazione dei risultati dell’ANOVA bayesiana è simile a quella dell’ANOVA frequentista. Anche in questo caso, però, i risultati possono essere presentati in maniera più completa che nel caso frequentista. Anziché limitarci a presentare i valori-<span class="math inline">\(p\)</span> associati ai test di ipotesi sugli effetti principali e sull’interazione, è più utile presentare, anche in maniera grafica, tutta la distribuzione a posteriori dei parametri che, in questo caso, corrispondono alle medie dei gruppi definiti dai diversi criteri di classificazione delle osservazioni che sono stati considerati.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography" style="display: none">
<div id="ref-van2020tutorial" class="csl-entry" role="doc-biblioentry">
Bergh, D. van den, Van Doorn, J., Marsman, M., Draws, T., Van Kesteren, E.-J., Derks, K., Dablander, F., Gronau, Q. F., Kucharskỳ, Š., Gupta, A. R. K. N., et al. (2020). A tutorial on conducting and interpreting a bayesian ANOVA in JASP. <em><span>L’Année</span> Psychologique</em>, <em>120</em>(1), 73–96.
</div>
<div id="ref-caudek2001statistica" class="csl-entry" role="doc-biblioentry">
Caudek, C., &amp; Luccio, R. (2001). <em>Statistica per psicologi</em>.
</div>
<div id="ref-horstmann2018robot" class="csl-entry" role="doc-biblioentry">
Horstmann, A. C., Bock, N., Linhuber, E., Szczuka, J. M., Straßmann, C., &amp; Krämer, N. C. (2018). Do a robot’s social skills and its objection discourage interactants from switching the robot off? <em>PloS One</em>, <em>13</em>(7), e0201581.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./056_pred_check.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Predictive checks</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./070_mod_hier.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Modello gerarchico</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Confronto tra le medie di tre o più gruppi {#sec-anova}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_stan_options.R"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"broom.mixed"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>L'Analisi della Varianza (ANOVA) è la tecnica statistica che consente di fare inferenze su tre o più medie di popolazioni indipendenti. Il requisito dell'indipendenza dei gruppi viene soddisfatto quando è lo sperimentatore stesso a costruire i gruppi, ovvero quando lo sperimentatore attribuisce in maniera casuale (*randomizzazione*) gli individui ai gruppi -- ad esempio, un gruppo di individui viene assegnato a caso al gruppo sperimentale e un gruppo di individui viene assegnato a caso al gruppo di controllo. L'ANOVA può dunque essere usata per l'analisi statistica dei dati provenienti da disegni sperimentali (come contrapposti ai disegni osservazionali): l'ANOVA è stata infatti proposta da Fisher per valutare gli effetti di un trattamento sperimentale. Curiosamente, Fisher applicò l'ANOVA ad esperimenti in agricoltura; in seguito, tale tecnica statistica è diventata popolare soprattutto in psicologia.</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>L'ANOVA si pone il problema di fare inferenza sulle medie di tre o più popolazioni. Se le osservazioni del campione si possono suddividere in gruppi in base ad un unico criterio di classificazione (ad esempio, *condizione sperimentale*, con tre modalità: gruppo di controllo, trattamento 1 e trattamento 2), diciamo che l'ANOVA è ad una via. Se le osservazioni del campione si possono suddividere in gruppi in base a due criteri di classificazione (ad esempio, *condizione sperimentale* e *genere*), allora diciamo che l'ANOVA è a due vie. È anche possibile un'ANOVA a tre o più vie, ma tali disegni sperimentali sono rari perché i risultati dell'analisi statistica sono difficili da interpretare. In questo Capitolo esamineremo l'ANOVA ad una via e l'ANOVA a due vie. Nel caso dell'ANOVA a due vie verrà introdotto un importante concetto, ovvero il concetto di "interazione statistica".</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>Da un punto di vista strettamente statistico, si può dire che l'ANOVA consente di valutare gli effetti di predittori categoriali su una variabile di esito continua. Dunque, l'ANOVA non è altro che un'analisi di regressione lineare nella quale tutte le variabili indipendenti sono qualitative. In questo Capitolo discuteremo dunque l'ANOVA come un'estensione del modello di regressione lineare e vedremo come usare l'inferenza bayesiana per fornire una risposta alle domande statistiche relative alle differenze tra le medie dei gruppi nella popolazione che derivano da disegni sperimentali ad una o due vie.</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Le abilità sociali di un robot</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>Per illustrare i concetti chiave dell'ANOVA bayesiana considereremo qui, quale esempio, una ricerca di @horstmann2018robot. I ricercatori si sono chiesti se le persone impiegano più tempo a spegnere un robot quando questo mostra abilità sociali. Nell'esperimento di @horstmann2018robot, 85 partecipanti hanno interagito con un robot per un certo tempo. Ai partecipanti è stato detto che lo scopo della loro interazione con il robot era quella di testare un nuovo algoritmo. Dopo il completamento di due compiti fittizi, ai partecipanti veniva detto che, se volevano, potevano spegnere il robot. La variabile di interesse dell'esperimento era il tempo impiegato dai partecipanti per spegnere il robot.</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>@horstmann2018robot hanno manipolato due variabili in un disegno "tra i soggetti" (ovvero, a gruppi indipendenti).</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Interaction type*. Le risposte verbali dei robot potevano essere o sociali (ad esempio, "Oh sì, la pizza è ottima." "Una volta ho mangiato una pizza grande come me.") o funzionali (ad esempio, "Preferisci la pizza." "Ha funzionato bene." "Continuiamo.").</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Robot's objection*. Il robot poteva reagire in due modi quando stava per essere spento: poteva protestare (ad esempio, "No! Per favore, non spegnermi! Ho paura di non riuscire ad accendermi di nuovo!") oppure non protestare.</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>Il disegno "tra i soggetti" di questo studio è dunque 2 (*Interaction type*) $\times$ 2 (*Robot's objection*).</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA ad una via</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>Iniziamo a considerare il con il caso più semplice, ovvero quello nel quale vi è un solo criterio di classificazione. Supponiamo che l'unico criterio di classificazione delle osservazioni sia la "condizione sperimentale", con quattro modalità. Creiamo dunque la variabile <span class="in">`cond`</span> avente le modalità <span class="in">`SO`</span>, <span class="in">`FO`</span>, <span class="in">`SN`</span>, <span class="in">`FN`</span>, dove <span class="in">`S`</span> = *social interaction*, `F` = *functional interaction*, `O` = *objection* e `N` = *no objection*.</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>Per volgere l'analisi statistica, iniziamo a leggere i dati in $\mathsf{R}$.</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"pone.0201581.s001.sav"</span>)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>Definisco la variabile <span class="in">`cond`</span>.</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>cond <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>Condition)</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>cond <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>cond, </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"SO"</span>, <span class="st">"FO"</span>, <span class="st">"SN"</span>, <span class="st">"FN"</span>)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>Nei dati ci sono alcuni dati mancanti. Ometto dunque le righe del DataFrame che contengono <span class="in">`NA`</span>. Seleziono poi solo le variabili di interesse dal DataFrame originario così da ottenere un nuovo DataFrame che verrà usato nelle successive analisi statistiche.</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(cond, SwitchOff_Time) <span class="sc">%&gt;%</span> </span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dd)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>Le medie nelle quattro condizioni sono le seguenti <span class="co">[</span><span class="ot">si veda la Tabella 3 di @horstmann2018robot</span><span class="co">]</span>.</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> </span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cond) <span class="sc">%&gt;%</span> </span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_sot =</span> <span class="fu">mean</span>(SwitchOff_Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_sot =</span> <span class="fu">sd</span>(SwitchOff_Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>Visualizziamo i dati grezzi mettendo in evidenza la mediana di ciascun gruppo quale indice di tendenza centrale.</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>dd_summary <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cond) <span class="sc">%&gt;%</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_mean =</span> <span class="fu">mean</span>(SwitchOff_Time),</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_sd =</span> <span class="fu">sd</span>(SwitchOff_Time),</span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_median =</span> <span class="fu">median</span>(SwitchOff_Time)</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> cond, <span class="at">y =</span> SwitchOff_Time, <span class="at">color =</span> cond)</span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> cond, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> sot_median, <span class="at">ymin =</span> sot_median,</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> sot_median</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dd_summary, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_grey</span>(<span class="at">name =</span> <span class="st">"cond"</span>) <span class="sc">+</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"SwitchOff Time"</span>,</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Condizione"</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>Dal grafico notiamo la presenza di una grande asimmetria positiva per la variabile <span class="in">`dd$SwitchOff_Time`</span>, in ciascun gruppo. Notiamo che, su scala logaritmica, l'asimmetria positiva della variabile <span class="in">`dd$SwitchOff_Time`</span> viene grandemente ridotta. Seguendo @van2020tutorial, analizzeremo dunque i tempi di spegnimento trasformati su scala logaritmica perché, appunto, dopo una tale trasformazione la variabile dipendente mostra una maggiore simmetria. In generale, non è necessario, in un ottica bayesiana, che la variabile dipendente abbia una distribuzione simmetrica. Nel caso presente, questo è utile perché ci consentirà di usare, quale modello distributivo della $y$, la distribuzione $t$ di Student. È utile ipotizzare un tale meccanismo generativo dei dati per il caso presente, in quanto la $t$ di Student consente di "rendere conto" della presenza di osservazioni anomale.</span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>dd_summary <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span></span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cond) <span class="sc">%&gt;%</span></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_mean =</span> <span class="fu">mean</span>(<span class="fu">log</span>(SwitchOff_Time)),</span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_sd =</span> <span class="fu">sd</span>(<span class="fu">log</span>(SwitchOff_Time)),</span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">sot_median =</span> <span class="fu">median</span>(<span class="fu">log</span>(SwitchOff_Time))</span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span></span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> cond, <span class="at">y =</span> <span class="fu">log</span>(SwitchOff_Time),</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> cond</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="fu">aes</span>(</span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> cond,</span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> sot_median, <span class="at">ymin =</span> sot_median,</span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> sot_median</span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dd_summary, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_grey</span>(<span class="at">name =</span> <span class="st">"cond"</span>) <span class="sc">+</span></span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"SwitchOff Time (log)"</span>,</span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Condizione"</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a>Per i dati trasformati, abbiamo le seguenti le medie e le mediane nei quattro gruppi.</span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">log</span>(dd<span class="sc">$</span>SwitchOff_Time <span class="sc">+</span> <span class="fl">0.01</span>)</span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> </span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cond) <span class="sc">%&gt;%</span> </span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">me_y =</span> <span class="fu">median</span>(y),</span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_y =</span> <span class="fu">mean</span>(y)</span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>Prima di applicare un modello statistico è necessario considerare con attenzione le informazioni che il campione ci fornisce a proposito della possibile legge distributiva seguita dalla variabile dipendente. Un modo per fare questo è quello di usare il grafico dei quantili per valutare visivamente la distribuzione della variabile di interesse. Il grafico dei quantili, detto anche q-q plot, è un grafico a dispersione che confronta i quantili della variabile osservata con quelli di una distribuzione di riferimento (qui, la distribuzione Normale). Per i dati presenti, il grafico dei quantili si ottiene nel modo seguente.</span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> </span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> y)) <span class="sc">+</span></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()</span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>Il q-q plot mostra, sull'asse delle ordinate, i valori $y$ del campione e, sull'asse delle ascisse, i quantili nomotetici (cioè dello stesso ordine) della distribuzione di riferimento Normale. Se i punti del q-q plot si dispongono su una retta, questo vuol dire che i dati del campione seguono la legge distributiva Normale (dato che qui abbiamo usato la Normale quale distribuzione di riferimento).</span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a>Si nota chiaramente, però, che ci sono almeno due osservazioni molto discrepanti rispetto ai loro valori teorici attesi, se le osservazioni provenissero da una distribuzione Normale. Come abbiamo detto in precedenza, @horstmann2018robot affrontano questo problema ipotizzando, quale meccanismo generativo dei dati, non una distribuzione Normale, ma bensì una $t$ di Student. La distribuzione $t$ di Student, avendo delle code più "spesse" della Normale, consente di "rendere conto" più facilmente della presenza di osservazioni anomale nel campione.</span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>Per svolgere l'ANOVA con Stan è necessario creare la variabile <span class="in">`x`</span> che indicizza le quattro condizioni.</span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dd<span class="sc">$</span>cond)</span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dd)</span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>La variabile <span class="in">`x`</span> assume le seguenti modalità: assume valore 1 per il gruppo <span class="in">`SO`</span>, valore 2 per il gruppo <span class="in">`FO`</span>, eccetera.</span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dd<span class="sc">$</span>x, dd<span class="sc">$</span>cond)</span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>Come anticipato in precedenza, il modello bayesiano che useremo per il confronto tra le medie dei quattro gruppi è un'estensione del modello per la media di un unico gruppo. Il codice che verrà qui usato è ispirato da quello fornito nella seguente <span class="co">[</span><span class="ot">pagina web</span><span class="co">]</span>(http://avehtari.github.io/BDA_R_demos/demos_rstan/rstan_demo.html#8_Comparison_of_(k)_groups_with_hierarchical_models). Si noti che, rispetto al modello che abbiamo considerato in precedenza, l'unica differenza di rilievo riguarda la presenza di un indice, qui chiamato <span class="in">`x`</span>, che consente di distinguere tra le medie dei quattro gruppi <span class="in">`mu[x]`</span>.</span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a>Per adattare ai dati un modello "robusto" (ovvero, meno influenzato dalla osservazioni anomale), ipotizzeremo che la <span class="in">`y`</span> segua una distribuzione $t$ di Student con un numero $\nu$ di gradi di libertà stimato dal modello. Scriveremo dunque in Stan la verosimiglianza nel modo seguente: <span class="in">`y ~ student_t(nu, mu[x], sigma);`</span>. Tale linea di codice Stan ci dice che la verosimiglianza della $y$ è una $t$ di Student avente i seguenti parametri: <span class="in">`mu[x]`</span> è la media della distribuzione$t$ di Student; la presenza dell'indice fa sì che la stima di questo parametro possa produrre risultati diversi per i quattro gruppi; il parametro <span class="in">`nu`</span> definisce i gradi di libertà della distribuzione $t$ di Student; il valore di tale parametro è costante per i quattro gruppi; il parametro <span class="in">`sigma`</span> definisce la deviazione standard della distribuzione $t$ di Student; anche il valore di tale parametro è costante per i quattro gruppi.</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a>Il modello classico dell'ANOVA è basato sulle seguenti assunzioni:</span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>i residui (cioè la differenza tra il valore dell'$i$-esima osservazione e la media di tutte le osservazioni nella $k$-esima condizione) devono seguire la distribuzione Normale (normalità);</span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>i residui devono avere la stessa deviazione standard nelle $k$ popolazioni da cui abbiamo estratto i dati (omoschedasticità);</span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>il disegno sperimentale utilizzato per raccogliere i dati deve garantire l'indipendenza dei residui in ciascun gruppo.</span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a>Nella presenta formulazione bayesiana dell'ANOVA, l'assunto di normalità non viene usato (infatti, ipotizziamo che la $y$ e, in maniera equivalente, i residui, si distribuiscano come una $t$ di Student), mentre devono essere soddisfatte le condizioni di omoschedasticità e indipendenza. L'ANOVA bayesiana può essere estesa a condizioni che violano sia l'assunto di omoschedasticità sia quello di indipendenza. Ma ciò non è necessario per i dati presenti; svolgeremo dunque l'analisi statistica in maniera simile a quanto è stato fatto da @horstmann2018robot.</span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a>I dati su scala logaritmica sono compresi in una gamma di valori pari a</span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dd<span class="sc">$</span>y)</span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a>Ciò corrisponde, all'incirca, alla gamma di valori possibili di una variabile casuale Normale standardizzata. Possiamo dunque pensare alle distribuzioni a priori dei parametri del modello tenendo a mente questo caratteristica della variabile dipendente.</span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a>Il q-q plot esaminato in precedenza ha messo in evidenza la presenza nel campione di alcune osservazioni anomale. In tali circostanze non è dunque appropriato ipotizzare un meccanismo generatore dei dati che segue la legge Normale. Fare questa scelta significherebbe ottenere stime dei parametri del modello fortemente influenzate dalla osservazioni anomale. Di conseguenza, i risultati sarebbero difficilmente estendibili a campioni diversi. È invece possibile limitare l'influenza delle osservazioni anomale sulla stima dei parametri del modello ipotizzando una $t$ di Student quale meccanismo generatore dei dati. La distribuzione $t$ di Student dipende da tre parametri: il numero di gradi di libertà $\nu$, la media $\mu$ e la deviazione standard $\sigma$.</span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a>Per il caso presente ipotizziamo che tale meccanismo generatore dei dati abbia una media diversa per ciascun gruppo, mentre i parametri $\nu$ e $\sigma$ sono ipotizzati essere costanti tra i gruppi. L'uso di una $t$ di Student quale meccanismo generatore dei dati richiede, nell'approccio bayesiano, di imporre una distribuzione a priori a ciascuno dei parametri $\mu_i$, $\nu$ e $\sigma$. Nella specificazione del modello</span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>decidiamo di utilizzare la stessa distribuzione a priori debolmente informativa per ciascuno dei quattro parametri $\mu_i$, con $i \in 1, \dots, 4$, ovvero una $\mathcal{N}(\mu_p = 0, \sigma_p = 2)$;</span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>seguendo Juárez e Steel(2010), assegniamo a $\nu$ una distribuzione a priori $\mbox{Gamma}(2, 0.1)$;</span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>imponiamo su $\sigma$ una distribuzione a priori debolmente informativa corrispondente ad una Normale troncata di media 0 e deviazione standard 1.</span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a>In linguaggio Stan il modello risulta dunque essere il seguente.</span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="st">  // Comparison of k groups with common variance (ANOVA)</span></span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; N; // number of observations</span></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; K; // number of groups</span></span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] int&lt;lower=1, upper=K&gt; x; // discrete group indicators</span></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[N] y; // real valued observations</span></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[K] mu; // group means</span></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; sigma; // common standard deviation </span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=1&gt; nu;</span></span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a><span class="st">    mu ~ normal(0, 2); // weakly informative prior</span></span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a><span class="st">    sigma ~ normal(0, 1); // weakly informative prior</span></span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a><span class="st">    nu ~ gamma(2, 0.1); // Juárez and Steel(2010)</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a><span class="st">    y ~ student_t(nu, mu[x], sigma); // likelihood</span></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model_string, <span class="at">con =</span> <span class="st">"code/grp_aov.stan"</span>)</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a>Creo un oggetto che contiene i dati nel formato appropriato per Stan.</span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a>data_grp <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(dd),</span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="dv">4</span>,</span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dd<span class="sc">$</span>x,</span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dd<span class="sc">$</span>y</span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a>Compilo il modello.</span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"code"</span>, <span class="st">"grp_aov.stan"</span>)</span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a>Eseguo il campionamento MCMC.</span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE, error=FALSE, results='hide'}</span></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_grp,</span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 100000L,</span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 50000L,</span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a>Esaminando i risultati ci rendiamo conto che c'è una buona corrispondenza tra le medie a posteriori e le medie campionarie. Ciò significa che il modello è stato in grado di predire in maniera adeguata le statistiche campionarie di interesse, ovvero le medie dei quattro campioni.</span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a>L'oggetto dell'inferenza è la varianza delle stime delle medie delle popolazioni. Per descrivere la variabilità (ovvero, l'incertezza) delle stime iniziamo a trasformare l'oggetto <span class="in">`fit`</span> in un oggetto di classe <span class="in">`stanfit`</span>.</span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a>output_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a>Uso la funzione <span class="in">`rstan::extract()`</span> per estrarre i campioni a posteriori da un oggetto di classe <span class="in">`stanfit`</span>.</span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">extract</span>(output_stanfit, <span class="at">permuted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a>Una rappresentazione grafica della distribuzione a posteriori dei parametri $\mu_1, \mu_2, \mu_3, \mu_4$ si ottiene con le istruzioni seguenti.</span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(posterior<span class="sc">$</span>mu) <span class="sc">%&gt;%</span></span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'SO'</span>, <span class="st">'FO'</span>, <span class="st">'SN'</span>, <span class="st">'FN'</span>))</span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(temps, <span class="at">prob =</span> <span class="fl">0.95</span>) <span class="sc">+</span> </span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Log SwitchOff Time'</span>)</span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>Uso la funzione <span class="in">`hdi()`</span> per ottenere gli intervalli di credibilità a densità massima al 95% per i quattro parametri di interesse.</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(output_stanfit, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>In maniera alternativa, lo stesso risultato si ottiene nel modo seguente:</span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidyMCMC</span>(</span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a>  output_stanfit, </span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.method =</span> <span class="st">"HPDinterval"</span>, </span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>)</span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a>Nel caso presente, gli intervalli di credibilità HDI sono molto simili agli intervalli di credibilità basati sui quantili.</span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidyMCMC</span>(</span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a>  output_stanfit, </span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.method =</span> <span class="st">"quantile"</span>, </span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>)</span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretazione</span></span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>Il modo più semplice per interpretare i risultati dell'ANOVA è quello di fare riferimento agli intervalli di credibilità dei diversi gruppi. Nel caso presente, ad esempio, notiamo che l'intervallo di credibilità al 95% per il gruppo FO, ovvero <span class="sc">\[</span>1.67, 2.44<span class="sc">\]</span>, non si sovrappone all'intervallo di credibilità al 95% per il gruppo FN, ovvero <span class="sc">\[</span>1.04, 1.53<span class="sc">\]</span>. Possiamo dunque affermare, con un grado di certezza soggettiva del 95%, che il tempo impiegato dai partecipanti per spegnere il robot è maggiore nella condizione FO (*functional interaction*, *objection*) che nella condizione FN (*functional interaction*, *no objection*).</span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA ad due vie</span></span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>Nel caso dell'esperimento di @horstmann2018robot è più utile descrivere i dati in riferimento a due criteri di classificazione (detti *fattori*) delle osservazioni:</span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Interaction type*, con due modalità: <span class="in">`social`</span> o <span class="in">`functional`</span>;</span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Robot's objection*, con due modalità: <span class="in">`objection`</span> o <span class="in">`no objection`</span>.</span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a>Ciò consente di fare inferenza usando una procedura più semplice del confronto tra tutte le coppie di intervalli di credibilità, come abbiamo suggerito in precedenza. Nel caso di un'ANOVA a due vie, è possibile specificare due classi di test statistici: i test sull'interazione tra i fattori e i test sugli effetti principali. Per chiarire il significato di "interazione" e di "effetto principale" è necessario prima definire il significato di "effetto statistico".</span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a>::: definition</span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a>L'effetto di un fattore rappresenta la variazione media della variabile dipendente al variare dei livelli del fattore stesso.</span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a>::: definition</span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a>Si parla di interazione quando l'effetto di un fattore sulla variabile dipendente varia a seconda dei livelli di un altro fattore.</span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a>Vengono presentati qui di seguito alcuni esempi. Le figure seguenti mostrano le medie di ciascuna condizione nel caso di un disegno 3 (fattore riga) $\times$ 2 (fattore colonna). La spiegazione delle figure è presentata nelle didascalie.</span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-anova1, echo=FALSE, fig.height=3, fig.width=6, fig.cap="Il fattore colonna è indicato dal colore. **Sinistra** La figura mostra un effetto principale del fattore riga e un effetto principale del fattore colonna. Non c'è interazione tra i fattori riga e colonna. **Destra** La figura mostra un effetto principale del fattore riga. L'effetto principale del fattore colonna è zero. Non c'è interazione tra i fattori riga e colonna.", fig.align="center"}</span></span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/anova1.pdf"</span>)</span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-anova2, echo=FALSE, fig.height=3, fig.width=6, fig.cap="Il fattore colonna è indicato dal colore. **Sinistra** La figura mostra che l'effetto principale del fattore riga è zero, mentre c'è un effetto principale del fattore colonna. Non c'è interazione tra i fattori riga e colonna. **Destra** Non c'è né un effetto principale del fattore riga, né un effetto pricipale del fattore colonna, né un'interazione tra i fattori riga e colonna.", fig.align="center"}</span></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/anova2.pdf"</span>)</span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-anova3, echo=FALSE, fig.height=3, fig.width=6, fig.cap="Il fattore colonna è indicato dal colore. Entrambe le figure mostrano un'interazione tra i fattori riga e colonna. Nella figura di sinistra gli effetti principali non sono interpretabili; nella figura di destra gli effetti principali sono interpretabili in quanto l'interazione è di lieve entità.", fig.align="center"}</span></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/anova3.pdf"</span>)</span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>Dagli esempi precedenti si capisce che c'è un'interazione ogni qualvolta i profili delle medie non sono paralleli. Anche se, nella popolazione, non c'è interazione, a causa della variabilità campionaria i profili delle medie non sono mai perfettamente paralleli nel campione. Il problema è dunque quello di stabilire se l'assenza di parallelismo nel campione fornisce evidenze sufficienti per potere concludere che un'interazione tra i fattori è presente nella popolazione. Dobbiamo trovare un metodo statistico per rispondere ad una domanda di questo tipo.</span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test sull'interazione</span></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>Ritorniamo ai dati di @horstmann2018robot. Nel caso di un disegno 2 $\times$ 2, con i fattori *Interaction type* (social, functional) e *Robot's objection* (objection, no objection), è possibile verificare la presenza dell'interazione *Interaction type* $\times$ *Robot's objection*.</span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>Nel modello bayesiano, la distribuzione a posteriori fornisce un enorme numero di stime del valore della media in ciascuna delle quattro condizioni. L'effetto di un fattore corrisponde alla differenza tra le stime della media in corrispondenza di ciascuna modalità del fattore.</span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a>Nel caso presente abbiamo:</span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mu[1]`</span> $\rightarrow$ SO</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mu[2]`</span> $\rightarrow$ FO</span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mu[3]`</span> $\rightarrow$ SN</span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mu[4]`</span> $\rightarrow$ FN</span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>Quindi, <span class="in">`mean(posterior$mu[, 1] - posterior$mu[, 3])`</span> corrisponde alla stima a posteriori dell'"effetto" (ovvero, della differenza tra medie) di *Objection* nella condizione *Social Interaction*. Invece, `mean(posterior$mu[, 2] - posterior$mu[, 3])` corrisponde alla stima a posteriori dell'"effetto" di *Objection* nella condizione *Functional Interaction*. In assenza di interazione, questi due effetti devono essere (statisticamente) uguali. Dire "statisticamente uguali" significa dire che sono uguali nella popolazione (non nel campione).</span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>Per sottoporre a verifica l'ipotesi di *assenza di interazione* tra *Objection* e *Interaction*, calcoliamo la proporzione di volte in cui questo *non* si verifica nella distribuzione a posteriori. Ad esempio calcoliamo la proporzione di volte in cui la differenza $\mu_1 - \mu_3$ è maggiore della differenza $\mu_2 - \mu_4$.</span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(</span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a>  (posterior<span class="sc">$</span>mu[, <span class="dv">1</span>] <span class="sc">-</span> posterior<span class="sc">$</span>mu[, <span class="dv">3</span>]) <span class="sc">&gt;</span> </span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a>    (posterior<span class="sc">$</span>mu[, <span class="dv">2</span>] <span class="sc">-</span> posterior<span class="sc">$</span>mu[, <span class="dv">4</span>])</span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">/</span> </span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(posterior<span class="sc">$</span>mu[, <span class="dv">1</span>])</span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a>Interpretiamo una tale frequenza come una stima della corrispondente probabilità. La stima ottenuta in questo modo è molto simile alla probabilità frequentista riportata da @horstmann2018robot, ovvero $p = 0.016$.</span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a>Dato che la probabilità calcolata è molto piccola -- ovvero, in un contesto frequentista, minore della soglia critica di 0.05 -- @horstmann2018robot concludono *rigettando l'ipotesi nulla* di assenza di interazione tra *Interaction type* (social, functional) e *Robot's objection* (objection, no objection). Con il linguaggio dell'ANOVA possiamo dire che il fattore *Interaction type* interagisce con il fattore *Robot's objection* nel determinare la variabile dipendente, ovvero il tempo di spegnimento del robot.</span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a>Anche se i dati suggeriscono la presenza di un'interazione tra *Interaction type* e *Robot's objection* nella popolazione, la probabilità precedente non ci dice nulla sul *significato* di tale interazione. Il significato dell'interazione emerge dall'esame delle medie dei quattro gruppi nel campione.</span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a>Inizio creando un DataFrame che contiene le medie dei quattro gruppi e il relativo errore standard. L'errore standard è una stima della deviazione standard della media di un campione nell'universo dei campioni. Tale stima è uguale alla deviazione standard delle osservazioni campionarie divisa per la radice quadrata della numerosità del campione.</span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span> </span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cond) <span class="sc">%&gt;%</span> </span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a>    <span class="at">ym =</span> <span class="fu">mean</span>(y),</span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(y) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a>df_plot</span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-449"><a href="#cb35-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-450"><a href="#cb35-450" aria-hidden="true" tabindex="-1"></a>::: remark</span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a>Ricordo qui come sia facile trovare l'errore standard della media di un campione casuale di osservazioni. Ripeto qui il teorema già presentato in precedenza. Immaginiamo che ciascuna osservazione del campione, $Y_i$, sia una variabile casuale. Supponiamo che le osservazioni del campione siano iid. Il problema è trovare la varianza della media di $n$ v.c. iid.</span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>\mathbb{V}(\bar{Y}) &amp;= \mathbb{V}\left(\frac{1}{n} \sum_{i=1}^n Y_i\right)\notag<span class="sc">\\</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a>&amp;= \left(\frac{1}{n}\right)^2 \mathbb{V}\left(\sum_{i=1}^n Y_i\right)\notag<span class="sc">\\</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>&amp;= \left(\frac{1}{n}\right)^2 \sum_{i=1}^n \mathbb{V}\left(Y_i\right)\notag<span class="sc">\\</span></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>&amp;= \left(\frac{1}{n}\right)^2 \sum_{i=1}^n \sigma^2\notag<span class="sc">\\</span></span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>&amp;= \left(\frac{1}{n}\right)^2 n \sigma^2\notag<span class="sc">\\</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\sigma^2}{n}\notag</span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a>Ne segue che una stima di $\sigma/\sqrt{n}$ è data da $s/\sqrt{n}$, dove $s$ è la deviazione standard del campione quale stima calcolata come stimatore della deviazione standard della popolazione e $n$ è la numerosità campionaria.</span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a>Nel DataFrame aggiungo due colonne che contengono le modalità dei due fattori.</span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>df_plot<span class="sc">$</span>Interaction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Social"</span>, <span class="st">"Functional"</span>, <span class="st">"Social"</span>, <span class="st">"Functional"</span>)</span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a>df_plot<span class="sc">$</span>Objection <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>)</span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a>df_plot</span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a>Posso ora creare un grafico con le quattro medie e le corrispondenti *barre d'errore* che corrispondono all'intervallo $\bar{Y} \pm \ SE$.</span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a>df_plot <span class="sc">%&gt;%</span> </span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Objection, <span class="at">y=</span>ym, <span class="at">group=</span>Interaction, <span class="at">color=</span>Interaction)) <span class="sc">+</span> </span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ym<span class="sc">-</span>se, <span class="at">ymax=</span>ym<span class="sc">+</span>se), <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Social ability of a robot"</span>, <span class="at">x=</span><span class="st">"Objection"</span>, <span class="at">y =</span> <span class="st">"Log switch-off time"</span>)</span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a>La figura precedente indica che l'effetto del fattore <span class="in">`Interaction`</span> è maggiore quando <span class="in">`Objection`</span> assume la modalità <span class="in">`Yes`</span> anziché <span class="in">`No`</span>.</span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a>Ma possiamo anche leggere l'interazione al contrario.</span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>df_plot <span class="sc">%&gt;%</span> </span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Interaction, <span class="at">y=</span>ym, <span class="at">group=</span>Objection, <span class="at">color=</span>Objection)) <span class="sc">+</span> </span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ym<span class="sc">-</span>se, <span class="at">ymax=</span>ym<span class="sc">+</span>se), <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Social ability of a robot"</span>, <span class="at">x=</span><span class="st">"Interaction"</span>, <span class="at">y =</span> <span class="st">"Log switch-off time"</span>)</span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a>L'effetto di <span class="in">`Objection`</span> è maggiore quando l'interazione è "funzionale" piuttosto che "sociale".</span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>Il grafico precedente, in qualunque delle sue due forme, chiarisce qual è il significato dell'interazione tra <span class="in">`Interaction`</span> e <span class="in">`Objection`</span>.</span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>È importante notare che, in presenza di evidenza di un'interazione tra due fattori, non ha senso interpretare gli effetti principali dei fattori <span class="co">[</span><span class="ot">@caudek2001statistica</span><span class="co">]</span>: dire che vi è un'interazione significa, appunto, dire che l'effetto di un fattore sulla variabile risposta *varia* a seconda del livello assunto dal secondo fattore. Quindi, in generale, non ha senso di parlare di "effetto principale" di un fattore, in quanto un tale effetto è condizionato dalla modalità assunta dall'altro fattore.</span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test sugli effetti principali</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>Svolgiamo qui di seguito l'analisi statistica sugli effetti principali per mostrare come eseguire una tale analisi in un contesto bayesiano, anche se dobbiamo tenere a mente che, nel caso presente, una tale analisi non ha senso da un punto di vista sostanziale.</span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a>Sappiamo che l'effetto principale descrive l'effetto marginale di un fattore (ovvero, descrive la differenza tra le medie della variabile risposta calcolate in corrispondenza di ciascuna modalità della variabile considerata). Nel caso presente, con solo due modalità per ciascun fattore, l'effetto principale corrisponde alla differenze tra le medie dei gruppi definiti dalle modalità di ciascun fattore (ignorando l'altro fattore).</span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a>L'effetto principale del fattore *Interaction type* è la differenza tra le medie di *Social* e di *Functional*, ignorando *Robot's objection*. @horstmann2018robot riportano che gli individui che avevano avuto un'interazione funzionale con il robot impiegavano più tempo a spegnere il robot di coloro che avevano avuto un'interazione sociale con il robot ($p$ = 0.045). Il presente modello bayesiano offre scarse evidenze di ciò.</span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((<span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">4</span>])) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((<span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">3</span>])) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a>Infatti, all'evento *complementare* possiamo associare la seguente probabilità.</span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(</span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a>  (posterior<span class="sc">$</span>mu[, <span class="dv">2</span>] <span class="sc">+</span> posterior<span class="sc">$</span>mu[, <span class="dv">4</span>]) <span class="sc">&lt;</span> </span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a>    (posterior<span class="sc">$</span>mu[, <span class="dv">1</span>] <span class="sc">+</span> posterior<span class="sc">$</span>mu[, <span class="dv">3</span>])</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">/</span> </span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(posterior<span class="sc">$</span>mu[, <span class="dv">1</span>])</span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a>L'effetto principale del fattore *Robot's objection* è la differenza tra le medie di *Objection* e di *No Objection*, ignorando *Interaction type*. @horstmann2018robot riportano che i partecipanti avevano aspettato più a lungo prima di spegnere il robot quando il robot aveva avanzato un'obiezione rispetto a quando non si era opposto ad essere spento.</span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(</span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">2</span>])) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(</span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">exp</span>(posterior<span class="sc">$</span>mu[, <span class="dv">4</span>])) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a>In base al modello bayesiano considerato, la probabilità direzionale per l'evento complementare è la seguente.</span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(</span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a>  (posterior<span class="sc">$</span>mu[, <span class="dv">1</span>] <span class="sc">+</span> posterior<span class="sc">$</span>mu[, <span class="dv">2</span>]) <span class="sc">&lt;</span> </span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>    (posterior<span class="sc">$</span>mu[, <span class="dv">3</span>] <span class="sc">+</span> posterior<span class="sc">$</span>mu[, <span class="dv">4</span>])</span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">/</span> </span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(posterior<span class="sc">$</span>mu[, <span class="dv">1</span>])</span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a>Tale probabilità corrisponde, in ordine di grandezza, alla probabilità frequentista riportata da @horstmann2018robot, ovvero $p$ = 0.004.</span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a><span class="fu">## Codice Stan (versione 2)</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a>Per completezza, descrivo qui di seguito come sia possibile modificare il codice Stan che abbiamo usato in precedenza così da avere in input i dati grezzi ed da eseguire la standardizzazione dei dati all'interno del codice.</span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a><span class="st">// Comparison of k groups with common variance (ANOVA)</span></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N; // number of observations</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; K; // number of groups</span></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=1, upper=K&gt; x; // discrete group indicators</span></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y; // real valued observations</span></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a><span class="st">transformed data {</span></span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y_std;</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std = (y - mean(y)) / sd(y);</span></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[K] mu_std; // group means</span></span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_std; // common standard deviation </span></span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=1&gt; nu;</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a><span class="st">  mu_std ~ normal(0, 2);</span></span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma_std ~ normal(0, 2);</span></span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a><span class="st">  nu ~ gamma(2, 0.1); // Juárez and Steel(2010)</span></span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a><span class="st">  y_std ~ student_t(nu, mu_std[x], sigma_std);</span></span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[K] mu;</span></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1 : K) {</span></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a><span class="st">    mu[i] = mu_std[i] * sd(y) + mean(y);</span></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma = sd(y) * sigma_std;</span></span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">"code/grp_aovstd.stan"</span>)</span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"code"</span>, <span class="st">"grp_aovstd.stan"</span>)</span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a>Eseguiamo il campionamento MCMC usando gli stessi dati discussi in precedenza:</span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE, error=FALSE, results='hide'}</span></span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb35-621"><a href="#cb35-621" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_grp,</span>
<span id="cb35-622"><a href="#cb35-622" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 100000L,</span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 50000L,</span>
<span id="cb35-624"><a href="#cb35-624" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb35-625"><a href="#cb35-625" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a>I risultati sono equivalenti a quelli trovati in precedenza.</span>
<span id="cb35-631"><a href="#cb35-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a>fit2<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>))</span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a><span class="fu">## Commenti e considerazioni finali {.unnumbered}</span></span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a>Possiamo concludere dicendo che l'ANOVA bayesiana si dimostra essere uno strumento più flessibile dell'ANOVA frequentista proposta da Fisher. L'ANOVA "classica", infatti, richiede che venga soddisfatta l'assunzione di normalità, mentre abbiamo visto che, in un contesto bayesiano, ciò non è necessario. Il bonus che abbiamo ottenuto nella presente discussione, rilassando l'ipotesi di Normalità, è stato quello di potere usare un modello statistico maggiormente "robusto" alla presenza di osservazioni anomale nel campione. L'interpretazione dei risultati dell'ANOVA bayesiana è simile a quella dell'ANOVA frequentista. Anche in questo caso, però, i risultati possono essere presentati in maniera più completa che nel caso frequentista. Anziché limitarci a presentare i valori-$p$ associati ai test di ipotesi sugli effetti principali e sull'interazione, è più utile presentare, anche in maniera grafica, tutta la distribuzione a posteriori dei parametri che, in questo caso, corrispondono alle medie dei gruppi definiti dai diversi criteri di classificazione delle osservazioni che sono stati considerati.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>