<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Data Science per psicologi - 21&nbsp; Markov Chain Monte Carlo per l’inferenza bayesiana</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./041_mcmc_diagnostics.html" rel="next">
<link href="./036_posterior_sim.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo per l’inferenza bayesiana</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science per psicologi</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/data_science/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Benvenuti</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Prefazione</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basics.html" class="sidebar-item-text sidebar-link">Parte 1: Nozioni di base</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001_key_notions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_measurement.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007_freq_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analisi esplorativa dei dati</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011_loc_scale.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Indici di posizione e di scala</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012_correlation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Le relazioni tra variabili</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013_penguins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipolazione e visualizzazione dei dati in <span class="math inline">\(\mathsf{R}\)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">Parte 2: Il calcolo delle probabilità</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./015_prob_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">La logica dell’incerto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./016_conditional_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probabilità condizionata: significato, teoremi, eventi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./017_bayes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./018_expval_var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Indici di posizione, di varianza e di associazione di variabili casuali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./019_joint_prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./020_density_func.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La densità di probabilità</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./distr.html" class="sidebar-item-text sidebar-link">Parte 3: Distribuzioni di v.c. discrete e continue</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./022_discr_rv_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./023_cont_rv_distr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./024_likelihood.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">La funzione di verosimiglianza</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./bayes_inference.html" class="sidebar-item-text sidebar-link">Parte 4: Inferenza bayesiana</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./025_intro_bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Credibilità, modelli e parametri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./026_subj_prop.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./029_conjugate_families.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./030_balance_prior_post.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./036_posterior_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Approssimazione della distribuzione a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./040_beta_binomial_mod.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo per l’inferenza bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./041_mcmc_diagnostics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./045_summarize_posterior.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./046_bayesian_prediction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La predizione bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_normal_normal_mod.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression.html" class="sidebar-item-text sidebar-link">Parte 5: Regressione lineare</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./051_reglin1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./052_reglin2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regressione lineare bivariata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./053_reglin3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Modello di regressione in linguaggio Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./054_reglin4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Inferenza sul modello lineare</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./055_reglin5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Confronto tra due gruppi indipendenti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./056_pred_check.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Predictive checks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di tre o più gruppi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./070_mod_hier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Modello gerarchico</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./071_mod_hier_sim.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Modello gerarchico: simulazioni</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./entropy.html" class="sidebar-item-text sidebar-link">Parte 6: Entropia</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./090_entropy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Entropia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./091_kl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./092_info_criterion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Criterio di informazione e convalida incrociata</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./frequentist_inference.html" class="sidebar-item-text sidebar-link">Parte 7: Inferenza frequentista</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./220_intro_frequentist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Legge dei grandi numeri</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./221_conf_interv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Intervallo fiduciale</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./225_distr_camp_mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzione campionaria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./226_test_ipotesi.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Significatività statistica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./227_ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Inferenza sulle medie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./228_limiti_stat_frequentista.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./999_refs.html" class="sidebar-item-text sidebar-link">Riferimenti bibliografici</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Appendici</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a01_math_symbols.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Simbologia di base</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a02_number_sets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Numeri binari, interi, razionali, irrazionali e reali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a03_set_theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Insiemi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a04_summation_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Simbolo di somma (sommatorie)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a05_calculus_notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a10_markov_chains.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Le catene di Markov</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a15_stan_lang.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Programmare in Stan</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul>
<li><a href="#il-presidente-trump-e-lidrossiclorochina" id="toc-il-presidente-trump-e-lidrossiclorochina" class="nav-link active" data-scroll-target="#il-presidente-trump-e-lidrossiclorochina"><span class="toc-section-number">21.1</span>  Il presidente Trump e l’idrossiclorochina</a></li>
  <li><a href="#una-proporzione" id="toc-una-proporzione" class="nav-link" data-scroll-target="#una-proporzione"><span class="toc-section-number">21.2</span>  Una proporzione</a></li>
  <li><a href="#dedurre-una-proporzione-binomiale-con-pymc" id="toc-dedurre-una-proporzione-binomiale-con-pymc" class="nav-link" data-scroll-target="#dedurre-una-proporzione-binomiale-con-pymc"><span class="toc-section-number">21.3</span>  Dedurre una proporzione binomiale con PyMC</a></li>
  <li>
<a href="#dati" id="toc-dati" class="nav-link" data-scroll-target="#dati"><span class="toc-section-number">21.4</span>  Dati</a>
  <ul class="collapse">
<li><a href="#specificare-il-modello" id="toc-specificare-il-modello" class="nav-link" data-scroll-target="#specificare-il-modello"><span class="toc-section-number">21.4.1</span>  Specificare il modello</a></li>
  <li><a href="#campionamento" id="toc-campionamento" class="nav-link" data-scroll-target="#campionamento"><span class="toc-section-number">21.4.2</span>  Campionamento</a></li>
  <li><a href="#analisi-a-posteriori" id="toc-analisi-a-posteriori" class="nav-link" data-scroll-target="#analisi-a-posteriori"><span class="toc-section-number">21.4.3</span>  Analisi a posteriori</a></li>
  </ul>
</li>
  <li><a href="#la-critica-di-hulme_2020" id="toc-la-critica-di-hulme_2020" class="nav-link" data-scroll-target="#la-critica-di-hulme_2020"><span class="toc-section-number">21.5</span>  La critica di <span class="citation" data-cites="Hulme_2020">Hulme et al. (2020)</span></a></li>
  <li><a href="#due-proporzioni" id="toc-due-proporzioni" class="nav-link" data-scroll-target="#due-proporzioni"><span class="toc-section-number">21.6</span>  Due proporzioni</a></li>
  <li><a href="#commenti-e-considerazioni-finali" id="toc-commenti-e-considerazioni-finali" class="nav-link" data-scroll-target="#commenti-e-considerazioni-finali">Commenti e considerazioni finali</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-stan-beta-binom" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo per l’inferenza bayesiana</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Codice</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In questo Capitolo introdurremo PyMC, un pacchetto Python per la modellazione statistica bayesiana. Nel <a href="036_posterior_sim.html"><span>Capitolo&nbsp;20</span></a> abbiamo esaminato l’algoritmo Metropolis che consente di generare campioni da distribuzioni di probabilità basati sulla costruzione di una catena di Markov avente come distribuzione di equilibrio (o stazionaria) la distribuzione desiderata. Benché l’algoritmo Metropolis possa essere utilizzato per risolvere problemi più complessi di quello utilizzato nell’esempio che abbiamo discusso, un suo limite risiede nel fatto che è poco efficiente – nel caso di modelli complessi, dunque, richiede molto tempo per raggiungere una distribuzione stazionaria (ovvero, una distribuzione di probabilità che si mantiene costante all’evolversi nel tempo della catena di Markov). Sono stati messi a punto algoritmi Monte Carlo (MCMC) a catena di Markov che massimizzano l’efficienza nella velocità di esecuzione, come ad esempio, il campionatore No-U-Turn (NUTS), gli algoritmi Metropolis-Hastings, Gibbs Sampler e Hamiltonian Monte Carlo, e questi motori di inferenza (incluso l’algoritmo Metropolis di cui abbiamo discusso nel capitolo precedente) sono implementati in vari framework per la programmazione probabilistica (PP). PyMC e <a href="http://mc-stan.org/">Stan</a> <span class="citation" data-cites="carpenter2017stan">(<a href="999_refs.html#ref-carpenter2017stan" role="doc-biblioref">Carpenter et al., 2017</a>)</span> sono i due strumenti di PP più popolari. Con l’aiuto del framework PyMC è possibile definire modelli complessi, anche con molte migliaia di parametri, mediante una sintassi leggibile e intuitiva. In questo Capitolo useremo PyMC per eseguire l’inferenza su una o due proporzioni binomiali con Markov Chain Monte Carlo.</p>
<section id="il-presidente-trump-e-lidrossiclorochina" class="level2" data-number="21.1"><h2 data-number="21.1" class="anchored" data-anchor-id="il-presidente-trump-e-lidrossiclorochina">
<span class="header-section-number">21.1</span> Il presidente Trump e l’idrossiclorochina</h2>
<p>Per fare un esempio concreto, consideriamo un set di dati reali. Cito dal <em>Washington Post</em> del 7 aprile 2020:</p>
<blockquote class="blockquote">
<p>One of the most bizarre and disturbing aspects of President Trump’s nightly press briefings on the coronavirus pandemic is when he turns into a drug salesman. Like a cable TV pitchman hawking ‘male enhancement’ pills, Trump regularly extols the virtues of taking hydroxychloroquine, a drug used to treat malaria and lupus, as a potential ‘game changer’ that just might cure Covid-19.</p>
</blockquote>
<p>Tralasciamo qui il fatto che il Donald Trump non sia un esperto in questo campo. Esaminiamo invece le evidenze iniziali a supporto dell’ipotesi che l’idrossiclorochina possa essere utile per la cura del Covid-19, ovvero le evidenze che erano disponibili nel momento in cui il Donald Trump ha fatto le affermazioni riportate sopra (in seguito, quest’idea è stata screditata). Tali evidenze sono state fornite da uno studio di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span>. Il disegno sperimentale di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> comprende, tra le altre cose, il confronto tra una condizione sperimentale e una condizione di controllo. Il confronto importante è tra la proporzione di paziente positivi al virus SARS-CoV-2 nel gruppo sperimentale (a cui è stata somministrata l’idrossiclorochina; 6 su 14) e la proporzione di paziente positivi nel gruppo di controllo (a cui non è stata somministrata l’idrossiclorochina; ovvero 14 su 16). Obiettivo di questo capitolo è mostrare come si possa fare inferenza sui dati di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> usando PyMC. Per semplicità, iniziamo considerando solo il gruppo di controllo.</p>
</section><section id="una-proporzione" class="level2" data-number="21.2"><h2 data-number="21.2" class="anchored" data-anchor-id="una-proporzione">
<span class="header-section-number">21.2</span> Una proporzione</h2>
<p>Sulla base di ciò che è stato detto nel <span class="quarto-unresolved-ref">?sec-distr-coniugate</span>, sappiamo che, quando i dati sono rappresentati da una proporzione <span class="math inline">\(\theta\)</span>, e quando utilizziamo una distribuzione a priori Beta per <span class="math inline">\(\theta\)</span>, la distribuzione a posteriori di <span class="math inline">\(\theta\)</span> è specificata dallo schema beta-binomiale. Se scegliamo, ad esempio, una <span class="math inline">\(\mbox{Beta}(2, 2)\)</span> quale distribuzione a priori per <span class="math inline">\(\theta\)</span>, il modello diventa:</p>
<p><span id="eq-beta-binom-trump"><span class="math display">\[
\begin{align}
y &amp;\sim \mbox{Bin}(n, \theta) \notag\\
\theta &amp;\sim \mbox{Beta}(2, 2)
\end{align}
\tag{21.1}\]</span></span></p>
<p>dove la prima riga definisce la funzione di verosimiglianza e la seconda riga definisce la distribuzione a priori.</p>
<p>Per essere chiari, in questo caso particolare non è necessario utilizzare MCMC per stimare il posteriore poiché esiste già una soluzione analitica in forma chiusa. Tuttavia, la maggior parte dei modelli di inferenza bayesiana non ammette una soluzione in forma chiusa per il posteriore e quindi è necessario utilizzare MCMC. In questo esempio, applichiamo MCMC a un caso di cui “conosciamo già la risposta”, in modo da poter confrontare i risultati di una soluzione in forma chiusa e quella calcolata per approssimazione numerica.</p>
</section><section id="dedurre-una-proporzione-binomiale-con-pymc" class="level2" data-number="21.3"><h2 data-number="21.3" class="anchored" data-anchor-id="dedurre-una-proporzione-binomiale-con-pymc">
<span class="header-section-number">21.3</span> Dedurre una proporzione binomiale con PyMC</h2>
<p>Ora eseguiremo la stessa analisi che abbiamo svolto in precedenza utilizzando invece il metodo numerico Markov Chain Monte Carlo. Suppoaniamo di avere già installato PyMC. Una volta installato, dobbiamo successivamente importare le librerie necessarie, che includono Matplotlib, Numpy, Scipy, Arviz e lo stesso PyMC.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">WARNING</span><span class="co"> (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize random number generator</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">8927</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(RANDOM_SEED)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">"arviz-darkgrid"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Running on PyMC v</span><span class="sc">{</span>pm<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running on PyMC v5.0.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vediamo ora come specificare il modello beta-binomiale mediante PyMC. Per svolgere l’analisi mediante PyMC è necessario prima specificare la struttura del modello bayesiano e poi eseguire il campionamento dalla distribuzione a posteriori. Esaminiamo questi due passaggi per l’esempio presente.</p>
</section><section id="dati" class="level2" data-number="21.4"><h2 data-number="21.4" class="anchored" data-anchor-id="dati">
<span class="header-section-number">21.4</span> Dati</h2>
<p>I dati sono i seguenti.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ntrials <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="specificare-il-modello" class="level3" data-number="21.4.1"><h3 data-number="21.4.1" class="anchored" data-anchor-id="specificare-il-modello">
<span class="header-section-number">21.4.1</span> Specificare il modello</h3>
<p>Ora definiamo una distribuzione Beta a priori e il modello di probabilità Binomiale. Questi sono i parametri della distribuzione Beta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="op">=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>PyMC ha un’API molto pulita per eseguire questa operazione. Si usa un <code>context with</code> di Python per assegnare tutti i parametri, le dimensioni dei passaggi e i valori iniziali a un’istanza <code>pymc.Model</code> (che denominiamo <code>bb_model</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bb_model <span class="op">=</span> pm.Model()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prior</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> pm.Beta(<span class="st">"theta"</span>, alpha<span class="op">=</span>alpha_prior, beta<span class="op">=</span>beta_prior)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    obs <span class="op">=</span> pm.Binomial(<span class="st">"obs"</span>, p<span class="op">=</span>theta, n<span class="op">=</span>ntrials, observed<span class="op">=</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La prima linea di codice</p>
<p><code>bb_model = pm.Model()</code></p>
<p>crea un nuovo oggetto di classe <code>Model</code> che è un contenitore per le variabili casuali del modello. Dopo l’istanziazione del modello, la successiva specificazione delle componenti del modello viene eseguita all’interno di un’istruzione <code>with:</code>.</p>
<p>Questo crea un <em>context manager</em>, con il nostro <code>bb_model</code> come contesto, che include tutte le istruzioni fino alla fine del blocco indentato. Ciò significa che tutti gli oggetti PyMC introdotti nel blocco di codice indentato sotto l’istruzione <code>with:</code> vengono aggiunti al modello. In assenza di questo idioma del <em>context manager</em>, saremmo costretti ad associare manualmente ciascuna delle variabili a <code>bb_model</code>.</p>
<p>Con la chiamata del costruttore <code>pm.Beta</code> si crea una variabile casuale da usare come distribuzione a priori. Il primo argomento è sempre il nome della variabile casuale, che dovrebbe corrispondere al nome della variabile Python assegnata, poiché a volte viene utilizzato per recuperare la variabile dal modello per riassumere l’output. I restanti argomenti richiesti per un oggetto stocastico sono i parametri, in questo caso <code>alpha</code> e <code>beta</code>, a cui assegniamo i valori degli iperparametri del modello. Nel caso presente, usiamo i valori <code>alpha_prior</code> e <code>beta_prior</code> come parametri della distribuzione Beta a priori.</p>
<p>La riga finale del modello definisce <code>obs</code>, la distribuzione campionaria della variabile di esito nel set di dati. Questo è un caso speciale di variabile stocastica chiamata <code>observed stochastic</code>, la quale rappresenta la verosimiglianza dei dati del modello. Tale variabile stocastica è identica alle altre variabili stocastiche, tranne per l’argomento <code>obs</code>, il quale indica che i valori per questa variabile sono stati osservati e non devono essere modificati dal modello. I dati possono essere passati sotto forma di oggetto <code>ndarray</code> o <code>DataFrame</code>. Nel caso presente, per la funzione di verosimiglianza Binomiale specificando il parametro <code>p=theta</code>, il numero di prove <code>n=ntrials</code> e il numero di successi <code>observed=y</code>.</p>
<p>Si noti che, a differenza delle distribuzioni a priori del modello, i parametri per la distribuzione Beta di <code>obs</code> non sono valori fissi, ma piuttosto corrispondono all’oggetto stocastico <code>theta</code>. Questo crea una relazione genitore-figlio tra la verosimiglianza e questa variabile.</p>
</section><section id="campionamento" class="level3" data-number="21.4.2"><h3 data-number="21.4.2" class="anchored" data-anchor-id="campionamento">
<span class="header-section-number">21.4.2</span> Campionamento</h3>
<p>Eseguiamo il campionamento MCMC usando l’algoritmo di default (NUTS) e salviamo i risultati nell’oggetto <code>idata</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> pm.NUTS()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    idata <span class="op">=</span> pm.sample(<span class="dv">2000</span>, tune<span class="op">=</span><span class="dv">1000</span>, init<span class="op">=</span><span class="va">None</span>, step<span class="op">=</span>step, chains<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La funzione <code>sample</code> esegue il metod0 <code>step</code> assegnati (o passati) ad essa per il numero specificato di iterazioni e restituisce un oggetto <code>InferenceData</code> contenente i campioni raccolti, insieme ad altri attributi utili come le statistiche dell’esecuzione del campionamento e una copia dei dati osservati. Si noti che <code>sample</code> genera una serie di catene parallele, a seconda del numero di <em>core</em> di calcolo presenti sulla macchina.</p>
<p>Avendo assunto una distribuzione a priori per il parametro <span class="math inline">\(\theta\)</span>, l’algoritmo procede in maniera ciclica, correggendo la distribuzione a priori di <span class="math inline">\(\theta\)</span> condizionandola ai valori già generati. Dopo un certo numero di cicli, necessari per portare l’algoritmo a convergenza, i valori estratti possono essere assunti come campionati dalla distribuzione a posteriori di <span class="math inline">\(\theta\)</span>.</p>
<p>Al crescere del numero di passi della catena, la distribuzione di target viene sempre meglio approssimata. All’inizio del campionamento, però, la distribuzione può essere significativamente lontana da quella stazionaria, e ci vuole un certo tempo prima di raggiungere la distribuzione stazionaria di equilibrio, detto, appunto, periodo di <em>burn-in</em>. I campioni provenienti da tale parte iniziale della catena vanno tipicamente scartati perché possono non rappresentare accuratamente la distribuzione a posteriori.</p>
<p>Il tempo di campionamento dipende dalla velocità del computer a disposizione.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>idata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">


            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
<li class="xr-section-item">
                  <input id="idata_posterior03fe1339-b161-4e7d-b006-7b986b73c138" class="xr-section-summary-in" type="checkbox"><label for="idata_posterior03fe1339-b161-4e7d-b006-7b986b73c138" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
<div style="padding-left:2rem;">
<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:  (chain: 4, draw: 2000)
Coordinates:
  * chain    (chain) int64 0 1 2 3
  * draw     (draw) int64 0 1 2 3 4 5 6 7 ... 1993 1994 1995 1996 1997 1998 1999
Data variables:
    theta    (chain, draw) float64 0.8695 0.6488 0.8435 ... 0.8602 0.8392 0.8555
Attributes:
    created_at:                 2022-12-25T18:56:29.212926
    arviz_version:              0.14.0
    inference_library:          pymc
    inference_library_version:  5.0.0
    sampling_time:              25.65721297264099
    tuning_steps:               1000</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div>
<ul class="xr-sections">
<li class="xr-section-item">
<input id="section-a39d8623-7b10-4a84-9647-124942ed1f5a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-a39d8623-7b10-4a84-9647-124942ed1f5a" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list">
<li>
<span class="xr-has-index">chain</span>: 4</li>
<li>
<span class="xr-has-index">draw</span>: 2000</li>
</ul></div>
<div class="xr-section-details"></div>
</li>
<li class="xr-section-item">
<input id="section-ab59608a-528d-4d87-8e8f-87f9c3765480" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-ab59608a-528d-4d87-8e8f-87f9c3765480" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">chain</span></div>
<div class="xr-var-dims">(chain)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3</div>
<input id="attrs-7b47a806-581d-4c10-afbd-2fefb49b855a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7b47a806-581d-4c10-afbd-2fefb49b855a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-64715791-a53e-4a57-91fe-9e2b44e3dafb" class="xr-var-data-in" type="checkbox"><label for="data-64715791-a53e-4a57-91fe-9e2b44e3dafb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3 4 ... 1996 1997 1998 1999</div>
<input id="attrs-76f41434-55f0-4b68-9a87-76e766ffebb9" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-76f41434-55f0-4b68-9a87-76e766ffebb9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fd81a1c4-a0b4-4eb5-baf8-0aa9a1649189" class="xr-var-data-in" type="checkbox"><label for="data-fd81a1c4-a0b4-4eb5-baf8-0aa9a1649189" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([   0,    1,    2, ..., 1997, 1998, 1999])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-fa305763-b9dd-40cc-9a16-5bda3e14a5a3" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-fa305763-b9dd-40cc-9a16-5bda3e14a5a3" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-var-name"><span>theta</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.8695 0.6488 ... 0.8392 0.8555</div>
<input id="attrs-1f854eb3-7d5e-4f48-94e1-1a2963d0759d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1f854eb3-7d5e-4f48-94e1-1a2963d0759d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3f7e6826-91a4-450a-b43f-844563ef70d3" class="xr-var-data-in" type="checkbox"><label for="data-3f7e6826-91a4-450a-b43f-844563ef70d3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[0.86951671, 0.64882511, 0.84354959, ..., 0.89618671, 0.87468666,
        0.85783466],
       [0.8037465 , 0.84959392, 0.83549033, ..., 0.81380284, 0.60408544,
        0.79434139],
       [0.8466645 , 0.82987998, 0.82987998, ..., 0.81166139, 0.81166139,
        0.79224075],
       [0.92523682, 0.85458494, 0.8712782 , ..., 0.86023867, 0.83923418,
        0.85553832]])</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-0f917323-cc93-4f68-8202-d0b7800d9830" class="xr-section-summary-in" type="checkbox"><label for="section-0f917323-cc93-4f68-8202-d0b7800d9830" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-index-name"><div>chain</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-6d62f10f-3384-4f3e-aa14-1d41a74c4495" class="xr-index-data-in" type="checkbox"><label for="index-6d62f10f-3384-4f3e-aa14-1d41a74c4495" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-index-name"><div>draw</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-235425bf-ab25-42b0-96d0-d711ed4e3cd1" class="xr-index-data-in" type="checkbox"><label for="index-235425bf-ab25-42b0-96d0-d711ed4e3cd1" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
            ...
            1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999],
           dtype='int64', name='draw', length=2000))</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-814d4133-0d7c-4493-93e6-b94baeef4ec3" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-814d4133-0d7c-4493-93e6-b94baeef4ec3" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs">
<dt><span>created_at :</span></dt>
<dd>2022-12-25T18:56:29.212926</dd>
<dt><span>arviz_version :</span></dt>
<dd>0.14.0</dd>
<dt><span>inference_library :</span></dt>
<dd>pymc</dd>
<dt><span>inference_library_version :</span></dt>
<dd>5.0.0</dd>
<dt><span>sampling_time :</span></dt>
<dd>25.65721297264099</dd>
<dt><span>tuning_steps :</span></dt>
<dd>1000</dd>
</dl></div>
</li>
</ul>
</div>
</div>
<br>
</div>
                      </ul>
</div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats271eccc8-536b-47ea-aa2c-8fe15251a6c8" class="xr-section-summary-in" type="checkbox"><label for="idata_sample_stats271eccc8-536b-47ea-aa2c-8fe15251a6c8" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
<div style="padding-left:2rem;">
<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:                (chain: 4, draw: 2000)
Coordinates:
  * chain                  (chain) int64 0 1 2 3
  * draw                   (draw) int64 0 1 2 3 4 5 ... 1995 1996 1997 1998 1999
Data variables: (12/17)
    tree_depth             (chain, draw) int64 2 2 2 2 2 1 2 1 ... 2 1 1 1 1 2 1
    index_in_trajectory    (chain, draw) int64 -2 1 -1 -2 3 -1 ... 1 1 -1 1 -3 1
    step_size              (chain, draw) float64 1.418 1.418 ... 1.481 1.481
    perf_counter_diff      (chain, draw) float64 0.0005073 ... 0.0001781
    process_time_diff      (chain, draw) float64 0.000509 0.00068 ... 0.000179
    reached_max_treedepth  (chain, draw) bool False False False ... False False
    ...                     ...
    energy_error           (chain, draw) float64 0.1204 0.09368 ... 0.03972
    step_size_bar          (chain, draw) float64 1.136 1.136 ... 1.147 1.147
    diverging              (chain, draw) bool False False False ... False False
    n_steps                (chain, draw) float64 3.0 3.0 3.0 3.0 ... 1.0 3.0 1.0
    smallest_eigval        (chain, draw) float64 nan nan nan nan ... nan nan nan
    largest_eigval         (chain, draw) float64 nan nan nan nan ... nan nan nan
Attributes:
    created_at:                 2022-12-25T18:56:29.379488
    arviz_version:              0.14.0
    inference_library:          pymc
    inference_library_version:  5.0.0
    sampling_time:              25.65721297264099
    tuning_steps:               1000</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div>
<ul class="xr-sections">
<li class="xr-section-item">
<input id="section-012d8bc8-5e0e-48b5-82af-9351f7cd5265" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-012d8bc8-5e0e-48b5-82af-9351f7cd5265" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list">
<li>
<span class="xr-has-index">chain</span>: 4</li>
<li>
<span class="xr-has-index">draw</span>: 2000</li>
</ul></div>
<div class="xr-section-details"></div>
</li>
<li class="xr-section-item">
<input id="section-505c5bec-0b55-419a-aebf-599366f591eb" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-505c5bec-0b55-419a-aebf-599366f591eb" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">chain</span></div>
<div class="xr-var-dims">(chain)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3</div>
<input id="attrs-d8c712f4-7052-4b72-850f-90915c86b04c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d8c712f4-7052-4b72-850f-90915c86b04c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6eb2d50e-8a75-4563-af56-fa150d5ea3b1" class="xr-var-data-in" type="checkbox"><label for="data-6eb2d50e-8a75-4563-af56-fa150d5ea3b1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3 4 ... 1996 1997 1998 1999</div>
<input id="attrs-b95ad10c-a380-43a4-8858-a07ed7e6fa3b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b95ad10c-a380-43a4-8858-a07ed7e6fa3b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9feca074-1788-4af1-a3e0-50a61c0dab41" class="xr-var-data-in" type="checkbox"><label for="data-9feca074-1788-4af1-a3e0-50a61c0dab41" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([   0,    1,    2, ..., 1997, 1998, 1999])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-604ebd89-ae8b-4644-ad59-43fa13c5aa72" class="xr-section-summary-in" type="checkbox"><label for="section-604ebd89-ae8b-4644-ad59-43fa13c5aa72" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span>tree_depth</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">2 2 2 2 2 1 2 1 ... 1 2 1 1 1 1 2 1</div>
<input id="attrs-c2c8ebb8-96fa-4bf6-a213-6b20c7efc2e2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c2c8ebb8-96fa-4bf6-a213-6b20c7efc2e2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ef6ce28c-9769-47eb-a667-50ea4b187e76" class="xr-var-data-in" type="checkbox"><label for="data-ef6ce28c-9769-47eb-a667-50ea4b187e76" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[2, 2, 2, ..., 1, 1, 2],
       [2, 2, 1, ..., 2, 1, 2],
       [2, 2, 2, ..., 2, 1, 2],
       [2, 2, 1, ..., 1, 2, 1]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>index_in_trajectory</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">-2 1 -1 -2 3 -1 ... 1 1 -1 1 -3 1</div>
<input id="attrs-62a5818c-7aea-47f5-9536-48f88ba59db0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-62a5818c-7aea-47f5-9536-48f88ba59db0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e6b664ae-feac-47d6-a4e6-a0e3a3c58866" class="xr-var-data-in" type="checkbox"><label for="data-e6b664ae-feac-47d6-a4e6-a0e3a3c58866" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[-2,  1, -1, ...,  0,  1,  2],
       [-3,  2,  1, ..., -1, -1,  1],
       [ 3, -1,  0, ...,  0,  0,  2],
       [-1, -1, -1, ...,  1, -3,  1]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>step_size</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">1.418 1.418 1.418 ... 1.481 1.481</div>
<input id="attrs-03c43aea-f229-497f-a0e3-22e45fc45c60" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-03c43aea-f229-497f-a0e3-22e45fc45c60" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3c8863f6-9c5b-42d4-bc74-20a529a07791" class="xr-var-data-in" type="checkbox"><label for="data-3c8863f6-9c5b-42d4-bc74-20a529a07791" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[1.41844836, 1.41844836, 1.41844836, ..., 1.41844836, 1.41844836,
        1.41844836],
       [1.08687078, 1.08687078, 1.08687078, ..., 1.08687078, 1.08687078,
        1.08687078],
       [1.10501658, 1.10501658, 1.10501658, ..., 1.10501658, 1.10501658,
        1.10501658],
       [1.48061922, 1.48061922, 1.48061922, ..., 1.48061922, 1.48061922,
        1.48061922]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>perf_counter_diff</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.0005073 0.0006793 ... 0.0001781</div>
<input id="attrs-c11ebd11-0a7b-48db-805d-cd7f5456a783" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c11ebd11-0a7b-48db-805d-cd7f5456a783" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2b1decb9-e82e-4e82-bcbb-15829bdee1bf" class="xr-var-data-in" type="checkbox"><label for="data-2b1decb9-e82e-4e82-bcbb-15829bdee1bf" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[0.00050728, 0.00067934, 0.00045754, ..., 0.00041531, 0.00127734,
        0.00091543],
       [0.00046616, 0.0006977 , 0.00051429, ..., 0.00054104, 0.00022674,
        0.00180804],
       [0.00040264, 0.00050438, 0.00043838, ..., 0.00041476, 0.00018004,
        0.00041004],
       [0.00147225, 0.00088158, 0.00033648, ..., 0.000189  , 0.00040626,
        0.00017812]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>process_time_diff</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.000509 0.00068 ... 0.000179</div>
<input id="attrs-0494e887-b1fd-4db8-9e16-a3a2856236a9" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0494e887-b1fd-4db8-9e16-a3a2856236a9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-adff5abd-ab55-4d0a-9e8d-8dc83c84d88b" class="xr-var-data-in" type="checkbox"><label for="data-adff5abd-ab55-4d0a-9e8d-8dc83c84d88b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[0.000509, 0.00068 , 0.000459, ..., 0.000416, 0.000709, 0.000904],
       [0.000468, 0.000699, 0.000493, ..., 0.000541, 0.000227, 0.001806],
       [0.000403, 0.000504, 0.000431, ..., 0.000415, 0.00018 , 0.00041 ],
       [0.001464, 0.000876, 0.000337, ..., 0.00019 , 0.000407, 0.000179]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>reached_max_treedepth</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">bool</div>
<div class="xr-var-preview xr-preview">False False False ... False False</div>
<input id="attrs-2785f325-b95f-48e3-b35d-c913093ca783" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2785f325-b95f-48e3-b35d-c913093ca783" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f6f3b088-17a6-4b91-b216-f2a7227280f9" class="xr-var-data-in" type="checkbox"><label for="data-f6f3b088-17a6-4b91-b216-f2a7227280f9" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>energy</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">3.861 4.896 4.38 ... 3.849 3.68</div>
<input id="attrs-aad4cfea-6da7-4fc3-b713-1b75fcf5bfdc" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-aad4cfea-6da7-4fc3-b713-1b75fcf5bfdc" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-91cb2618-4b17-4d91-b4df-b92a36b31393" class="xr-var-data-in" type="checkbox"><label for="data-91cb2618-4b17-4d91-b4df-b92a36b31393" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[3.86060247, 4.89565224, 4.3798216 , ..., 4.83633384, 4.20730607,
        4.5272714 ],
       [3.51963766, 3.99149015, 3.60009905, ..., 3.79619783, 5.20017172,
        4.21729323],
       [6.22969972, 3.56535874, 4.50394675, ..., 8.95188355, 4.10502918,
        3.5800158 ],
       [5.07971509, 4.6735885 , 3.87433065, ..., 4.19517625, 3.84895017,
        3.68031989]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>lp</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">-3.804 -4.528 ... -3.536 -3.656</div>
<input id="attrs-bf5d8600-8c8c-4e63-8618-f899201faead" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-bf5d8600-8c8c-4e63-8618-f899201faead" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-307e6458-1957-4a98-9fe9-09e3b1171bda" class="xr-var-data-in" type="checkbox"><label for="data-307e6458-1957-4a98-9fe9-09e3b1171bda" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[-3.80387289, -4.52810565, -3.56299895, ..., -4.23509802,
        -3.87073352, -3.67730933],
       [-3.42968287, -3.60636314, -3.51567658, ..., -3.44113991,
        -5.19161029, -3.43077082],
       [-3.58446882, -3.48934023, -3.48934023, ..., -3.43755659,
        -3.43755659, -3.43248937],
       [-5.03775673, -3.64763141, -3.8258591 , ..., -3.70075161,
        -3.53622271, -3.65610308]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>perf_counter_start</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">22.58 22.58 22.58 ... 25.45 25.45</div>
<input id="attrs-e42273b9-2fdb-4f16-9c24-3dfe873e9616" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e42273b9-2fdb-4f16-9c24-3dfe873e9616" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5b42bbe4-829f-4612-9961-787ac15f9e19" class="xr-var-data-in" type="checkbox"><label for="data-5b42bbe4-829f-4612-9961-787ac15f9e19" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[22.57681665, 22.57756253, 22.57841037, ..., 24.25012835,
        24.25072679, 24.25248129],
       [22.63187052, 22.63255365, 22.63349766, ..., 24.34731852,
        24.34799952, 24.34862574],
       [22.67777694, 22.67882133, 22.6794655 , ..., 24.60691059,
        24.60742763, 24.60773108],
       [24.08151454, 24.08324401, 24.08830987, ..., 25.45255442,
        25.4528992 , 25.45340622]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>max_energy_error</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.1204 0.2902 ... -0.07636 0.03972</div>
<input id="attrs-20b1a70f-78d3-41d8-b559-9b665bb20dc5" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-20b1a70f-78d3-41d8-b559-9b665bb20dc5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-74f34625-5d2f-40ef-8159-ea2acb9de0cc" class="xr-var-data-in" type="checkbox"><label for="data-74f34625-5d2f-40ef-8159-ea2acb9de0cc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[ 0.12037173,  0.29023996, -0.29734566, ...,  0.12791345,
        -0.08625121,  0.20649009],
       [-0.08159553,  0.30711497, -0.0354863 , ..., -0.24237558,
         0.95755307, -1.0169511 ],
       [ 1.52377842, -0.06728835,  1.0537009 , ...,  8.37530772,
         0.73482233,  0.13721673],
       [ 0.6923351 , -0.66662469,  0.05400551, ..., -0.18175051,
        -0.0763636 ,  0.03972131]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>acceptance_rate</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.9341 0.8686 1.0 ... 0.9831 0.9611</div>
<input id="attrs-756bc7d6-8cbb-4005-b347-1d97c6834a71" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-756bc7d6-8cbb-4005-b347-1d97c6834a71" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ada2cfd7-1db8-4741-aaea-4fbabc88d7ed" class="xr-var-data-in" type="checkbox"><label for="data-ada2cfd7-1db8-4741-aaea-4fbabc88d7ed" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[0.93410559, 0.86861619, 1.        , ..., 0.87992953, 1.        ,
        0.93781144],
       [1.        , 0.78913902, 1.        , ..., 0.95776949, 0.38383095,
        1.        ],
       [0.35533302, 1.        , 0.58004467, ..., 0.03960974, 0.47959066,
        0.92707708],
       [0.71636403, 0.97099035, 0.94742689, ..., 1.        , 0.98312713,
        0.96105724]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>energy_error</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.1204 0.09368 ... -0.05238 0.03972</div>
<input id="attrs-6632920e-d33d-4a03-83d3-64748d065d66" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6632920e-d33d-4a03-83d3-64748d065d66" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8aa4a3aa-2cf1-4210-998b-923708780839" class="xr-var-data-in" type="checkbox"><label for="data-8aa4a3aa-2cf1-4210-998b-923708780839" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[ 0.12037173,  0.0936844 , -0.29734566, ...,  0.        ,
        -0.08625121, -0.06871986],
       [-0.08159553,  0.11516492, -0.0354863 , ..., -0.2332089 ,
         0.95755307, -1.0169511 ],
       [ 0.51815739, -0.03716843,  0.        , ...,  0.        ,
         0.        , -0.01296016],
       [ 0.43280667, -0.375115  ,  0.05400551, ..., -0.18175051,
        -0.05237942,  0.03972131]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>step_size_bar</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">1.136 1.136 1.136 ... 1.147 1.147</div>
<input id="attrs-e1ab658f-569a-4f5a-afd6-a7609b8ab5c6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e1ab658f-569a-4f5a-afd6-a7609b8ab5c6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0b1edf93-a9bd-4513-a0d8-e9ca2c94bf1c" class="xr-var-data-in" type="checkbox"><label for="data-0b1edf93-a9bd-4513-a0d8-e9ca2c94bf1c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[1.13642119, 1.13642119, 1.13642119, ..., 1.13642119, 1.13642119,
        1.13642119],
       [1.23349991, 1.23349991, 1.23349991, ..., 1.23349991, 1.23349991,
        1.23349991],
       [1.21558058, 1.21558058, 1.21558058, ..., 1.21558058, 1.21558058,
        1.21558058],
       [1.14694372, 1.14694372, 1.14694372, ..., 1.14694372, 1.14694372,
        1.14694372]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>diverging</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">bool</div>
<div class="xr-var-preview xr-preview">False False False ... False False</div>
<input id="attrs-557b7695-5e6e-4f40-aa8d-0084840a64bc" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-557b7695-5e6e-4f40-aa8d-0084840a64bc" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e22d3af8-7c42-4efa-b6ab-94e55d08e194" class="xr-var-data-in" type="checkbox"><label for="data-e22d3af8-7c42-4efa-b6ab-94e55d08e194" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>n_steps</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">3.0 3.0 3.0 3.0 ... 1.0 1.0 3.0 1.0</div>
<input id="attrs-f860aaeb-4c2a-4297-ae90-9ec13f564e37" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f860aaeb-4c2a-4297-ae90-9ec13f564e37" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a5a91684-72b9-41ac-bcc1-076404aa3398" class="xr-var-data-in" type="checkbox"><label for="data-a5a91684-72b9-41ac-bcc1-076404aa3398" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[3., 3., 3., ..., 1., 1., 3.],
       [3., 3., 1., ..., 3., 1., 3.],
       [3., 3., 3., ..., 3., 1., 3.],
       [3., 3., 1., ..., 1., 3., 1.]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>smallest_eigval</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div>
<input id="attrs-805c9395-0e81-480c-a0b9-4dcbbdb3461f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-805c9395-0e81-480c-a0b9-4dcbbdb3461f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b0f4e3b2-1ee4-4139-bd53-08aa01ee540c" class="xr-var-data-in" type="checkbox"><label for="data-b0f4e3b2-1ee4-4139-bd53-08aa01ee540c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>largest_eigval</span></div>
<div class="xr-var-dims">(chain, draw)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div>
<input id="attrs-494ff5f5-7e9f-421f-b048-9c768b894ba6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-494ff5f5-7e9f-421f-b048-9c768b894ba6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c5095004-df0b-477c-968b-41042e0fc4f2" class="xr-var-data-in" type="checkbox"><label for="data-c5095004-df0b-477c-968b-41042e0fc4f2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-cbcce076-604a-4b58-bf85-054e12d3a95b" class="xr-section-summary-in" type="checkbox"><label for="section-cbcce076-604a-4b58-bf85-054e12d3a95b" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-index-name"><div>chain</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-58f5e138-df59-4382-a74b-baad0fea0247" class="xr-index-data-in" type="checkbox"><label for="index-58f5e138-df59-4382-a74b-baad0fea0247" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-index-name"><div>draw</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-4000fc08-d139-4558-a8e2-60c2d3088f5d" class="xr-index-data-in" type="checkbox"><label for="index-4000fc08-d139-4558-a8e2-60c2d3088f5d" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
            ...
            1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999],
           dtype='int64', name='draw', length=2000))</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-2f97688a-7cf2-4644-b860-838cec95eb06" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2f97688a-7cf2-4644-b860-838cec95eb06" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs">
<dt><span>created_at :</span></dt>
<dd>2022-12-25T18:56:29.379488</dd>
<dt><span>arviz_version :</span></dt>
<dd>0.14.0</dd>
<dt><span>inference_library :</span></dt>
<dd>pymc</dd>
<dt><span>inference_library_version :</span></dt>
<dd>5.0.0</dd>
<dt><span>sampling_time :</span></dt>
<dd>25.65721297264099</dd>
<dt><span>tuning_steps :</span></dt>
<dd>1000</dd>
</dl></div>
</li>
</ul>
</div>
</div>
<br>
</div>
                      </ul>
</div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_datac4303ced-f7b0-4f1e-8614-5d3fde60e7a3" class="xr-section-summary-in" type="checkbox"><label for="idata_observed_datac4303ced-f7b0-4f1e-8614-5d3fde60e7a3" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
<div style="padding-left:2rem;">
<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:    (obs_dim_0: 1)
Coordinates:
  * obs_dim_0  (obs_dim_0) int64 0
Data variables:
    obs        (obs_dim_0) int64 14
Attributes:
    created_at:                 2022-12-25T18:56:29.437655
    arviz_version:              0.14.0
    inference_library:          pymc
    inference_library_version:  5.0.0</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div>
<ul class="xr-sections">
<li class="xr-section-item">
<input id="section-1fc55dd7-7dd1-4e0a-be42-40ca9ed93d13" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-1fc55dd7-7dd1-4e0a-be42-40ca9ed93d13" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li>
<span class="xr-has-index">obs_dim_0</span>: 1</li></ul></div>
<div class="xr-section-details"></div>
</li>
<li class="xr-section-item">
<input id="section-334854ee-2dbd-4459-9ce5-264cacda232f" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-334854ee-2dbd-4459-9ce5-264cacda232f" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">obs_dim_0</span></div>
<div class="xr-var-dims">(obs_dim_0)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0</div>
<input id="attrs-1f9dd366-3ec7-4cd3-a6f7-39b2116ee534" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1f9dd366-3ec7-4cd3-a6f7-39b2116ee534" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c9110bc8-b3b2-4d77-a155-164b8fb6f4c4" class="xr-var-data-in" type="checkbox"><label for="data-c9110bc8-b3b2-4d77-a155-164b8fb6f4c4" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0])</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-dbbc26c4-97ee-418f-b17f-ea2c0d4713a9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-dbbc26c4-97ee-418f-b17f-ea2c0d4713a9" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-var-name"><span>obs</span></div>
<div class="xr-var-dims">(obs_dim_0)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">14</div>
<input id="attrs-954171e4-b0fd-474b-860b-24e095a72f74" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-954171e4-b0fd-474b-860b-24e095a72f74" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ead82ee5-20bc-4ae7-8352-76c26bf1d39d" class="xr-var-data-in" type="checkbox"><label for="data-ead82ee5-20bc-4ae7-8352-76c26bf1d39d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([14])</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-fff76613-b741-4754-841a-8b9a25c2a39e" class="xr-section-summary-in" type="checkbox"><label for="section-fff76613-b741-4754-841a-8b9a25c2a39e" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-index-name"><div>obs_dim_0</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-2eceab76-b912-4efe-9a5b-e82b815e7e65" class="xr-index-data-in" type="checkbox"><label for="index-2eceab76-b912-4efe-9a5b-e82b815e7e65" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([0], dtype='int64', name='obs_dim_0'))</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-6d00a614-8862-4bb1-86e2-793623aec5b2" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-6d00a614-8862-4bb1-86e2-793623aec5b2" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs">
<dt><span>created_at :</span></dt>
<dd>2022-12-25T18:56:29.437655</dd>
<dt><span>arviz_version :</span></dt>
<dd>0.14.0</dd>
<dt><span>inference_library :</span></dt>
<dd>pymc</dd>
<dt><span>inference_library_version :</span></dt>
<dd>5.0.0</dd>
</dl></div>
</li>
</ul>
</div>
</div>
<br>
</div>
                      </ul>
</div>
            </li>
            
              </ul>
</div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<p>I vari attributi dell’oggetto <code>InferenceData</code> possono essere estratti come nel caso di un <code>dict</code> contenente coppie composte da una chiave e un valore separati tra loro dal simbolo dei due punti. In questo caso le chiavi sono i nomi delle variabili e i valori sono dei <code>numpy.arrays</code>. Ad esempio, possiamo recuperare la traccia di campionamento dalla variabile latente <code>theta</code> nel modo seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' (chain: 4, draw: 2000)&gt;
array([[0.86951671, 0.64882511, 0.84354959, ..., 0.89618671, 0.87468666,
        0.85783466],
       [0.8037465 , 0.84959392, 0.83549033, ..., 0.81380284, 0.60408544,
        0.79434139],
       [0.8466645 , 0.82987998, 0.82987998, ..., 0.81166139, 0.81166139,
        0.79224075],
       [0.92523682, 0.85458494, 0.8712782 , ..., 0.86023867, 0.83923418,
        0.85553832]])
Coordinates:
  * chain    (chain) int64 0 1 2 3
  * draw     (draw) int64 0 1 2 3 4 5 6 7 ... 1993 1994 1995 1996 1997 1998 1999</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
<ul class="xr-dim-list">
<li>
<span class="xr-has-index">chain</span>: 4</li>
<li>
<span class="xr-has-index">draw</span>: 2000</li>
</ul>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-679cab48-e9b1-4f50-a174-d066028607db" class="xr-array-in" type="checkbox" checked=""><label for="section-679cab48-e9b1-4f50-a174-d066028607db" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.8695 0.6488 0.8435 0.8548 0.8178 ... 0.9021 0.8602 0.8392 0.8555</span></div>
<div class="xr-array-data"><pre>array([[0.86951671, 0.64882511, 0.84354959, ..., 0.89618671, 0.87468666,
        0.85783466],
       [0.8037465 , 0.84959392, 0.83549033, ..., 0.81380284, 0.60408544,
        0.79434139],
       [0.8466645 , 0.82987998, 0.82987998, ..., 0.81166139, 0.81166139,
        0.79224075],
       [0.92523682, 0.85458494, 0.8712782 , ..., 0.86023867, 0.83923418,
        0.85553832]])</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-be02dc54-83cc-4bcf-86b3-bf13e1b34e57" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-be02dc54-83cc-4bcf-86b3-bf13e1b34e57" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">chain</span></div>
<div class="xr-var-dims">(chain)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3</div>
<input id="attrs-0384b912-d302-475c-9de3-66249464d0b8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0384b912-d302-475c-9de3-66249464d0b8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-44fd64ea-1201-4ccf-a5d7-f19d31bd7b8e" class="xr-var-data-in" type="checkbox"><label for="data-44fd64ea-1201-4ccf-a5d7-f19d31bd7b8e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3 4 ... 1996 1997 1998 1999</div>
<input id="attrs-2a920095-64ef-4e0a-baf7-0d8d7b5c866d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2a920095-64ef-4e0a-baf7-0d8d7b5c866d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3a3011d7-842e-483a-8cb4-f6d085c19eeb" class="xr-var-data-in" type="checkbox"><label for="data-3a3011d7-842e-483a-8cb4-f6d085c19eeb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([   0,    1,    2, ..., 1997, 1998, 1999])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-15957926-c104-4b47-b407-ac693e99cdab" class="xr-section-summary-in" type="checkbox"><label for="section-15957926-c104-4b47-b407-ac693e99cdab" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-index-name"><div>chain</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-4a9e1397-d56f-4d1e-bb09-aa56069995fb" class="xr-index-data-in" type="checkbox"><label for="index-4a9e1397-d56f-4d1e-bb09-aa56069995fb" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-index-name"><div>draw</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-8e53d58b-d47e-49a8-ab9e-4fa773d7602a" class="xr-index-data-in" type="checkbox"><label for="index-8e53d58b-d47e-49a8-ab9e-4fa773d7602a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
            ...
            1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999],
           dtype='int64', name='draw', length=2000))</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-4b70c204-e415-49b5-bccf-ef6a530c6cf8" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-4b70c204-e415-49b5-bccf-ef6a530c6cf8" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>Si noti che l’oggetto ritornato è un array</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>].shape</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (4, 2000)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>di dimensioni 4 <span class="math inline">\(\times\)</span> 2000 (sul mio computer). Per visualizzare il primi 10 valori della prima catena, ad esempio, usiamo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>][<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' (draw: 9)&gt;
array([0.64882511, 0.84354959, 0.85483656, 0.81775747, 0.83112152,
       0.74965034, 0.75161838, 0.82022147, 0.83173034])
Coordinates:
    chain    int64 0
  * draw     (draw) int64 1 2 3 4 5 6 7 8 9</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
<ul class="xr-dim-list"><li>
<span class="xr-has-index">draw</span>: 9</li></ul>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-e6b8f26c-e319-43be-a846-c25978060d8a" class="xr-array-in" type="checkbox" checked=""><label for="section-e6b8f26c-e319-43be-a846-c25978060d8a" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.6488 0.8435 0.8548 0.8178 0.8311 0.7497 0.7516 0.8202 0.8317</span></div>
<div class="xr-array-data"><pre>array([0.64882511, 0.84354959, 0.85483656, 0.81775747, 0.83112152,
       0.74965034, 0.75161838, 0.82022147, 0.83173034])</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-d8b887e0-5cbf-451d-830e-de43b0eb132d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-d8b887e0-5cbf-451d-830e-de43b0eb132d" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span>chain</span></div>
<div class="xr-var-dims">()</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0</div>
<input id="attrs-6cbdfb04-69a4-4c9f-9ae3-ad9734b48d45" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6cbdfb04-69a4-4c9f-9ae3-ad9734b48d45" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-94bfef7b-42c8-41ce-ae57-75c9ed1053c7" class="xr-var-data-in" type="checkbox"><label for="data-94bfef7b-42c8-41ce-ae57-75c9ed1053c7" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array(0)</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(draw)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">1 2 3 4 5 6 7 8 9</div>
<input id="attrs-0829a334-d9a1-4f44-a16d-a16ca822bec7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0829a334-d9a1-4f44-a16d-a16ca822bec7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9351b392-f243-4389-8d62-453e7e7123bc" class="xr-var-data-in" type="checkbox"><label for="data-9351b392-f243-4389-8d62-453e7e7123bc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-92e70cc8-dd65-4e07-bb25-2dd7f2ce4e7a" class="xr-section-summary-in" type="checkbox"><label for="section-92e70cc8-dd65-4e07-bb25-2dd7f2ce4e7a" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-index-name"><div>draw</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-832702ca-06a8-4334-89f9-ca4c460abef7" class="xr-index-data-in" type="checkbox"><label for="index-832702ca-06a8-4334-89f9-ca4c460abef7" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Int64Index([1, 2, 3, 4, 5, 6, 7, 8, 9], dtype='int64', name='draw'))</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-207ab9e5-f97d-4a68-9dc0-327f8c8bde0e" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-207ab9e5-f97d-4a68-9dc0-327f8c8bde0e" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>Se volessimo utilizzare l’algoritmo di campionamento Metropolis invece di NUTS (che è stato assegnato di default), possiamo specificare questo come argomento <code>step</code> per <code>sample</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instantiate sampler</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> pm.Metropolis()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw 5000 posterior samples</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    metropolis_idata <span class="op">=</span> pm.sample(<span class="dv">5000</span>, step<span class="op">=</span>step)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; █</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a> <span class="op">|----------------------------------------|</span> <span class="fl">0.00</span><span class="op">%</span> [<span class="dv">0</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span>? Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a> <span class="op">|------------------------------------|</span> <span class="fl">0.00</span><span class="op">%</span> [<span class="dv">1</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">21</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a> <span class="op">|------------------------------------|</span> <span class="fl">0.01</span><span class="op">%</span> [<span class="dv">2</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">14</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a> <span class="op">|------------------------------------|</span> <span class="fl">0.01</span><span class="op">%</span> [<span class="dv">3</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">11</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a> <span class="op">|------------------------------------|</span> <span class="fl">0.02</span><span class="op">%</span> [<span class="dv">4</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">9</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a> <span class="op">|------------------------------------|</span> <span class="fl">0.02</span><span class="op">%</span> [<span class="dv">5</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">8</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a> <span class="op">|----------------------------------|</span> <span class="fl">2.39</span><span class="op">%</span> [<span class="dv">574</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>███<span class="op">------------------------------|</span> <span class="fl">9.87</span><span class="op">%</span> [<span class="dv">2369</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>█████<span class="op">---------------------------|</span> <span class="fl">17.05</span><span class="op">%</span> [<span class="dv">4091</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>███████<span class="op">-------------------------|</span> <span class="fl">24.48</span><span class="op">%</span> [<span class="dv">5876</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>██████████<span class="op">----------------------|</span> <span class="fl">32.28</span><span class="op">%</span> [<span class="dv">7748</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>████████████<span class="op">--------------------|</span> <span class="fl">40.30</span><span class="op">%</span> [<span class="dv">9671</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">00</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>███████████████<span class="op">----------------|</span> <span class="fl">48.46</span><span class="op">%</span> [<span class="dv">11631</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>█████████████████<span class="op">--------------|</span> <span class="fl">56.63</span><span class="op">%</span> [<span class="dv">13592</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>████████████████████<span class="op">-----------|</span> <span class="fl">64.94</span><span class="op">%</span> [<span class="dv">15585</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>██████████████████████<span class="op">---------|</span> <span class="fl">73.19</span><span class="op">%</span> [<span class="dv">17566</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>█████████████████████████<span class="op">------|</span> <span class="fl">81.37</span><span class="op">%</span> [<span class="dv">19529</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>███████████████████████████<span class="op">----|</span> <span class="fl">89.51</span><span class="op">%</span> [<span class="dv">21483</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>██████████████████████████████<span class="op">-|</span> <span class="fl">97.40</span><span class="op">%</span> [<span class="dv">23377</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>██████████████████████████████<span class="op">|</span> <span class="fl">100.00</span><span class="op">%</span> [<span class="dv">24000</span><span class="op">/</span><span class="dv">24000</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span><span class="op">&lt;</span><span class="dv">00</span>:<span class="dv">00</span> Sampling <span class="dv">4</span> chains, <span class="dv">0</span> divergences]</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiprocess sampling (4 chains in 4 jobs)</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Metropolis: [theta]</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sampling 4 chains for 1_000 tune and 5_000 draw iterations (4_000 + 20_000 draws total) took 23 seconds.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="analisi-a-posteriori" class="level3" data-number="21.4.3"><h3 data-number="21.4.3" class="anchored" data-anchor-id="analisi-a-posteriori">
<span class="header-section-number">21.4.3</span> Analisi a posteriori</h3>
<p>Esaminiamo l’accettanza.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    idata, group<span class="op">=</span><span class="st">"sample_stats"</span>, var_names<span class="op">=</span><span class="st">"acceptance_rate"</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    hdi_prob<span class="op">=</span><span class="st">"hide"</span>, kind<span class="op">=</span><span class="st">"hist"</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="040_beta_binomial_mod_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="691"></p>
</figure>
</div>
</div>
</div>
<p>Estraiamo le stime a posteriori di <span class="math inline">\(\theta\)</span> da <code>idata</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>posterior <span class="op">=</span> az.extract(idata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le stime a posteriori di <span class="math inline">\(\theta\)</span> sono accessibili nel modo seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' (sample: 8000)&gt;
array([0.86951671, 0.64882511, 0.84354959, ..., 0.86023867, 0.83923418,
       0.85553832])
Coordinates:
  * sample   (sample) object MultiIndex
  * chain    (sample) int64 0 0 0 0 0 0 0 0 0 0 0 0 ... 3 3 3 3 3 3 3 3 3 3 3 3
  * draw     (sample) int64 0 1 2 3 4 5 6 ... 1993 1994 1995 1996 1997 1998 1999</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
<ul class="xr-dim-list"><li>
<span class="xr-has-index">sample</span>: 8000</li></ul>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-44b3de2b-f42c-4365-b32f-0e1042541334" class="xr-array-in" type="checkbox" checked=""><label for="section-44b3de2b-f42c-4365-b32f-0e1042541334" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.8695 0.6488 0.8435 0.8548 0.8178 ... 0.9021 0.8602 0.8392 0.8555</span></div>
<div class="xr-array-data"><pre>array([0.86951671, 0.64882511, 0.84354959, ..., 0.86023867, 0.83923418,
       0.85553832])</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-82569536-c1cd-4532-8398-fd1124367ef9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-82569536-c1cd-4532-8398-fd1124367ef9" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">sample</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">object</div>
<div class="xr-var-preview xr-preview">MultiIndex</div>
<input id="attrs-d69f0fa2-4f39-4298-afac-81706271032b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d69f0fa2-4f39-4298-afac-81706271032b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-beec54da-347c-42b7-a571-8ec890700836" class="xr-var-data-in" type="checkbox"><label for="data-beec54da-347c-42b7-a571-8ec890700836" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([(0, 0), (0, 1), (0, 2), ..., (3, 1997), (3, 1998), (3, 1999)],
      dtype=object)</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">chain</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 0 0 0 0 0 0 0 ... 3 3 3 3 3 3 3 3</div>
<input id="attrs-9ca39b5e-45d7-4c89-a252-68423238e6c9" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9ca39b5e-45d7-4c89-a252-68423238e6c9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-98d69c22-3bb6-4af0-9c8e-1b6acd8ede1a" class="xr-var-data-in" type="checkbox"><label for="data-98d69c22-3bb6-4af0-9c8e-1b6acd8ede1a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0, 0, 0, ..., 3, 3, 3])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">0 1 2 3 4 ... 1996 1997 1998 1999</div>
<input id="attrs-9d7aca08-9fe3-419a-af79-4de690db5e5d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9d7aca08-9fe3-419a-af79-4de690db5e5d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e2f739ac-d1c8-4cca-94a5-10994280b7a9" class="xr-var-data-in" type="checkbox"><label for="data-e2f739ac-d1c8-4cca-94a5-10994280b7a9" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([   0,    1,    2, ..., 1997, 1998, 1999])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-c873af41-cfac-4243-b716-d72774871132" class="xr-section-summary-in" type="checkbox"><label for="section-c873af41-cfac-4243-b716-d72774871132" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-index-name"><div>sample<br>chain<br>draw</div></div>
<div class="xr-index-preview">PandasMultiIndex</div>
<div></div>
<input id="index-e02eaac6-792b-4bd7-8252-a9084cebe19b" class="xr-index-data-in" type="checkbox"><label for="index-e02eaac6-792b-4bd7-8252-a9084cebe19b" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(MultiIndex([(0,    0),
            (0,    1),
            (0,    2),
            (0,    3),
            (0,    4),
            (0,    5),
            (0,    6),
            (0,    7),
            (0,    8),
            (0,    9),
            ...
            (3, 1990),
            (3, 1991),
            (3, 1992),
            (3, 1993),
            (3, 1994),
            (3, 1995),
            (3, 1996),
            (3, 1997),
            (3, 1998),
            (3, 1999)],
           name='sample', length=8000))</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-1080d299-d3a1-43e9-b248-0956c356d32f" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-1080d299-d3a1-43e9-b248-0956c356d32f" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>Dato che <code>posterior['theta']</code> è una lista, possiamo facilmente calcolare la media a posteriori</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' ()&gt;
array(0.79881417)</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-9a0f0cb4-9972-42e4-9cff-243714dbde69" class="xr-array-in" type="checkbox" checked=""><label for="section-9a0f0cb4-9972-42e4-9cff-243714dbde69" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.7988</span></div>
<div class="xr-array-data"><pre>array(0.79881417)</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-3d49acf8-c464-4113-8dad-3b861bb5682a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-3d49acf8-c464-4113-8dad-3b861bb5682a" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-6be2b7ac-f5f8-47e1-bc73-ceaca4a8ffcf" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-6be2b7ac-f5f8-47e1-bc73-ceaca4a8ffcf" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-d98b09cd-4e85-4de7-9b4e-239f77dadbfe" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-d98b09cd-4e85-4de7-9b4e-239f77dadbfe" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>oppure la mediana a posteriori di <span class="math inline">\(\theta\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>].median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' ()&gt;
array(0.80980692)</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-d1cb5aeb-ef57-40b1-aa98-e57d83466a55" class="xr-array-in" type="checkbox" checked=""><label for="section-d1cb5aeb-ef57-40b1-aa98-e57d83466a55" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.8098</span></div>
<div class="xr-array-data"><pre>array(0.80980692)</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-b7b45566-ab3b-40a0-9594-8f444909b5ba" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-b7b45566-ab3b-40a0-9594-8f444909b5ba" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-2bc55f25-ca6e-40fe-9afb-aeb65fca1d8f" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-2bc55f25-ca6e-40fe-9afb-aeb65fca1d8f" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-2dda2389-ee4d-48d4-89e3-249de00a8ead" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-2dda2389-ee4d-48d4-89e3-249de00a8ead" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>La deviazione standard della stima a posteriori è</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>np.std(posterior[<span class="st">'theta'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' ()&gt;
array(0.08843198)</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-6b03d022-6283-4922-8b50-19c218a16a4b" class="xr-array-in" type="checkbox" checked=""><label for="section-6b03d022-6283-4922-8b50-19c218a16a4b" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.08843</span></div>
<div class="xr-array-data"><pre>array(0.08843198)</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-21c45d13-82c9-439b-a165-fcb7a9dee30d" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-21c45d13-82c9-439b-a165-fcb7a9dee30d" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-e11bab96-ab62-4a7a-972c-7a7f6d25b143" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-e11bab96-ab62-4a7a-972c-7a7f6d25b143" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"></ul></div>
</li>
<li class="xr-section-item">
<input id="section-1ba79f98-0abd-4c32-bd8f-97edcaed8a6a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-1ba79f98-0abd-4c32-bd8f-97edcaed8a6a" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>Per semplicità, salvo le stime a posteriori di <span class="math inline">\(\theta\)</span> in un array.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p_post <span class="op">=</span> posterior[<span class="st">'theta'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possiamo ora fare inferenza usando i risultati ottenuti. Un sommario della distribuzione a posteriori si ottiene con il metodo <code>az.summary()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>az.summary(idata, hdi_prob<span class="op">=</span><span class="fl">.95</span>, round_to<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         mean     sd  hdi_2.5%  hdi_97.5%  ...  mcse_sd  ess_bulk  ess_tail  r_hat</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta  0.799  0.088     0.613      0.944  ...    0.001  3270.123  4321.646  1.001</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1 rows x 9 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si ottiene così l’intervallo di credibilità a densità posteriori più alta al 95%. Questo intervallo ci informa sul fatto che, a posteriori, possiamo essere certi al 95% che il vero valore del parametro <span class="math inline">\(\theta\)</span> sia contenuto nell’intervallo [0.625, 0.95].</p>
<p>L’output grafico dell’analisi è riportato nel grafico seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior: Beta(alpha + y, beta + n - y)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>alpha_post <span class="op">=</span> alpha_prior <span class="op">+</span> y</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>beta_post <span class="op">=</span> beta_prior <span class="op">+</span> ntrials <span class="op">-</span> y</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.hist(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    p_post,bins<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    histtype<span class="op">=</span><span class="st">"step"</span>,  density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"A posteriori (MCMC)"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the analytic prior and posterior beta distributions</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (array([0.01012752, 0.        , 0.        , 0.        , 0.01012752,</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.03038256, 0.        , 0.0506376 , 0.01012752, 0.01012752,</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.0506376 , 0.12153025, 0.07089265, 0.19242289, 0.18229537,</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.23293298, 0.25318802, 0.36459075, 0.52663108, 0.54688612,</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.78994662, 0.99249703, 0.8810943 , 0.93173191, 1.23555753,</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        1.64065836, 1.56976572, 2.04575919, 2.4407325 , 2.63315539,</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        3.19016903, 3.26106168, 3.39271945, 4.01049821, 4.22317615,</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        4.48649169, 4.42572657, 4.64853202, 4.49661921, 4.59789442,</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        4.60802194, 3.95986061, 3.63577995, 3.11927639, 2.36983985,</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        2.15716192, 1.3165777 , 0.73930901, 0.39497331, 0.16204033]), array([0.36491483, 0.37725743, 0.38960004, 0.40194264, 0.41428525,</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.42662786, 0.43897046, 0.45131307, 0.46365568, 0.47599828,</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.48834089, 0.50068349, 0.5130261 , 0.52536871, 0.53771131,</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.55005392, 0.56239652, 0.57473913, 0.58708174, 0.59942434,</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.61176695, 0.62410956, 0.63645216, 0.64879477, 0.66113737,</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.67347998, 0.68582259, 0.69816519, 0.7105078 , 0.72285041,</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.73519301, 0.74753562, 0.75987822, 0.77222083, 0.78456344,</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.79690604, 0.80924865, 0.82159125, 0.83393386, 0.84627647,</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.85861907, 0.87096168, 0.88330429, 0.89564689, 0.9079895 ,</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.9203321 , 0.93267471, 0.94501732, 0.95735992, 0.96970253,</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        0.98204513]), [&lt;matplotlib.patches.Polygon object at 0x7f86f7f59250&gt;])</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    x, beta.pdf(x, alpha_prior, beta_prior),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"--"</span>, label<span class="op">=</span><span class="st">"A priori"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    x, beta.pdf(x, alpha_post, beta_post),</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">'A posteriori (analitico)'</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the graph labels</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">" "</span>, loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"$</span><span class="ch">\\</span><span class="st">theta$, Proporzione di successi"</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Densità"</span>)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="040_beta_binomial_mod_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="691"></p>
</figure>
</div>
</div>
</div>
<p>In questo esempio, con 8,000 campioni, la convergenza dell’algoritmo NUTS è estremamente buona. L’istogramma segue da vicino la distribuzione a posteriori calcolata analiticamente, come da previsione.</p>
<p>Stampo ora i valori degli ultimi 100 campioni prodotti dalla procedura di campionamento MCMC.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p_post[<span class="dv">7900</span>:<span class="dv">8000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'theta' (sample: 100)&gt;
array([0.78291368, 0.635318  , 0.90079102, 0.9527642 , 0.91895939,
       0.83809953, 0.83809953, 0.83809953, 0.82097281, 0.71433839,
       0.55603502, 0.82401471, 0.88063895, 0.90004587, 0.67487203,
       0.79651122, 0.79695392, 0.79695392, 0.8336354 , 0.78380914,
       0.78380914, 0.74502667, 0.74502667, 0.71440897, 0.80882704,
       0.7142274 , 0.67552465, 0.67552465, 0.71108785, 0.71108785,
       0.68690276, 0.6801109 , 0.6801109 , 0.67441729, 0.67441729,
       0.6960659 , 0.60100002, 0.64518167, 0.6646095 , 0.75603004,
       0.75603004, 0.80560075, 0.80560075, 0.80560075, 0.8159968 ,
       0.74090978, 0.60705857, 0.73363401, 0.73363401, 0.80260718,
       0.78597697, 0.62498912, 0.74572624, 0.7720489 , 0.75578296,
       0.73047299, 0.76896192, 0.65362995, 0.8991541 , 0.85487943,
       0.8473736 , 0.8473736 , 0.83724939, 0.60891856, 0.65280155,
       0.77994148, 0.81384115, 0.81384115, 0.81384115, 0.83846162,
       0.81499774, 0.91710851, 0.82943143, 0.81689372, 0.69992281,
       0.68596526, 0.80359268, 0.73534436, 0.95458083, 0.77695596,
       0.74221587, 0.77128581, 0.71748514, 0.66736141, 0.66736141,
       0.84523639, 0.78230033, 0.77585799, 0.77585799, 0.84251062,
       0.82824856, 0.77951242, 0.75072101, 0.83386867, 0.84585095,
       0.85051342, 0.90205143, 0.86023867, 0.83923418, 0.85553832])
Coordinates:
  * sample   (sample) object MultiIndex
  * chain    (sample) int64 3 3 3 3 3 3 3 3 3 3 3 3 ... 3 3 3 3 3 3 3 3 3 3 3 3
  * draw     (sample) int64 1900 1901 1902 1903 1904 ... 1996 1997 1998 1999</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header">
<div class="xr-obj-type">xarray.DataArray</div>
<div class="xr-array-name">'theta'</div>
<ul class="xr-dim-list"><li>
<span class="xr-has-index">sample</span>: 100</li></ul>
</div>
<ul class="xr-sections">
<li class="xr-section-item"><div class="xr-array-wrap">
<input id="section-76de753b-b8fe-4e8b-a36c-9a2ff1b493e4" class="xr-array-in" type="checkbox" checked=""><label for="section-76de753b-b8fe-4e8b-a36c-9a2ff1b493e4" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.7829 0.6353 0.9008 0.9528 0.919 ... 0.9021 0.8602 0.8392 0.8555</span></div>
<div class="xr-array-data"><pre>array([0.78291368, 0.635318  , 0.90079102, 0.9527642 , 0.91895939,
       0.83809953, 0.83809953, 0.83809953, 0.82097281, 0.71433839,
       0.55603502, 0.82401471, 0.88063895, 0.90004587, 0.67487203,
       0.79651122, 0.79695392, 0.79695392, 0.8336354 , 0.78380914,
       0.78380914, 0.74502667, 0.74502667, 0.71440897, 0.80882704,
       0.7142274 , 0.67552465, 0.67552465, 0.71108785, 0.71108785,
       0.68690276, 0.6801109 , 0.6801109 , 0.67441729, 0.67441729,
       0.6960659 , 0.60100002, 0.64518167, 0.6646095 , 0.75603004,
       0.75603004, 0.80560075, 0.80560075, 0.80560075, 0.8159968 ,
       0.74090978, 0.60705857, 0.73363401, 0.73363401, 0.80260718,
       0.78597697, 0.62498912, 0.74572624, 0.7720489 , 0.75578296,
       0.73047299, 0.76896192, 0.65362995, 0.8991541 , 0.85487943,
       0.8473736 , 0.8473736 , 0.83724939, 0.60891856, 0.65280155,
       0.77994148, 0.81384115, 0.81384115, 0.81384115, 0.83846162,
       0.81499774, 0.91710851, 0.82943143, 0.81689372, 0.69992281,
       0.68596526, 0.80359268, 0.73534436, 0.95458083, 0.77695596,
       0.74221587, 0.77128581, 0.71748514, 0.66736141, 0.66736141,
       0.84523639, 0.78230033, 0.77585799, 0.77585799, 0.84251062,
       0.82824856, 0.77951242, 0.75072101, 0.83386867, 0.84585095,
       0.85051342, 0.90205143, 0.86023867, 0.83923418, 0.85553832])</pre></div>
</div></li>
<li class="xr-section-item">
<input id="section-0dbd3932-a7be-4cc1-9d9b-0939901888fe" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-0dbd3932-a7be-4cc1-9d9b-0939901888fe" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">sample</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">object</div>
<div class="xr-var-preview xr-preview">MultiIndex</div>
<input id="attrs-9c102fdc-ef7c-46bf-a7c0-380525217dd5" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9c102fdc-ef7c-46bf-a7c0-380525217dd5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a2a756cb-90cc-4c72-9d5d-0bd010773604" class="xr-var-data-in" type="checkbox"><label for="data-a2a756cb-90cc-4c72-9d5d-0bd010773604" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([(3, 1900), (3, 1901), (3, 1902), (3, 1903), (3, 1904), (3, 1905),
       (3, 1906), (3, 1907), (3, 1908), (3, 1909), (3, 1910), (3, 1911),
       (3, 1912), (3, 1913), (3, 1914), (3, 1915), (3, 1916), (3, 1917),
       (3, 1918), (3, 1919), (3, 1920), (3, 1921), (3, 1922), (3, 1923),
       (3, 1924), (3, 1925), (3, 1926), (3, 1927), (3, 1928), (3, 1929),
       (3, 1930), (3, 1931), (3, 1932), (3, 1933), (3, 1934), (3, 1935),
       (3, 1936), (3, 1937), (3, 1938), (3, 1939), (3, 1940), (3, 1941),
       (3, 1942), (3, 1943), (3, 1944), (3, 1945), (3, 1946), (3, 1947),
       (3, 1948), (3, 1949), (3, 1950), (3, 1951), (3, 1952), (3, 1953),
       (3, 1954), (3, 1955), (3, 1956), (3, 1957), (3, 1958), (3, 1959),
       (3, 1960), (3, 1961), (3, 1962), (3, 1963), (3, 1964), (3, 1965),
       (3, 1966), (3, 1967), (3, 1968), (3, 1969), (3, 1970), (3, 1971),
       (3, 1972), (3, 1973), (3, 1974), (3, 1975), (3, 1976), (3, 1977),
       (3, 1978), (3, 1979), (3, 1980), (3, 1981), (3, 1982), (3, 1983),
       (3, 1984), (3, 1985), (3, 1986), (3, 1987), (3, 1988), (3, 1989),
       (3, 1990), (3, 1991), (3, 1992), (3, 1993), (3, 1994), (3, 1995),
       (3, 1996), (3, 1997), (3, 1998), (3, 1999)], dtype=object)</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">chain</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">3 3 3 3 3 3 3 3 ... 3 3 3 3 3 3 3 3</div>
<input id="attrs-339c79fc-9195-4b41-8b60-1f1f021ace9c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-339c79fc-9195-4b41-8b60-1f1f021ace9c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ce9d141b-8e31-4d7f-861a-24080e79c4ae" class="xr-var-data-in" type="checkbox"><label for="data-ce9d141b-8e31-4d7f-861a-24080e79c4ae" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">draw</span></div>
<div class="xr-var-dims">(sample)</div>
<div class="xr-var-dtype">int64</div>
<div class="xr-var-preview xr-preview">1900 1901 1902 ... 1997 1998 1999</div>
<input id="attrs-e8b341a9-c45f-4a2a-9bb1-a4d902262799" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e8b341a9-c45f-4a2a-9bb1-a4d902262799" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6fb6ae7f-7316-413c-94ea-7eca582373aa" class="xr-var-data-in" type="checkbox"><label for="data-6fb6ae7f-7316-413c-94ea-7eca582373aa" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([1900, 1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909, 1910, 1911,
       1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923,
       1924, 1925, 1926, 1927, 1928, 1929, 1930, 1931, 1932, 1933, 1934, 1935,
       1936, 1937, 1938, 1939, 1940, 1941, 1942, 1943, 1944, 1945, 1946, 1947,
       1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959,
       1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971,
       1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983,
       1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995,
       1996, 1997, 1998, 1999])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-2081613e-1c7e-492d-bc4b-5d46fc15be6d" class="xr-section-summary-in" type="checkbox"><label for="section-2081613e-1c7e-492d-bc4b-5d46fc15be6d" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-index-name"><div>sample<br>chain<br>draw</div></div>
<div class="xr-index-preview">PandasMultiIndex</div>
<div></div>
<input id="index-3845beab-39b2-4861-a4cd-4e85078448ed" class="xr-index-data-in" type="checkbox"><label for="index-3845beab-39b2-4861-a4cd-4e85078448ed" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(MultiIndex([(3, 1900),
            (3, 1901),
            (3, 1902),
            (3, 1903),
            (3, 1904),
            (3, 1905),
            (3, 1906),
            (3, 1907),
            (3, 1908),
            (3, 1909),
            (3, 1910),
            (3, 1911),
            (3, 1912),
            (3, 1913),
            (3, 1914),
            (3, 1915),
            (3, 1916),
            (3, 1917),
            (3, 1918),
            (3, 1919),
            (3, 1920),
            (3, 1921),
            (3, 1922),
            (3, 1923),
            (3, 1924),
            (3, 1925),
            (3, 1926),
            (3, 1927),
            (3, 1928),
            (3, 1929),
            (3, 1930),
            (3, 1931),
            (3, 1932),
            (3, 1933),
            (3, 1934),
            (3, 1935),
            (3, 1936),
            (3, 1937),
            (3, 1938),
            (3, 1939),
            (3, 1940),
            (3, 1941),
            (3, 1942),
            (3, 1943),
            (3, 1944),
            (3, 1945),
            (3, 1946),
            (3, 1947),
            (3, 1948),
            (3, 1949),
            (3, 1950),
            (3, 1951),
            (3, 1952),
            (3, 1953),
            (3, 1954),
            (3, 1955),
            (3, 1956),
            (3, 1957),
            (3, 1958),
            (3, 1959),
            (3, 1960),
            (3, 1961),
            (3, 1962),
            (3, 1963),
            (3, 1964),
            (3, 1965),
            (3, 1966),
            (3, 1967),
            (3, 1968),
            (3, 1969),
            (3, 1970),
            (3, 1971),
            (3, 1972),
            (3, 1973),
            (3, 1974),
            (3, 1975),
            (3, 1976),
            (3, 1977),
            (3, 1978),
            (3, 1979),
            (3, 1980),
            (3, 1981),
            (3, 1982),
            (3, 1983),
            (3, 1984),
            (3, 1985),
            (3, 1986),
            (3, 1987),
            (3, 1988),
            (3, 1989),
            (3, 1990),
            (3, 1991),
            (3, 1992),
            (3, 1993),
            (3, 1994),
            (3, 1995),
            (3, 1996),
            (3, 1997),
            (3, 1998),
            (3, 1999)],
           name='sample'))</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-25a4b665-29b1-4f67-ae01-769f824e79ad" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-25a4b665-29b1-4f67-ae01-769f824e79ad" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>Un tracciato della catena di Markov illustra questa esplorazione rappresentando il valore <span class="math inline">\(\theta\)</span> sulle ordinate e l’indice progressivo di in ogni iterazione sull’ascissa. Il trace plot è estremamente utile per valutare la convergenza di un algoritmo MCMC e se è necessario escludere un periodo di campioni iniziali (noto come burn-in). Per produrre la traccia chiamiamo semplicemente <code>az.plot_trace()</code> con la variabile <code>idata</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>az.plot_trace(idata)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; array([[&lt;AxesSubplot: title={'center': 'theta'}&gt;,</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;AxesSubplot: title={'center': 'theta'}&gt;]], dtype=object)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="040_beta_binomial_mod_files/figure-html/unnamed-chunk-22-5.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>La traccia descrive il comportamento <em>longitudinale</em> delle catene di Markov. Possiamo usare il metodo <code>az.plot_trace()</code> per visualizzare sia la traccia sia una stima della densità del kernel (KDE) dell’istogramma delle stime a posteriori, ovvero, dei valori che le catene MCMC visitano lungo il loro percorso, ignorando l’ordine di queste visite. Da notare come la stima di KDE della convinzione a posteriori nella probabilità di efficacia dell’idrossiclorochina riflette sia la convinzione a priori di 𝜎=0.22 che i nostri dati con una correttezza campionaria di 𝜎=0.09. Inoltre possiamo vedere che la procedura di campionamento MCMC è “convergente alla distribuzione” poiché la serie di campionamento sembra stazionaria.</p>
<p>Svolgendo un’analisi bayesiana simile a questa, <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> hanno trovato che gli intervalli di credibilità del gruppo di controllo e del gruppo sperimentale non si sovrappongono. Questo fatto viene interpretato dicendo che il parametro <span class="math inline">\(\theta\)</span> è diverso nei due gruppi. Sulla base di queste evidenza, <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> hanno concluso, con un grado di certezza soggettiva del 95%, che nel gruppo sperimentale vi è una probabilità più bassa di risultare positivi al SARS-CoV-2 rispetto al gruppo di controllo. In altri termini, l’analisi statistica condotta da <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> suggerisce che l’idrossiclorochina è una terapia efficace per il Covid-19.</p>
</section></section><section id="la-critica-di-hulme_2020" class="level2" data-number="21.5"><h2 data-number="21.5" class="anchored" data-anchor-id="la-critica-di-hulme_2020">
<span class="header-section-number">21.5</span> La critica di <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span>
</h2>
<p>Un articolo pubblicato da <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span> si è posto il problema di rianalizzare i dati di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Tra gli autori di questo articolo figura anche Eric-Jan Wagenmakers, uno psicologo molto conosciuto per i suoi contributi metodologici. <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span> osservano che, nelle loro analisi statistiche, <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> hanno escluso alcuni dati. Nel gruppo sperimentale, infatti, vi erano alcuni pazienti i quali, anziché migliorare, sono in realtà peggiorati. L’analisi statistica di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> ha escluso i dati di questi pazienti. Se consideriamo tutti i pazienti — non solo quelli selezionati da <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> — la situazione diventa la seguente:</p>
<ul>
<li>gruppo sperimentale: 10 positivi su 18;</li>
<li>gruppo di controllo: 14 positivi su 16.</li>
</ul>
<p>L’analisi dei dati proposta da <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span> richiede l’uso di alcuni strumenti statistici che, in queste dispense, non verranno discussi. Ma possiamo giungere alle stesse conclusioni raggiunte da questi ricercatori anche usando le procedure statistiche descritte nel Paragrafo successivo.</p>
</section><section id="due-proporzioni" class="level2" data-number="21.6"><h2 data-number="21.6" class="anchored" data-anchor-id="due-proporzioni">
<span class="header-section-number">21.6</span> Due proporzioni</h2>
<p>Svolgiamo ora l’analisi statistica considerando tutti i dati, come suggerito da <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span>. Per fare questo verrà creato un modello bayesiano per fare inferenza sulla differenza tra due proporzioni. Dopo avere generato le distribuzioni a posteriori per le proporzioni di “successi” nei due gruppi, calcoleremo la quantità</p>
<p><span id="eq-odds-ratio"><span class="math display">\[
\omega = \frac{\theta_2 / (1-\theta_2)}{\theta_1 / (1-\theta_1)},
\tag{21.2}\]</span></span></p>
<p>ovvero il rapporto tra gli Odds di positività tra i pazienti del gruppo di controllo e gli Odds di positività tra i pazienti del gruppo sperimentale. Se il valore dell’OR è uguale a 1, significa che l’Odds di positività nel gruppo di controllo è uguale all’Odds di positività nel gruppo sperimentale, cioè il fattore in esame (somministrazione dell’idrossiclorochina) è ininfluente sulla comparsa della malattia. L’inferenza statistica sull’efficacia dell’idrossiclorochina come terapia per il Covid-19 può dunque essere effettuata esaminando l’intervallo di credibilità al 95% per l’OR: se tale intervallo include il valore 1, allora non c’è evidenza che l’idrossiclorochina sia efficace come terapia per il Covid-19.</p>
<p>Nell’implementazione di questo modello, la quantità di interesse è l’odds ratio; tale quantità viene calcolata nel blocco <code>generated quantities</code>. Per i parametri <span class="math inline">\(\theta_1\)</span> e <span class="math inline">\(\theta_2\)</span> useremo delle distribuzioni a priori debolmente informative il cui scopo è la regolarizzazione dei dati.</p>
<p>Elenco i dati dei due gruppi.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data for proportion 1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data for proportion 2</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definisco il modello.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the priors for the two proportions</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> pm.Beta(<span class="st">'p1'</span>, alpha<span class="op">=</span><span class="dv">2</span>, beta<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> pm.Beta(<span class="st">'p2'</span>, alpha<span class="op">=</span><span class="dv">2</span>, beta<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the likelihood functions for the two proportions</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    likelihood1 <span class="op">=</span> pm.Binomial(<span class="st">'likelihood1'</span>, n<span class="op">=</span>n1, p<span class="op">=</span>p1, observed<span class="op">=</span>y1)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    likelihood2 <span class="op">=</span> pm.Binomial(<span class="st">'likelihood2'</span>, n<span class="op">=</span>n2, p<span class="op">=</span>p2, observed<span class="op">=</span>y2)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the difference of odds model</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    odds_ratio <span class="op">=</span> pm.Deterministic(<span class="st">'odds_ratio'</span>, (p1<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p1))<span class="op">/</span>(p2<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguo il campionamento MCMC.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    trace <span class="op">=</span> pm.sample(draws<span class="op">=</span><span class="dv">10000</span>, tune<span class="op">=</span><span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esamino i risulati.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>az.hdi(trace, hdi_prob<span class="op">=</span><span class="fl">.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div>
<svg style="position: absolute; width: 0; height: 0; overflow: hidden"><defs><symbol id="icon-database" viewbox="0 0 32 32"><path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path><path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path><path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path></symbol><symbol id="icon-file-text2" viewbox="0 0 32 32"><path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path><path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path><path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path></symbol></defs></svg><style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style>
<pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:     (hdi: 2)
Coordinates:
  * hdi         (hdi) &lt;U6 'lower' 'higher'
Data variables:
    p1          (hdi) float64 0.6269 0.9524
    p2          (hdi) float64 0.3406 0.7439
    odds_ratio  (hdi) float64 0.4523 12.74</pre>
<div class="xr-wrap" style="display:none">
<div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div>
<ul class="xr-sections">
<li class="xr-section-item">
<input id="section-d6c1f36c-fb41-4b35-9c00-7cab1ca1effa" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-d6c1f36c-fb41-4b35-9c00-7cab1ca1effa" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li>
<span class="xr-has-index">hdi</span>: 2</li></ul></div>
<div class="xr-section-details"></div>
</li>
<li class="xr-section-item">
<input id="section-7f2feb03-364b-4103-841d-da2535fd1b85" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-7f2feb03-364b-4103-841d-da2535fd1b85" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-var-name"><span class="xr-has-index">hdi</span></div>
<div class="xr-var-dims">(hdi)</div>
<div class="xr-var-dtype">&lt;U6</div>
<div class="xr-var-preview xr-preview">'lower' 'higher'</div>
<input id="attrs-485fe531-7757-4a34-8db3-6db41be48bf7" class="xr-var-attrs-in" type="checkbox"><label for="attrs-485fe531-7757-4a34-8db3-6db41be48bf7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-80709fbb-a9a5-4a71-9abd-88bedeffe5ed" class="xr-var-data-in" type="checkbox"><label for="data-80709fbb-a9a5-4a71-9abd-88bedeffe5ed" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs">
<dt><span>hdi_prob :</span></dt>
<dd>0.95</dd>
</dl></div>
<div class="xr-var-data"><pre>array(['lower', 'higher'], dtype='&lt;U6')</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-939d4d17-9c6c-40fe-baf3-b48541c01434" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-939d4d17-9c6c-40fe-baf3-b48541c01434" class="xr-section-summary">Data variables: <span>(3)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list">
<li class="xr-var-item">
<div class="xr-var-name"><span>p1</span></div>
<div class="xr-var-dims">(hdi)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.6269 0.9524</div>
<input id="attrs-72173c73-5e24-4563-8aa4-78335a3ddd5a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-72173c73-5e24-4563-8aa4-78335a3ddd5a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-734f6818-7134-4861-a309-d95a3f85141f" class="xr-var-data-in" type="checkbox"><label for="data-734f6818-7134-4861-a309-d95a3f85141f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0.6268562 , 0.95239464])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>p2</span></div>
<div class="xr-var-dims">(hdi)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.3406 0.7439</div>
<input id="attrs-2d90f0fb-b1e3-43a0-8b45-b3b5d950c096" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2d90f0fb-b1e3-43a0-8b45-b3b5d950c096" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ea0282cd-fdf6-418c-b521-8e3bfbb15894" class="xr-var-data-in" type="checkbox"><label for="data-ea0282cd-fdf6-418c-b521-8e3bfbb15894" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([0.34062181, 0.74394419])</pre></div>
</li>
<li class="xr-var-item">
<div class="xr-var-name"><span>odds_ratio</span></div>
<div class="xr-var-dims">(hdi)</div>
<div class="xr-var-dtype">float64</div>
<div class="xr-var-preview xr-preview">0.4523 12.74</div>
<input id="attrs-77e251ee-eca6-43a4-8ce0-1feb428b3f60" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-77e251ee-eca6-43a4-8ce0-1feb428b3f60" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1d5bb5f4-7fa0-4756-a28e-04b07fc8fe3d" class="xr-var-data-in" type="checkbox"><label for="data-1d5bb5f4-7fa0-4756-a28e-04b07fc8fe3d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div>
<div class="xr-var-data"><pre>array([ 0.45226733, 12.73805909])</pre></div>
</li>
</ul></div>
</li>
<li class="xr-section-item">
<input id="section-b2daf00a-cc53-4007-ac59-954b31d3db5b" class="xr-section-summary-in" type="checkbox"><label for="section-b2daf00a-cc53-4007-ac59-954b31d3db5b" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item">
<div class="xr-index-name"><div>hdi</div></div>
<div class="xr-index-preview">PandasIndex</div>
<div></div>
<input id="index-2885c4ea-0192-4f74-9f46-72986613e955" class="xr-index-data-in" type="checkbox"><label for="index-2885c4ea-0192-4f74-9f46-72986613e955" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index(['lower', 'higher'], dtype='object', name='hdi'))</pre></div>
</li></ul></div>
</li>
<li class="xr-section-item">
<input id="section-11014ff8-cc4d-4d9a-bbc3-d1a6a6d7a562" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-11014ff8-cc4d-4d9a-bbc3-d1a6a6d7a562" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div>
<div class="xr-section-details"><dl class="xr-attrs"></dl></div>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>L’intervallo di credibilità del 95% per l’OR include il valore di 1.0 (ovvero, il valore che indica che gli Odds di positività sono uguali nei due gruppi). In base agli standard correnti, un risultato di questo tipo non viene considerato come evidenza sufficiente per potere concludere che il parametro <span class="math inline">\(\theta\)</span> assume un valore diverso nei due gruppi. In conclusione, se consideriamo tutti i dati, e non solo quelli selezionati da <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span>, non vi sono evidenze sull’efficacia dell’idrossiclorochina come terapia per il Covid-19.</p>
</section><section id="commenti-e-considerazioni-finali" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="commenti-e-considerazioni-finali">Commenti e considerazioni finali</h2>
<p>La ricerca di <span class="citation" data-cites="Gautret_2020">Gautret et al. (<a href="999_refs.html#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span> include altre informazioni e altre analisi statistiche che non sono state qui considerate. Tuttavia, notiamo che la semplice analisi statistica che abbiamo qui descritto è stata in grado di replicare le conclusioni a cui sono giunti (per altra via) <span class="citation" data-cites="Hulme_2020">Hulme et al. (<a href="999_refs.html#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span>.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography" style="display: none">
<div id="ref-carpenter2017stan" class="csl-entry" role="doc-biblioentry">
Carpenter, B., Gelman, A., Hoffman, M. D., Lee, D., Goodrich, B., Betancourt, M., Brubaker, M., Guo, J., Li, P., &amp; Riddell, A. (2017). Stan: A probabilistic programming language. <em>Journal of Statistical Software</em>, <em>76</em>(1), 1–32.
</div>
<div id="ref-Gautret_2020" class="csl-entry" role="doc-biblioentry">
Gautret, P., Lagier, J. C., Parola, P., Meddeb, L., Mailhe, M., Doudier, B., &amp; Honoré, S. (2020). Hydroxychloroquine and azithromycin as a treatment of COVID-19: Results of an open-label non-randomized clinical trial. <em>International Journal of Antimicrobial Agents</em>.
</div>
<div id="ref-Hulme_2020" class="csl-entry" role="doc-biblioentry">
Hulme, O. J., Wagenmakers, E. J., Damkier, P., Madelung, C. F., Siebner, H. R., Helweg-Larsen, J., &amp; Madsen, K. H. (2020). Reply to gautret et al. 2020: A bayesian reanalysis of the effects of hydroxychloroquine and azithromycin on viral carriage in patients with COVID-19. <em>medRxiv</em>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Si veda <a href="https://osf.io/5dgmx/" class="uri">https://osf.io/5dgmx/</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./036_posterior_sim.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Approssimazione della distribuzione a posteriori</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./041_mcmc_diagnostics.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Markov Chain Monte Carlo per l'inferenza bayesiana {#sec-stan-beta-binom}</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_stan_options.R"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>In questo Capitolo introdurremo PyMC, un pacchetto Python per la modellazione statistica bayesiana. Nel @sec-grid-metropolis abbiamo esaminato l'algoritmo Metropolis che consente di generare campioni da distribuzioni di probabilità basati sulla costruzione di una catena di Markov avente come distribuzione di equilibrio (o stazionaria) la distribuzione desiderata. Benché l'algoritmo Metropolis possa essere utilizzato per risolvere problemi più complessi di quello utilizzato nell'esempio che abbiamo discusso, un suo limite risiede nel fatto che è poco efficiente -- nel caso di modelli complessi, dunque, richiede molto tempo per raggiungere una distribuzione stazionaria (ovvero, una distribuzione di probabilità che si mantiene costante all'evolversi nel tempo della catena di Markov). Sono stati messi a punto algoritmi Monte Carlo (MCMC) a catena di Markov che massimizzano l'efficienza nella velocità di esecuzione, come ad esempio, il campionatore No-U-Turn (NUTS), gli algoritmi Metropolis-Hastings, Gibbs Sampler e Hamiltonian Monte Carlo, e questi motori di inferenza (incluso l'algoritmo Metropolis di cui abbiamo discusso nel capitolo precedente) sono implementati in vari framework per la programmazione probabilistica (PP). PyMC e <span class="co">[</span><span class="ot">Stan</span><span class="co">](http://mc-stan.org/)</span> <span class="co">[</span><span class="ot">@carpenter2017stan</span><span class="co">]</span> sono i due strumenti di PP più popolari. Con l'aiuto del framework PyMC è possibile definire modelli complessi, anche con molte migliaia di parametri, mediante una sintassi leggibile e intuitiva. In questo Capitolo useremo PyMC per eseguire l'inferenza su una o due proporzioni binomiali con Markov Chain Monte Carlo.</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Il presidente Trump e l'idrossiclorochina</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>Per fare un esempio concreto, consideriamo un set di dati reali. Cito dal *Washington Post* del 7 aprile 2020:</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; One of the most bizarre and disturbing aspects of President Trump's nightly press briefings on the coronavirus pandemic is when he turns into a drug salesman. Like a cable TV pitchman hawking 'male enhancement' pills, Trump regularly extols the virtues of taking hydroxychloroquine, a drug used to treat malaria and lupus, as a potential 'game changer' that just might cure Covid-19.</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>Tralasciamo qui il fatto che il Donald Trump non sia un esperto in questo campo. Esaminiamo invece le evidenze iniziali a supporto dell'ipotesi che l'idrossiclorochina possa essere utile per la cura del Covid-19, ovvero le evidenze che erano disponibili nel momento in cui il Donald Trump ha fatto le affermazioni riportate sopra (in seguito, quest'idea è stata screditata). Tali evidenze sono state fornite da uno studio di @Gautret_2020. Il disegno sperimentale di @Gautret_2020 comprende, tra le altre cose, il confronto tra una condizione sperimentale e una condizione di controllo. Il confronto importante è tra la proporzione di paziente positivi al virus SARS-CoV-2 nel gruppo sperimentale (a cui è stata somministrata l'idrossiclorochina; 6 su 14) e la proporzione di paziente positivi nel gruppo di controllo (a cui non è stata somministrata l'idrossiclorochina; ovvero 14 su 16). Obiettivo di questo capitolo è mostrare come si possa fare inferenza sui dati di @Gautret_2020 usando PyMC. Per semplicità, iniziamo considerando solo il gruppo di controllo.</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Una proporzione</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>Sulla base di ciò che è stato detto nel @sec-distr-coniugate, sappiamo che, quando i dati sono rappresentati da una proporzione $\theta$, e quando utilizziamo una distribuzione a priori Beta per $\theta$, la distribuzione a posteriori di $\theta$ è specificata dallo schema beta-binomiale. Se scegliamo, ad esempio, una $\mbox{Beta}(2, 2)$ quale distribuzione a priori per $\theta$, il modello diventa:</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>y &amp;\sim \mbox{Bin}(n, \theta) \notag<span class="sc">\\</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>\theta &amp;\sim \mbox{Beta}(2, 2)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>$$ {#eq-beta-binom-trump}</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>dove la prima riga definisce la funzione di verosimiglianza e la seconda riga definisce la distribuzione a priori.</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>Per essere chiari, in questo caso particolare non è necessario utilizzare MCMC per stimare il posteriore poiché esiste già una soluzione analitica in forma chiusa. Tuttavia, la maggior parte dei modelli di inferenza bayesiana non ammette una soluzione in forma chiusa per il posteriore e quindi è necessario utilizzare MCMC. In questo esempio, applichiamo MCMC a un caso di cui "conosciamo già la risposta", in modo da poter confrontare i risultati di una soluzione in forma chiusa e quella calcolata per approssimazione numerica.</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dedurre una proporzione binomiale con PyMC</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>Ora eseguiremo la stessa analisi che abbiamo svolto in precedenza utilizzando invece il metodo numerico Markov Chain Monte Carlo. Suppoaniamo di avere già installato PyMC. Una volta installato, dobbiamo successivamente importare le librerie necessarie, che includono Matplotlib, Numpy, Scipy, Arviz e lo stesso PyMC.</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize random number generator</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">8927</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(RANDOM_SEED)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">"arviz-darkgrid"</span>)</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Running on PyMC v</span><span class="sc">{</span>pm<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>Vediamo ora come specificare il modello beta-binomiale mediante PyMC. Per svolgere l'analisi mediante PyMC è necessario prima specificare la struttura del modello bayesiano e poi eseguire il campionamento dalla distribuzione a posteriori. Esaminiamo questi due passaggi per l'esempio presente.</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dati</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>I dati sono i seguenti.</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>ntrials <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### Specificare il modello</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>Ora definiamo una distribuzione Beta a priori e il modello di probabilità Binomiale. Questi sono i parametri della distribuzione Beta.</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>PyMC ha un'API molto pulita per eseguire questa operazione. Si usa un <span class="in">`context with`</span> di Python per assegnare tutti i parametri, le dimensioni dei passaggi e i valori iniziali a un'istanza <span class="in">`pymc.Model`</span> (che denominiamo <span class="in">`bb_model`</span>).</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>bb_model <span class="op">=</span> pm.Model()</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prior</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> pm.Beta(<span class="st">"theta"</span>, alpha<span class="op">=</span>alpha_prior, beta<span class="op">=</span>beta_prior)</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood</span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>    obs <span class="op">=</span> pm.Binomial(<span class="st">"obs"</span>, p<span class="op">=</span>theta, n<span class="op">=</span>ntrials, observed<span class="op">=</span>y)</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>La prima linea di codice</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a><span class="in">`bb_model = pm.Model()`</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>crea un nuovo oggetto di classe <span class="in">`Model`</span> che è un contenitore per le variabili casuali del modello. Dopo l'istanziazione del modello, la successiva specificazione delle componenti del modello viene eseguita all'interno di un'istruzione <span class="in">`with:`</span>.</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>Questo crea un *context manager*, con il nostro `bb_model` come contesto, che include tutte le istruzioni fino alla fine del blocco indentato. Ciò significa che tutti gli oggetti PyMC introdotti nel blocco di codice indentato sotto l'istruzione `with:` vengono aggiunti al modello. In assenza di questo idioma del *context manager*, saremmo costretti ad associare manualmente ciascuna delle variabili a <span class="in">`bb_model`</span>.</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>Con la chiamata del costruttore <span class="in">`pm.Beta`</span> si crea una variabile casuale da usare come distribuzione a priori. Il primo argomento è sempre il nome della variabile casuale, che dovrebbe corrispondere al nome della variabile Python assegnata, poiché a volte viene utilizzato per recuperare la variabile dal modello per riassumere l'output. I restanti argomenti richiesti per un oggetto stocastico sono i parametri, in questo caso <span class="in">`alpha`</span> e <span class="in">`beta`</span>, a cui assegniamo i valori degli iperparametri del modello. Nel caso presente, usiamo i valori <span class="in">`alpha_prior`</span> e <span class="in">`beta_prior`</span> come parametri della distribuzione Beta a priori.</span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>La riga finale del modello definisce <span class="in">`obs`</span>, la distribuzione campionaria della variabile di esito nel set di dati. Questo è un caso speciale di variabile stocastica chiamata <span class="in">`observed stochastic`</span>, la quale rappresenta la verosimiglianza dei dati del modello. Tale variabile stocastica è identica alle altre variabili stocastiche, tranne per l'argomento <span class="in">`obs`</span>, il quale indica che i valori per questa variabile sono stati osservati e non devono essere modificati dal modello. I dati possono essere passati sotto forma di oggetto <span class="in">`ndarray`</span> o <span class="in">`DataFrame`</span>. Nel caso presente, per la funzione di verosimiglianza Binomiale specificando il parametro <span class="in">`p=theta`</span>, il numero di prove <span class="in">`n=ntrials`</span> e il numero di successi <span class="in">`observed=y`</span>.</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>Si noti che, a differenza delle distribuzioni a priori del modello, i parametri per la distribuzione Beta di <span class="in">`obs`</span> non sono valori fissi, ma piuttosto corrispondono all'oggetto stocastico <span class="in">`theta`</span>. Questo crea una relazione genitore-figlio tra la verosimiglianza e questa variabile.</span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### Campionamento</span></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>Eseguiamo il campionamento MCMC usando l'algoritmo di default (NUTS) e salviamo i risultati nell'oggetto <span class="in">`idata`</span>.</span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{python, message=FALSE, comment=FALSE, error=FALSE, results='hide'}</span></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> pm.NUTS()</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>    idata <span class="op">=</span> pm.sample(<span class="dv">2000</span>, tune<span class="op">=</span><span class="dv">1000</span>, init<span class="op">=</span><span class="va">None</span>, step<span class="op">=</span>step, chains<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a>La funzione <span class="in">`sample`</span> esegue il metod0 <span class="in">`step`</span> assegnati (o passati) ad essa per il numero specificato di iterazioni e restituisce un oggetto <span class="in">`InferenceData`</span> contenente i campioni raccolti, insieme ad altri attributi utili come le statistiche dell'esecuzione del campionamento e una copia dei dati osservati. Si noti che <span class="in">`sample`</span> genera una serie di catene parallele, a seconda del numero di *core* di calcolo presenti sulla macchina.</span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>Avendo assunto una distribuzione a priori per il parametro $\theta$, l'algoritmo procede in maniera ciclica, correggendo la distribuzione a priori di $\theta$ condizionandola ai valori già generati. Dopo un certo numero di cicli, necessari per portare l'algoritmo a convergenza, i valori estratti possono essere assunti come campionati dalla distribuzione a posteriori di $\theta$.</span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>Al crescere del numero di passi della catena, la distribuzione di target viene sempre meglio approssimata. All'inizio del campionamento, però, la distribuzione può essere significativamente lontana da quella stazionaria, e ci vuole un certo tempo prima di raggiungere la distribuzione stazionaria di equilibrio, detto, appunto, periodo di *burn-in*. I campioni provenienti da tale parte iniziale della catena vanno tipicamente scartati perché possono non rappresentare accuratamente la distribuzione a posteriori.</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>Il tempo di campionamento dipende dalla velocità del computer a disposizione.</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>idata</span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>I vari attributi dell'oggetto <span class="in">`InferenceData`</span> possono essere estratti come nel caso di un <span class="in">`dict`</span> contenente coppie composte da una chiave e un valore separati tra loro dal simbolo dei due punti. In questo caso le chiavi sono i nomi delle variabili e i valori sono dei <span class="in">`numpy.arrays`</span>. Ad esempio, possiamo recuperare la traccia di campionamento dalla variabile latente <span class="in">`theta`</span> nel modo seguente.</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>]</span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>Si noti che l'oggetto ritornato è un array</span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>].shape</span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>di dimensioni 4 $\times$ 2000 (sul mio computer). Per visualizzare il primi 10 valori della prima catena, ad esempio, usiamo:</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">"theta"</span>][<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">10</span>]</span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>Se volessimo utilizzare l'algoritmo di campionamento Metropolis invece di NUTS (che è stato assegnato di default), possiamo specificare questo come argomento <span class="in">`step`</span> per <span class="in">`sample`</span>.</span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> bb_model:</span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instantiate sampler</span></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> pm.Metropolis()</span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw 5000 posterior samples</span></span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a>    metropolis_idata <span class="op">=</span> pm.sample(<span class="dv">5000</span>, step<span class="op">=</span>step)</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-166"><a href="#cb26-166" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analisi a posteriori</span></span>
<span id="cb26-167"><a href="#cb26-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a>Esaminiamo l'accettanza.</span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(</span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a>    idata, group<span class="op">=</span><span class="st">"sample_stats"</span>, var_names<span class="op">=</span><span class="st">"acceptance_rate"</span>, </span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a>    hdi_prob<span class="op">=</span><span class="st">"hide"</span>, kind<span class="op">=</span><span class="st">"hist"</span></span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a>Estraiamo le stime a posteriori di $\theta$ da <span class="in">`idata`</span>.</span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a>posterior <span class="op">=</span> az.extract(idata)</span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a>Le stime a posteriori di $\theta$ sono accessibili nel modo seguente.</span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>]</span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a>Dato che <span class="in">`posterior['theta']`</span> è una lista, possiamo facilmente calcolare la media a posteriori</span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>].mean()</span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a>oppure la mediana a posteriori di $\theta$</span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a>posterior[<span class="st">'theta'</span>].median()</span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a>La deviazione standard della stima a posteriori è</span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a>np.std(posterior[<span class="st">'theta'</span>])</span>
<span id="cb26-217"><a href="#cb26-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-218"><a href="#cb26-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a>Per semplicità, salvo le stime a posteriori di $\theta$ in un array.</span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a>p_post <span class="op">=</span> posterior[<span class="st">'theta'</span>]</span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a>Possiamo ora fare inferenza usando i risultati ottenuti. Un sommario della distribuzione a posteriori si ottiene con il metodo <span class="in">`az.summary()`</span>.</span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-231"><a href="#cb26-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a>az.summary(idata, hdi_prob<span class="op">=</span><span class="fl">.95</span>, round_to<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-235"><a href="#cb26-235" aria-hidden="true" tabindex="-1"></a>Si ottiene così l'intervallo di credibilità a densità posteriori più alta al 95%. Questo intervallo ci informa sul fatto che, a posteriori, possiamo essere certi al 95% che il vero valore del parametro $\theta$ sia contenuto nell'intervallo <span class="sc">\[</span>0.625, 0.95<span class="sc">\]</span>.</span>
<span id="cb26-236"><a href="#cb26-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a>L'output grafico dell'analisi è riportato nel grafico seguente.</span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior: Beta(alpha + y, beta + n - y)</span></span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a>alpha_post <span class="op">=</span> alpha_prior <span class="op">+</span> y</span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a>beta_post <span class="op">=</span> beta_prior <span class="op">+</span> ntrials <span class="op">-</span> y</span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-246"><a href="#cb26-246" aria-hidden="true" tabindex="-1"></a>plt.hist(</span>
<span id="cb26-247"><a href="#cb26-247" aria-hidden="true" tabindex="-1"></a>    p_post,bins<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a>    histtype<span class="op">=</span><span class="st">"step"</span>,  density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"A posteriori (MCMC)"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the analytic prior and posterior beta distributions</span></span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb26-254"><a href="#cb26-254" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb26-255"><a href="#cb26-255" aria-hidden="true" tabindex="-1"></a>    x, beta.pdf(x, alpha_prior, beta_prior),</span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a>    <span class="st">"--"</span>, label<span class="op">=</span><span class="st">"A priori"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a>    x, beta.pdf(x, alpha_post, beta_post),</span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">'A posteriori (analitico)'</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the graph labels</span></span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">" "</span>, loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"$</span><span class="ch">\\</span><span class="st">theta$, Proporzione di successi"</span>)</span>
<span id="cb26-266"><a href="#cb26-266" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Densità"</span>)</span>
<span id="cb26-267"><a href="#cb26-267" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-269"><a href="#cb26-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-270"><a href="#cb26-270" aria-hidden="true" tabindex="-1"></a>In questo esempio, con 8,000 campioni, la convergenza dell'algoritmo NUTS è estremamente buona. L'istogramma segue da vicino la distribuzione a posteriori calcolata analiticamente, come da previsione.</span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a>Stampo ora i valori degli ultimi 100 campioni prodotti dalla procedura di campionamento MCMC.</span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a>p_post[<span class="dv">7900</span>:<span class="dv">8000</span>]</span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-280"><a href="#cb26-280" aria-hidden="true" tabindex="-1"></a>Un tracciato della catena di Markov illustra questa esplorazione rappresentando il valore $\theta$ sulle ordinate e l'indice progressivo di in ogni iterazione sull'ascissa. Il trace plot è estremamente utile per valutare la convergenza di un algoritmo MCMC e se è necessario escludere un periodo di campioni iniziali (noto come burn-in). Per produrre la traccia chiamiamo semplicemente <span class="in">`az.plot_trace()`</span> con la variabile <span class="in">`idata`</span>:</span>
<span id="cb26-281"><a href="#cb26-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a>az.plot_trace(idata)</span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb26-287"><a href="#cb26-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-288"><a href="#cb26-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a>La traccia descrive il comportamento *longitudinale* delle catene di Markov. Possiamo usare il metodo <span class="in">`az.plot_trace()`</span> per visualizzare sia la traccia sia una stima della densità del kernel (KDE) dell'istogramma delle stime a posteriori, ovvero, dei valori che le catene MCMC visitano lungo il loro percorso, ignorando l'ordine di queste visite. Da notare come la stima di KDE della convinzione a posteriori nella probabilità di efficacia dell'idrossiclorochina riflette sia la convinzione a priori di 𝜎=0.22 che i nostri dati con una correttezza campionaria di 𝜎=0.09. Inoltre possiamo vedere che la procedura di campionamento MCMC è "convergente alla distribuzione" poiché la serie di campionamento sembra stazionaria.</span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a>Svolgendo un'analisi bayesiana simile a questa, @Gautret_2020 hanno trovato che gli intervalli di credibilità del gruppo di controllo e del gruppo sperimentale non si sovrappongono. Questo fatto viene interpretato dicendo che il parametro $\theta$ è diverso nei due gruppi. Sulla base di queste evidenza, @Gautret_2020 hanno concluso, con un grado di certezza soggettiva del 95%, che nel gruppo sperimentale vi è una probabilità più bassa di risultare positivi al SARS-CoV-2 rispetto al gruppo di controllo. In altri termini, l'analisi statistica condotta da @Gautret_2020 suggerisce che l'idrossiclorochina è una terapia efficace per il Covid-19.</span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## La critica di @Hulme_2020</span></span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a>Un articolo pubblicato da @Hulme_2020 si è posto il problema di rianalizzare i dati di @Gautret_2020.<span class="ot">[^040_beta_binomial_mod-1]</span> Tra gli autori di questo articolo figura anche Eric-Jan Wagenmakers, uno psicologo molto conosciuto per i suoi contributi metodologici. @Hulme_2020 osservano che, nelle loro analisi statistiche, @Gautret_2020 hanno escluso alcuni dati. Nel gruppo sperimentale, infatti, vi erano alcuni pazienti i quali, anziché migliorare, sono in realtà peggiorati. L'analisi statistica di @Gautret_2020 ha escluso i dati di questi pazienti. Se consideriamo tutti i pazienti --- non solo quelli selezionati da @Gautret_2020 --- la situazione diventa la seguente:</span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-297"><a href="#cb26-297" aria-hidden="true" tabindex="-1"></a><span class="ot">[^040_beta_binomial_mod-1]: </span>Si veda <span class="ot">&lt;https://osf.io/5dgmx/&gt;</span>.</span>
<span id="cb26-298"><a href="#cb26-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-299"><a href="#cb26-299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gruppo sperimentale: 10 positivi su 18;</span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gruppo di controllo: 14 positivi su 16.</span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a>L'analisi dei dati proposta da @Hulme_2020 richiede l'uso di alcuni strumenti statistici che, in queste dispense, non verranno discussi. Ma possiamo giungere alle stesse conclusioni raggiunte da questi ricercatori anche usando le procedure statistiche descritte nel Paragrafo successivo.</span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Due proporzioni</span></span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a>Svolgiamo ora l'analisi statistica considerando tutti i dati, come suggerito da @Hulme_2020. Per fare questo verrà creato un modello bayesiano per fare inferenza sulla differenza tra due proporzioni. Dopo avere generato le distribuzioni a posteriori per le proporzioni di "successi" nei due gruppi, calcoleremo la quantità</span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-309"><a href="#cb26-309" aria-hidden="true" tabindex="-1"></a>\omega = \frac{\theta_2 / (1-\theta_2)}{\theta_1 / (1-\theta_1)},</span>
<span id="cb26-310"><a href="#cb26-310" aria-hidden="true" tabindex="-1"></a>$$ {#eq-odds-ratio}</span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a>ovvero il rapporto tra gli Odds di positività tra i pazienti del gruppo di controllo e gli Odds di positività tra i pazienti del gruppo sperimentale. Se il valore dell'OR è uguale a 1, significa che l'Odds di positività nel gruppo di controllo è uguale all'Odds di positività nel gruppo sperimentale, cioè il fattore in esame (somministrazione dell'idrossiclorochina) è ininfluente sulla comparsa della malattia. L'inferenza statistica sull'efficacia dell'idrossiclorochina come terapia per il Covid-19 può dunque essere effettuata esaminando l'intervallo di credibilità al 95% per l'OR: se tale intervallo include il valore 1, allora non c'è evidenza che l'idrossiclorochina sia efficace come terapia per il Covid-19.</span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a>Nell'implementazione di questo modello, la quantità di interesse è l'odds ratio; tale quantità viene calcolata nel blocco <span class="in">`generated quantities`</span>. Per i parametri $\theta_1$ e $\theta_2$ useremo delle distribuzioni a priori debolmente informative il cui scopo è la regolarizzazione dei dati.</span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>Elenco i dati dei due gruppi.</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-321"><a href="#cb26-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data for proportion 1</span></span>
<span id="cb26-322"><a href="#cb26-322" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data for proportion 2</span></span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb26-328"><a href="#cb26-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-329"><a href="#cb26-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a>Definisco il modello.</span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-334"><a href="#cb26-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model:</span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the priors for the two proportions</span></span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> pm.Beta(<span class="st">'p1'</span>, alpha<span class="op">=</span><span class="dv">2</span>, beta<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> pm.Beta(<span class="st">'p2'</span>, alpha<span class="op">=</span><span class="dv">2</span>, beta<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the likelihood functions for the two proportions</span></span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a>    likelihood1 <span class="op">=</span> pm.Binomial(<span class="st">'likelihood1'</span>, n<span class="op">=</span>n1, p<span class="op">=</span>p1, observed<span class="op">=</span>y1)</span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a>    likelihood2 <span class="op">=</span> pm.Binomial(<span class="st">'likelihood2'</span>, n<span class="op">=</span>n2, p<span class="op">=</span>p2, observed<span class="op">=</span>y2)</span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-344"><a href="#cb26-344" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the difference of odds model</span></span>
<span id="cb26-345"><a href="#cb26-345" aria-hidden="true" tabindex="-1"></a>    odds_ratio <span class="op">=</span> pm.Deterministic(<span class="st">'odds_ratio'</span>, (p1<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p1))<span class="op">/</span>(p2<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p2)))</span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a>Eseguo il campionamento MCMC.</span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{python, message=FALSE, comment=FALSE, error=FALSE, results='hide'}</span></span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:</span>
<span id="cb26-352"><a href="#cb26-352" aria-hidden="true" tabindex="-1"></a>    trace <span class="op">=</span> pm.sample(draws<span class="op">=</span><span class="dv">10000</span>, tune<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb26-353"><a href="#cb26-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a>Esamino i risulati.</span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-359"><a href="#cb26-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a>az.hdi(trace, hdi_prob<span class="op">=</span><span class="fl">.95</span>)</span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a>L'intervallo di credibilità del 95% per l'OR include il valore di 1.0 (ovvero, il valore che indica che gli Odds di positività sono uguali nei due gruppi). In base agli standard correnti, un risultato di questo tipo non viene considerato come evidenza sufficiente per potere concludere che il parametro $\theta$ assume un valore diverso nei due gruppi. In conclusione, se consideriamo tutti i dati, e non solo quelli selezionati da @Gautret_2020, non vi sono evidenze sull'efficacia dell'idrossiclorochina come terapia per il Covid-19.</span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Commenti e considerazioni finali {.unnumbered}</span></span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a>La ricerca di @Gautret_2020 include altre informazioni e altre analisi statistiche che non sono state qui considerate. Tuttavia, notiamo che la semplice analisi statistica che abbiamo qui descritto è stata in grado di replicare le conclusioni a cui sono giunti (per altra via) @Hulme_2020.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>